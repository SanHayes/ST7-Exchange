import{_ as E,N as U,v as j,r as y,O as A,ah as G,k as J,y as w,b as e,M as t,A as u,J as g,z as K,D as r,C as S,R as O,L as k,Q,F as T,E as q,G as p,I as P,S as W,H as X,K as Y,ai as x,aj as Z}from"./index-Cji0LIog.js";import{S as ee}from"./index-CfdtR6V4.js";import{T as ae}from"./index-B8qdUYhO.js";import"./index-BXv81Z5_.js";import{F as oe}from"./index-Dm8RlGeV.js";import{N as ne}from"./index-QZQPgCsf.js";import{s as te}from"./function-call-UoX71fxD.js";import"./use-id-D6HqoPij.js";const se={class:"main ma-3"},le={class:"verified text-center pa-5 mb-3"},ie={class:"font-md"},re={class:"label font-md mb-3"},de={class:"label font-md my-2"},ue={class:"label font-md my-2"},ce={class:"row my-3 pa-3 font-md"},me={class:"flex space-between"},_e={class:"label"},pe={key:0,class:"value"},ve={class:"flex space-between"},ye={class:"label"},fe={class:"value"},he={class:"flex space-between"},ke={class:"label"},be={class:"value"},we=["innerHTML"],ge={__name:"Index",setup(xe){const C=U(),N=q(),{t:f}=j(),V=y(!0),B=y([]),l=y(""),s=y(null),b=y(!1);A(async()=>{await C.userInfo()}),G().then(a=>{var o,c;if(a.type==="ok"){const i=((o=a.data)==null?void 0:o.data)||[];B.value=i.sort((n,_)=>n.lock_dividend_days-_.lock_dividend_days),i!=null&&i.length&&(s.value=i[0],l.value=(c=i[0])==null?void 0:c.borrow_amount_min)}}).finally(()=>{V.value=!1});const h=J(()=>{var a,o;return!((a=s.value)!=null&&a.borrow_margin)||!l.value?0:(((o=s.value)==null?void 0:o.borrow_margin)*l.value).toFixed(2)});function M(a){s.value=a,l.value=a==null?void 0:a.borrow_amount_min}function D(){var o,c,i,n,_;if(!l.value){x({type:"warning",message:f("mining.max_number")});return}if(l.value<Number(s.value.borrow_amount_min)){x({type:"warning",message:f("mining.lazy_weight")});return}if(l.value>Number((o=s.value)==null?void 0:o.borrow_amount_max)){x({type:"warning",message:f("tc.loanTips",{day:(c=s.value)==null?void 0:c.lock_dividend_days,amount:(i=s.value)==null?void 0:i.borrow_amount_max})});return}if(h.value>((n=C.user)==null?void 0:n.usdt)){te({message:f("tc.lack")}).then(()=>{N.push("/mine/charge")}).catch(()=>{});return}b.value=!0;const a={id:(_=s.value)==null?void 0:_.id,amount:l.value};Z(a).then(m=>{console.log("res",m),m.type==="ok"&&N.push("/loaned")}).finally(()=>{b.value=!1})}return(a,o)=>{var L,$,z,F;const c=P,i=ne,n=K("i18n-t"),_=W,m=Q,I=oe,H=ae,R=ee;return p(),w(T,null,[e(i,{title:a.$t("loan.loan"),fixed:"",placeholder:""},{right:u(()=>[e(c,{name:"orders-o",size:"24",onClick:o[0]||(o[0]=d=>a.$router.push("/loan/record"))})]),_:1},8,["title"]),t("div",se,[t("div",le,[t("p",ie,[e(n,{keypath:"loan.start_loan"})]),r(V)?(p(),g(m,{key:0,type:"primary"},{icon:u(()=>[e(_,{size:"16",color:"white"})]),default:u(()=>[e(n,{keypath:"loan.verify"})]),_:1})):(p(),g(m,{key:1,icon:"checked",type:"primary"},{default:u(()=>[e(n,{keypath:"loan.verified"})]),_:1}))]),t("div",re,[e(n,{keypath:"tc.amount"})]),e(I,{class:"row",modelValue:r(l),"onUpdate:modelValue":o[2]||(o[2]=d=>S(l)?l.value=d:null),placeholder:a.$t("loan.input_amount")},{"right-icon":u(()=>[e(m,{type:"primary",size:"small",onClick:o[1]||(o[1]=d=>{var v;return l.value=(v=r(s))==null?void 0:v.borrow_amount_max})},{default:u(()=>[e(n,{keypath:"loan.max"})]),_:1})]),_:1},8,["modelValue","placeholder"]),t("div",de,[e(n,{keypath:"tc.margin"})]),e(I,{class:"row",modelValue:r(h),"onUpdate:modelValue":o[3]||(o[3]=d=>S(h)?h.value=d:null),readonly:""},null,8,["modelValue"]),t("div",ue,[e(n,{keypath:"loan.loan_time"})]),e(R,null,{default:u(()=>[(p(!0),w(T,null,X(r(B),d=>{var v;return p(),g(H,{type:"primary",size:"large",plain:d.lock_dividend_days!==((v=r(s))==null?void 0:v.lock_dividend_days),key:d.id,onClick:Ce=>M(d)},{default:u(()=>[Y(k(d.lock_dividend_days)+" ",1),e(n,{keypath:"loan.day"})]),_:2},1032,["plain","onClick"])}),128))]),_:1}),t("div",ce,[t("div",me,[t("div",_e,[e(n,{keypath:"loan.day_rate"})]),(L=r(s))!=null&&L.borrow_lixi?(p(),w("div",pe,k(Number((($=r(s))==null?void 0:$.borrow_lixi)*100).toFixed(3))+" % ",1)):O("",!0)]),t("div",ve,[t("div",ye,[e(n,{keypath:"tc.minimum"})]),t("div",fe,k((z=r(s))==null?void 0:z.borrow_amount_min),1)]),t("div",he,[t("div",ke,[e(n,{keypath:"tc.maximum"})]),t("div",be,k((F=r(s))==null?void 0:F.borrow_amount_max),1)])]),e(m,{type:"primary",block:"",loading:r(b),onClick:D},{default:u(()=>[e(n,{keypath:"tc.apply"})]),_:1},8,["loading"]),t("div",{class:"rule my-3 font-sm",innerHTML:a.$t("loan.rule")},null,8,we)])],64)}}},Se=E(ge,[["__scopeId","data-v-a179d2b2"]]);export{Se as default};
