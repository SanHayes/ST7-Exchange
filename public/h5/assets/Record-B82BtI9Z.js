import{_ as Y,v as D,a7 as N,y as g,b as o,A as l,D as n,F as y,s as B,z as R,G as i,I as z,H,J as d,P as _,K as I,L as M,R as m,Q as V,bv as j,a9 as F,bw as G}from"./index--vZnXzCg.js";import{L as T}from"./index-DIcH8UOr.js";import{C as x}from"./index-C_kpMHjb.js";import{C as A}from"./index-zpiD-kUy.js";import{N as E}from"./index-Vg5CfP6E.js";import{h as v}from"./moment-C5S46NFB.js";import{s as J}from"./function-call-2JieT8HP.js";import"./use-tab-status-DexSgyP9.js";const K={class:"no"},O={class:"mr-3"},P={class:"text-right pa-3"},Q={__name:"Record",setup(S){const{t:b}=D(),h=B(),e=N({page:0,list:[],loading:!1,finished:!1,error:!1,limit:10,submitLoading:!1});function k(){e.page+=1,e.page,e.limit,h.params.id,G().then(a=>{if((a==null?void 0:a.type)==="ok"){const{data:s=[],total:c,last_page:u}=a.data;e.list.push(...s),(!u||u===e.page)&&(e.finished=!0)}else e.error=!0}).catch(a=>{e.error=!0}).finally(()=>{e.loading=!1})}function C(){Object.assign(e,{page:0,loading:!1,finished:!1,error:!1,list:[]})}function L(a){J({message:b("loan.confirm_repayment")+"?"}).then(()=>{e.submitLoading=!0,j({orderId:a}).then(s=>{s.type==="ok"&&(F({type:"success",message:s.message}),setTimeout(()=>{C()},300))}).finally(()=>{e.submitLoading=!1})})}return(a,s)=>{const c=z,u=E,r=A,f=R("i18n-t"),p=V,$=x,w=T;return i(),g(y,null,[o(u,{title:a.$t("loan.loan"),fixed:"",placeholder:""},{left:l(()=>[o(c,{"class-prefix":"iconfont",name:"back",onClick:s[0]||(s[0]=t=>a.$router.back())})]),_:1},8,["title"]),o(w,{class:"list ma-5",loading:n(e).loading,"onUpdate:loading":s[1]||(s[1]=t=>n(e).loading=t),finished:n(e).finished,error:n(e).error,"finished-text":a.$t("mining.no_more"),onLoad:k},{default:l(()=>[(i(!0),g(y,null,H(n(e).list,t=>(i(),d($,{key:t.id,class:"mb-3 row",border:!1},{default:l(()=>[o(r,{border:!1,value:n(v)(t.created_at).format("YYYY-MM-DD HH:mm:ss")},{title:l(()=>[_("div",K,[s[2]||(s[2]=I(" # ")),_("span",O,M(t.borrow_id),1)])]),_:2},1032,["value"]),o(r,{title:a.$t("loan.amount"),value:t.amount,border:!1},null,8,["title","value"]),o(r,{title:a.$t("loan.loan_time"),value:t.lock_dividend_days+a.$t("loan.day"),border:!1},null,8,["title","value"]),o(r,{title:a.$t("loan.total_profit"),value:t.sum_profit,border:!1},null,8,["title","value"]),o(r,{title:a.$t("loan.day_rate"),value:t.day_profit+"%",border:!1},null,8,["title","value"]),o(r,{title:a.$t("loan.reviewed_at"),value:n(v)(t.sub_time).format("YYYY-MM-DD HH:mm:ss"),border:!1},null,8,["title","value"]),_("div",P,[t.status===1?(i(),d(p,{key:0,type:"primary",disabled:"",size:"small"},{default:l(()=>[o(f,{keypath:"loan.auth_waiting"})]),_:1})):m("",!0),t.status===4?(i(),d(p,{key:1,type:"danger",disabled:"",size:"small"},{default:l(()=>[o(f,{keypath:"loan.is_rejected"})]),_:1})):m("",!0),t.status===3?(i(),d(p,{key:2,type:"success",readonly:"",size:"small"},{default:l(()=>[o(f,{keypath:"loan.is_repay"})]),_:1})):m("",!0),t.status===2?(i(),d(p,{key:3,loading:n(e).submitLoading,type:"primary",size:"small",onClick:U=>L(t.id)},{default:l(()=>[o(f,{keypath:"loan.to_repayment"})]),_:2},1032,["loading","onClick"])):m("",!0)])]),_:2},1024))),128))]),_:1},8,["loading","finished","error","finished-text"])],64)}}},se=Y(Q,[["__scopeId","data-v-de74c011"]]);export{se as default};
