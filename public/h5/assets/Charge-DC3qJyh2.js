import{X as P,E as w,x as u,s as B,D as I,a as s,z as a,F as N,C as v,a_ as Y,i as $,N as H,a$ as M,P as V,O,L as r,v as q,_ as E,H as Q,I as T,b0 as z,b1 as G,Z as L}from"./index-DotFs6hQ.js";import"./index-CYJzgihW.js";/* empty css              */import{U as S}from"./index-D4wHe91h.js";/* empty css              */import{P as X}from"./index-D-_dDmgc.js";import{C as Z}from"./index-BGvW-Xgq.js";import{F as A}from"./index-CPIY3Ody.js";import{N as J}from"./index-n0gQ9ulz.js";import{L as K}from"./index-YthvjXtT.js";import{C as W}from"./index-CdgWwUic.js";import{h as ee}from"./moment-C5S46NFB.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Q as te}from"./browser-DT0BrSGx.js";import{c as oe}from"./utils-BNJ9K5xU.js";import{B as ae}from"./index-DFHfScTq.js";import"./index-CkMyTJnu.js";import"./index-CR8qj5FJ.js";import"./use-route-_DyoSwqD.js";import"./use-id-DPiuflnV.js";import"./use-placeholder-fxdmpSj4.js";import"./use-tab-status-CQMEfgWc.js";import"./_commonjsHelpers-C932wzq6.js";const se={__name:"ChargeRecord",setup(U,{expose:e}){const n=P({page:0,list:[],loading:!1,finished:!1,error:!1,limit:10});function g(){n.page+=1;const i={page:n.page,limit:n.limit};Y(i).then(c=>{if((c==null?void 0:c.type)==="ok"){const{data:m=[],total:_,pages:f}=c.data;n.list.push(...m),f===n.page&&(n.finished=!0)}}).catch(c=>{n.error=!0}).finally(()=>{n.loading=!1})}function h(){Object.assign(n,{page:0,list:[],loading:!1,finished:!1,error:!1,limit:10})}return e({reset:h}),(i,c)=>{const m=Z,_=W,f=K;return v(),w(f,{class:"",loading:a(n).loading,"onUpdate:loading":c[0]||(c[0]=t=>a(n).loading=t),finished:a(n).finished,error:a(n).error,"finished-text":i.$t("mining.no_more"),onLoad:g},{default:u(()=>[(v(!0),B(N,null,I(a(n).list,t=>(v(),w(_,{class:"row mb-3",border:!1,key:t.id},{default:u(()=>[s(m,{title:i.$t("deposit.number_of_coins"),value:t.amount,border:!1},null,8,["title","value"]),s(m,{title:i.$t("deposit.type"),value:i.$t("deposit.digital_currency"),border:!1},null,8,["title","value"]),s(m,{title:i.$t("deposit.unit"),value:t.name,border:!1},null,8,["title","value"]),s(m,{title:i.$t("deposit.status"),value:t.status_name,border:!1},null,8,["title","value"]),s(m,{title:i.$t("deposit.time"),value:a(ee)(t.created_at).format("YYYY-MM-DD HH:mm:ss"),border:!1},null,8,["title","value"])]),_:2},1024))),128))]),_:1},8,["loading","finished","error","finished-text"])}}},ne=R(se,[["__scopeId","data-v-fa6c1c5f"]]),le={class:"main pa-3"},ie={class:"label font-md"},re={class:"flex qr-code justify-center"},de={class:"code"},ce={class:"row"},me={class:"text-center mb-3"},pe={class:"label font-md"},ue={class:"label font-md"},fe={class:"flex align-center justify-center my-3"},_e={class:"my-5"},ve={class:"label font-md mb-3"},ge={__name:"Charge",setup(U){const e=P({currency:"",pickerValue:[],columns:[],show:!1,cnumbers:null,loading:!1,fileList:[],filePath:""}),n=$(()=>e.columns.find(t=>t.agreement===e.currency)),g=({selectedValues:t,selectedOptions:o})=>{var l;e.currency=(l=o[0])==null?void 0:l.agreement,e.pickerValue=t,e.show=!1};H(()=>{M().then(t=>{if(t.type==="ok"){const o=t.data||[];e.columns=o;const l=o[0];l&&(e.currency=l.agreement,e.pickerValue=[l])}})});const h={text:"agreement",value:"id"},i=V("canvas");O(n,t=>{t&&te.toCanvas(i.value,t.payment_address,{width:240,height:240})});function c(t){console.log(t.file),t.status="uploading";const o=new FormData;o.append("file",t.file),o.append("type",0),z(o).then(l=>{t.status="done",e.filePath=l.file_path}).catch(l=>{t.status="error"})}const m=$(()=>!e.currency||!e.cnumbers||!e.filePath),_=V("record");function f(){var o;const t={currency:(o=n.value)==null?void 0:o.id,account:e.filePath,amount:e.cnumbers};e.loading=!0,G(t).then(l=>{l.type==="ok"?(L({type:"success",message:l.message}),setTimeout(()=>{e.cnumbers=null,e.filePath="",e.fileList=[],_.value.reset()},200)):L({type:"danger",message:l.message})}).finally(()=>{e.loading=!1})}return(t,o)=>{var k;const l=T,x=J,p=q("i18n-t"),y=A,D=X,F=E,b=ae,j=S;return v(),B(N,null,[s(x,{title:t.$t("deposit.deposit"),fixed:"",placeholder:""},{left:u(()=>[s(l,{"class-prefix":"iconfont",name:"back",onClick:o[0]||(o[0]=d=>t.$router.back())})]),_:1},8,["title"]),r("div",le,[r("div",ie,[s(p,{keypath:"deposit.digital_currency"})]),s(y,{class:"row",modelValue:a(e).currency,"onUpdate:modelValue":o[1]||(o[1]=d=>a(e).currency=d),"is-link":"",readonly:"",name:"picker",placeholder:"",border:!1,onClick:o[2]||(o[2]=d=>a(e).show=!0)},null,8,["modelValue"]),s(F,{show:a(e).show,"onUpdate:show":o[4]||(o[4]=d=>a(e).show=d),"destroy-on-close":"",position:"bottom"},{default:u(()=>[s(D,{columns:a(e).columns,"columns-field-names":h,"model-value":a(e).pickerValue,onConfirm:g,onCancel:o[3]||(o[3]=d=>a(e).show=!1)},null,8,["columns","model-value"])]),_:1},8,["show"]),r("div",re,[r("div",de,[r("canvas",{ref_key:"canvas",ref:i},null,512)])]),r("div",ce,Q((k=a(n))==null?void 0:k.payment_address),1),r("div",me,[s(b,{type:"primary",onClick:o[5]||(o[5]=d=>{var C;return a(oe)((C=a(n))==null?void 0:C.payment_address)})},{default:u(()=>[s(p,{keypath:"deposit.copy"})]),_:1})]),r("div",pe,[s(p,{keypath:"deposit.number_of_coins"})]),s(y,{class:"row",modelValue:a(e).cnumbers,"onUpdate:modelValue":o[6]||(o[6]=d=>a(e).cnumbers=d),placeholder:t.$t("deposit.enter_number_coins")},null,8,["modelValue","placeholder"]),r("div",ue,[s(p,{keypath:"deposit.payment_voucher"})]),r("div",fe,[s(j,{accept:"image/*",multiple:!1,"max-count":1,modelValue:a(e).fileList,"onUpdate:modelValue":o[7]||(o[7]=d=>a(e).fileList=d),"after-read":c},null,8,["modelValue"])]),r("div",_e,[s(b,{type:"primary",block:"",loading:a(e).loading,disabled:a(m),onClick:f},{default:u(()=>[s(p,{keypath:"deposit.submit"})]),_:1},8,["loading","disabled"])]),r("div",ve,[s(p,{keypath:"deposit.deposit_record"})]),s(ne,{ref:"record"},null,512)])],64)}}},qe=R(ge,[["__scopeId","data-v-86f2d8bc"]]);export{qe as default};
