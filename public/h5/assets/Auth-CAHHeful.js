import{_ as q,v as H,ae as K,r as M,O as T,aZ as W,k as X,y as c,b as s,A as p,D as t,S as Y,F as g,M as r,J as _,R as m,z as ee,Q as ae,G as i,I as te,aR as S,ai as E,a_ as oe}from"./index-Bu2moHUJ.js";import{C as se}from"./index-BGyGGoT5.js";import{C as ne}from"./index-CpoYOss3.js";import{I as le}from"./index-ZFtFRY-l.js";/* empty css              */import{U as re}from"./index-BiA-5mFG.js";import{F as ie}from"./index-BEDRDnHK.js";import{N as de}from"./index-CtDu_9ne.js";import{d as A}from"./utils-BFA0n0DP.js";import"./index-DciA7G_n.js";import"./use-id-BEyoK7QE.js";const ce="/h5/assets/id-front-B29VUS8_.png",pe="/h5/assets/id-background-BvafEgth.png",ue={key:0,class:"text-center"},_e={key:1,class:"main pa-3"},me={class:"text-center"},fe={class:"label font-md"},he={class:"label font-md"},ve={class:"row"},ke={key:0,class:"front"},ge={class:"btn"},be={class:"font-sm tips"},ye={class:"row"},Fe={key:0,class:"front"},Ve={class:"btn"},we={class:"font-sm tips"},Le={class:"text-center"},Ce={class:"row"},Be={class:"row"},Pe={__name:"Auth",setup($e){const{t:b}=H(),e=K({name:"",card:"",frontFileList:[],frontFilePath:"",backFileList:[],backFilePath:"",loading:!1,pageLoading:!1,info:null}),f=M(""),h=M(!0);T(()=>{y()});function y(){e.pageLoading=!0,W().then(o=>{var a;if(o.type==="ok"){e.info=o.data;const n=(a=o.data)==null?void 0:a.real_data;e.name=n.name,e.card=n.card_id,e.frontFileList=[{url:"/storage/"+n.front_pic}],e.frontFilePath=n.front_pic,e.backFileList=[{url:"/storage/"+n.reverse_pic}],e.backFilePath=n.reverse_pic,e.notes=n.notes||""}}).finally(()=>{e.pageLoading=!1})}function R(o){o.status="uploading";const a=new FormData;a.append("file",o.file),a.append("type",0),S(a).then(n=>{o.status="done",e.frontFilePath=n.file_path}).catch(()=>{o.status="error"})}function x(o){o.status="uploading";const a=new FormData;a.append("file",o.file),a.append("type",0),S(a).then(n=>{o.status="done",e.backFilePath=n.file_path}).catch(()=>{o.status="error"})}const G=X(()=>!e.name||!e.card||!e.frontFilePath||!e.backFilePath);function J(){A(e.card)?(h.value=!1,f.value=""):(h.value=!0,f.value=b("real.idCardErrMessage"))}function O(){const o={id_type:0,name:e.name,card_id:e.card,real_type:1,front_pic:e.frontFilePath,reverse_pic:e.backFilePath};if(!A(o.card_id))return E({type:"warning",message:b("real.idCardErrMessage")});e.loading=!0,oe(o).then(a=>{(a==null?void 0:a.type)==="ok"&&(E({type:"success",message:a.message}),e.loading=!1,y())}).finally(()=>{e.loading=!1})}return(o,a)=>{var w,L,C,B,P,$,I,U;const n=te,Q=de,Z=Y,d=ee("i18n-t"),v=ie,u=le,k=ae,F=re,V=ne,j=se;return i(),c(g,null,[s(Q,{title:o.$t("real.real_name_auth"),fixed:"",placeholder:""},{left:p(()=>[s(n,{"class-prefix":"iconfont",name:"back",onClick:a[0]||(a[0]=l=>o.$router.back())})]),_:1},8,["title"]),t(e).pageLoading?(i(),c("div",ue,[s(Z,{size:"24"})])):(i(),c("div",_e,[[0,3].includes((w=t(e).info)==null?void 0:w.real_status)?(i(),c(g,{key:0},[r("div",me,[((L=t(e).info)==null?void 0:L.real_status)===3?(i(),_(d,{key:0,keypath:"real.failed"})):m("",!0)]),r("div",fe,[s(d,{keypath:"real.improve_information"})]),s(v,{class:"row",label:o.$t("real.name"),modelValue:t(e).name,"onUpdate:modelValue":a[1]||(a[1]=l=>t(e).name=l),placeholder:o.$t("real.enter_name")},null,8,["label","modelValue","placeholder"]),s(v,{class:"row",modelValue:t(e).card,"onUpdate:modelValue":[a[2]||(a[2]=l=>t(e).card=l),J],label:o.$t("real.passport_idnumber"),placeholder:o.$t("real.enter_passport_idnumber"),error:t(h),"error-message":t(f)},null,8,["modelValue","label","placeholder","error","error-message"]),((C=t(e).info)==null?void 0:C.real_status)===3?(i(),_(v,{key:0,class:"row",label:o.$t("out.remarks"),modelValue:t(e).notes,"onUpdate:modelValue":a[3]||(a[3]=l=>t(e).notes=l),readonly:""},null,8,["label","modelValue"])):m("",!0),r("div",he,[s(d,{keypath:"real.upload_the_front_and_back"})]),r("div",ve,[s(F,{modelValue:t(e).frontFileList,"onUpdate:modelValue":a[4]||(a[4]=l=>t(e).frontFileList=l),"max-count":1,"preview-size":["auto","20vh"],"after-read":R},{default:p(()=>[t(e).frontFileList.length?m("",!0):(i(),c("div",ke,[s(u,{src:t(ce)},null,8,["src"]),r("div",ge,[s(k,{icon:"plus",round:"",type:"primary",size:"small"})]),r("p",be,[s(d,{keypath:"real.front"})])]))]),_:1},8,["modelValue"])]),r("div",ye,[s(F,{modelValue:t(e).backFileList,"onUpdate:modelValue":a[5]||(a[5]=l=>t(e).backFileList=l),"max-count":1,"preview-size":["auto","20vh"],"after-read":x},{default:p(()=>[t(e).backFileList.length?m("",!0):(i(),c("div",Fe,[s(u,{src:t(pe)},null,8,["src"]),r("div",Ve,[s(k,{icon:"plus",round:"",type:"primary",size:"small"})]),r("p",we,[s(d,{keypath:"real.back"})])]))]),_:1},8,["modelValue"])]),s(k,{type:"primary",block:"",loading:t(e).loading,disabled:t(G),onClick:O},{default:p(()=>[s(d,{keypath:"real.submit"})]),_:1},8,["loading","disabled"])],64)):(i(),c(g,{key:1},[r("div",Le,[((B=t(e).info)==null?void 0:B.real_status)===1?(i(),_(d,{key:0,keypath:"real.under_review"})):(i(),_(d,{key:1,keypath:"real.finish"}))]),s(j,null,{default:p(()=>{var l,D,z,N;return[s(V,{title:o.$t("real.name"),value:(D=(l=t(e).info)==null?void 0:l.real_data)==null?void 0:D.name},null,8,["title","value"]),s(V,{title:o.$t("real.passport_idnumber"),value:(N=(z=t(e).info)==null?void 0:z.real_data)==null?void 0:N.card_id},null,8,["title","value"])]}),_:1}),r("div",Ce,[s(u,{src:"/storage/"+(($=(P=t(e).info)==null?void 0:P.real_data)==null?void 0:$.front_pic)},null,8,["src"])]),r("div",Be,[s(u,{src:"/storage/"+((U=(I=t(e).info)==null?void 0:I.real_data)==null?void 0:U.reverse_pic)},null,8,["src"])])],64))]))],64)}}},Ge=q(Pe,[["__scopeId","data-v-80e4c4bd"]]);export{Ge as default};
