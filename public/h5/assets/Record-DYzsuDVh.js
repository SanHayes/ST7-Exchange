import{_ as w,v as D,a1 as N,y as g,b as o,A as l,D as n,F as y,s as B,z,G as r,I as H,H as I,J as d,O as _,K as R,L as M,P as m,Q as V,bq as j,a3 as F,br as G}from"./index-DnIob8_j.js";import{L as O}from"./index-3CS8h7oP.js";import{C as T}from"./index-Dgu3waGc.js";import{C as q}from"./index-Cp5D7UjK.js";import{N as x}from"./index-hvZgoHL9.js";import{h as v}from"./moment-C5S46NFB.js";import{s as A}from"./function-call-CtyusbW_.js";import"./use-tab-status-BkTnG_q8.js";const E={class:"no"},J={class:"mr-3"},K={class:"text-right pa-3"},P={__name:"Record",setup(Q){const{t:b}=D(),h=B(),e=N({page:0,list:[],loading:!1,finished:!1,error:!1,limit:10,submitLoading:!1});function k(){e.page+=1,e.page,e.limit,h.params.id,G().then(a=>{if((a==null?void 0:a.type)==="ok"){const{data:s=[],total:c,last_page:u}=a.data;e.list.push(...s),(!u||u===e.page)&&(e.finished=!0)}else e.error=!0}).catch(a=>{e.error=!0}).finally(()=>{e.loading=!1})}function C(){Object.assign(e,{page:0,loading:!1,finished:!1,error:!1,list:[]})}function L(a){A({message:b("loan.confirm_repayment")+"?"}).then(()=>{e.submitLoading=!0,j({orderId:a}).then(s=>{s.type==="ok"&&(F({type:"success",message:s.message}),setTimeout(()=>{C()},300))}).finally(()=>{e.submitLoading=!1})})}return(a,s)=>{const c=H,u=x,i=q,f=z("i18n-t"),p=V,$=T,Y=O;return r(),g(y,null,[o(u,{title:a.$t("loan.loan"),fixed:"",placeholder:""},{left:l(()=>[o(c,{"class-prefix":"iconfont",name:"back",onClick:s[0]||(s[0]=t=>a.$router.back())})]),_:1},8,["title"]),o(Y,{class:"list ma-5",loading:n(e).loading,"onUpdate:loading":s[1]||(s[1]=t=>n(e).loading=t),finished:n(e).finished,error:n(e).error,"finished-text":a.$t("mining.no_more"),onLoad:k},{default:l(()=>[(r(!0),g(y,null,I(n(e).list,t=>(r(),d($,{key:t.id,class:"mb-3 row",border:!1},{default:l(()=>[o(i,{border:!1,value:n(v)(t.created_at).format("YYYY-MM-DD HH:mm:ss")},{title:l(()=>[_("div",E,[s[2]||(s[2]=R(" # ")),_("span",J,M(t.borrow_id),1)])]),_:2},1032,["value"]),o(i,{title:a.$t("loan.amount"),value:t.amount,border:!1},null,8,["title","value"]),o(i,{title:a.$t("loan.loan_time"),value:t.lock_dividend_days+a.$t("loan.day"),border:!1},null,8,["title","value"]),o(i,{title:a.$t("loan.total_profit"),value:t.sum_profit,border:!1},null,8,["title","value"]),o(i,{title:a.$t("loan.day_rate"),value:t.day_profit+"%",border:!1},null,8,["title","value"]),o(i,{title:a.$t("loan.reviewed_at"),value:n(v)(t.sub_time).format("YYYY-MM-DD HH:mm:ss"),border:!1},null,8,["title","value"]),_("div",K,[t.status===1?(r(),d(p,{key:0,type:"primary",disabled:"",size:"small"},{default:l(()=>[o(f,{keypath:"loan.auth_waiting"})]),_:1})):m("",!0),t.status===4?(r(),d(p,{key:1,type:"danger",disabled:"",size:"small"},{default:l(()=>[o(f,{keypath:"loan.is_rejected"})]),_:1})):m("",!0),t.status===3?(r(),d(p,{key:2,type:"success",readonly:"",size:"small"},{default:l(()=>[o(f,{keypath:"loan.is_repay"})]),_:1})):m("",!0),t.status===2?(r(),d(p,{key:3,loading:n(e).submitLoading,type:"primary",size:"small",onClick:S=>L(t.id)},{default:l(()=>[o(f,{keypath:"loan.to_repayment"})]),_:2},1032,["loading","onClick"])):m("",!0)])]),_:2},1024))),128))]),_:1},8,["loading","finished","error","finished-text"])],64)}}},se=w(P,[["__scopeId","data-v-de74c011"]]);export{se as default};
