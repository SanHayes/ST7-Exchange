import{_ as M,N as O,v as R,r as v,O as U,ah as A,k as G,y as $,b as e,M as o,A as c,J as g,z as H,D as d,C as L,L as k,Q as J,F,E as K,G as y,I as Q,S as q,H as P,K as W,ai as x,aj as X}from"./index-TumWjzH3.js";import{S as Y}from"./index-1Eb2hdn0.js";import{T as Z}from"./index-C-U57Vpv.js";import"./index-Ccz0zBtd.js";import{F as ee}from"./index-B2w9dJQO.js";import{N as ae}from"./index-DXJoUNoH.js";import{s as oe}from"./function-call-DISSziOY.js";import"./use-id-P00KxrJF.js";const ne={class:"main ma-3"},te={class:"verified text-center pa-5 mb-3"},se={class:"font-md"},le={class:"label font-md mb-3"},ie={class:"label font-md my-2"},re={class:"label font-md my-2"},de={class:"row my-3 pa-3 font-md"},ce={class:"flex space-between"},_e={class:"label"},ue={class:"value"},me={class:"flex space-between"},pe={class:"label"},ve={class:"value"},ye={class:"flex space-between"},fe={class:"label"},he={class:"value"},ke={class:"rule my-3 font-sm"},be={__name:"Index",setup(we){const b=O(),C=K(),{t:f}=R(),N=v(!0),V=v([]),l=v(""),s=v(null),w=v(!1);U(async()=>{Object.keys(b.user).length||await b.userInfo()}),A().then(n=>{var t,_;if(n.type==="ok"){const i=((t=n.data)==null?void 0:t.data)||[];V.value=i.sort((a,m)=>a.lock_dividend_days-m.lock_dividend_days),i!=null&&i.length&&(s.value=i[0],l.value=(_=i[0])==null?void 0:_.borrow_amount_min)}}).finally(()=>{N.value=!1});const h=G(()=>{var n;return((n=s.value)==null?void 0:n.borrow_margin)*l.value||0});function T(n){s.value=n,l.value=n==null?void 0:n.borrow_amount_min}function D(){var t,_,i,a,m;if(!l.value){x({type:"warning",message:f("mining.max_number")});return}if(l.value<Number(s.value.borrow_amount_min)){x({type:"warning",message:f("mining.lazy_weight")});return}if(l.value>Number((t=s.value)==null?void 0:t.borrow_amount_max)){x({type:"warning",message:f("tc.loanTips",{day:(_=s.value)==null?void 0:_.lock_dividend_days,amount:(i=s.value)==null?void 0:i.borrow_amount_max})});return}if(h.value>((a=b.user)==null?void 0:a.usdt)){oe({message:f("tc.lack")}).then(()=>{C.push("/mine/charge")}).catch(()=>{});return}w.value=!0;const n={id:(m=s.value)==null?void 0:m.id,amount:l.value};X(n).then(u=>{console.log("res",u),u.type==="ok"&&C.push("/loaned")}).finally(()=>{w.value=!1})}return(n,t)=>{var I,z,S;const _=Q,i=ae,a=H("i18n-t"),m=q,u=J,B=ee,j=Z,E=Y;return y(),$(F,null,[e(i,{title:n.$t("loan.loan"),fixed:"",placeholder:""},{right:c(()=>[e(_,{name:"orders-o",size:"24",onClick:t[0]||(t[0]=r=>n.$router.push("/loan/record"))})]),_:1},8,["title"]),o("div",ne,[o("div",te,[o("p",se,[e(a,{keypath:"loan.start_loan"})]),d(N)?(y(),g(u,{key:0,type:"primary"},{icon:c(()=>[e(m,{size:"16",color:"white"})]),default:c(()=>[e(a,{keypath:"loan.verify"})]),_:1})):(y(),g(u,{key:1,icon:"checked",type:"primary"},{default:c(()=>[e(a,{keypath:"loan.verified"})]),_:1}))]),o("div",le,[e(a,{keypath:"tc.amount"})]),e(B,{class:"row",modelValue:d(l),"onUpdate:modelValue":t[2]||(t[2]=r=>L(l)?l.value=r:null),placeholder:n.$t("loan.input_amount")},{"right-icon":c(()=>[e(u,{type:"primary",size:"small",onClick:t[1]||(t[1]=r=>{var p;return l.value=(p=d(s))==null?void 0:p.borrow_amount_max})},{default:c(()=>[e(a,{keypath:"loan.max"})]),_:1})]),_:1},8,["modelValue","placeholder"]),o("div",ie,[e(a,{keypath:"tc.margin"})]),e(B,{class:"row",modelValue:d(h),"onUpdate:modelValue":t[3]||(t[3]=r=>L(h)?h.value=r:null),readonly:""},null,8,["modelValue"]),o("div",re,[e(a,{keypath:"loan.loan_time"})]),e(E,null,{default:c(()=>[(y(!0),$(F,null,P(d(V),r=>{var p;return y(),g(j,{type:"primary",size:"large",plain:r.lock_dividend_days!==((p=d(s))==null?void 0:p.lock_dividend_days),key:r.id,onClick:ge=>T(r)},{default:c(()=>[W(k(r.lock_dividend_days)+" ",1),e(a,{keypath:"loan.day"})]),_:2},1032,["plain","onClick"])}),128))]),_:1}),o("div",de,[o("div",ce,[o("div",_e,[e(a,{keypath:"loan.day_rate"})]),o("div",ue,k((I=d(s))==null?void 0:I.borrow_lixi)+" % ",1)]),o("div",me,[o("div",pe,[e(a,{keypath:"tc.minimum"})]),o("div",ve,k((z=d(s))==null?void 0:z.borrow_amount_min),1)]),o("div",ye,[o("div",fe,[e(a,{keypath:"tc.maximum"})]),o("div",he,k((S=d(s))==null?void 0:S.borrow_amount_max),1)])]),e(u,{type:"primary",block:"",loading:d(w),onClick:D},{default:c(()=>[e(a,{keypath:"tc.apply"})]),_:1},8,["loading"]),o("div",ke,[e(a,{keypath:"loan.rule"})])])],64)}}},$e=M(be,[["__scopeId","data-v-673a77f4"]]);export{$e as default};
