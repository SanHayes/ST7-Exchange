import{p as B,X as L,r as I,s as y,a as e,x as o,z as p,F as h,v as N,C as r,I as z,D as R,E as d,L as V,M as f}from"./index-C7glgVMJ.js";import{L as A}from"./index-CurFfn_2.js";import{C as D}from"./index-D17H275x.js";import{S as E}from"./index-Dckis3ke.js";import{C as F}from"./index-CCE9-dNp.js";import{T as S}from"./index-BIdAE3K2.js";import{N as T}from"./index-RB0KY4Iw.js";import{r as q,a as G}from"./news-CbJbENoF.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as O}from"./index-DGKYMm1Q.js";import{s as P}from"./function-call-BANSgb2_.js";import"./use-tab-status-BSvecJue.js";import"./index-BsuD2U6L.js";import"./use-route-CYJMck8x.js";import"./use-placeholder-DOMsP5qW.js";const U={class:"text-right flex justify-right align-center px-4"},X={__name:"Record",setup(H){const{t:m}=B(),n=L({page:0,list:[],loading:!1,finished:!1,error:!1,limit:10});function k(){n.page+=1;const a={page:n.page,limit:n.limit};G(a).then(i=>{if((i==null?void 0:i.type)==="ok"){const{data:c=[],total:g,last_page:s}=i.data;n.list.push(...c),s===n.page&&(n.finished=!0)}}).catch(i=>{n.error=!0}).finally(()=>{n.loading=!1})}const _=I(null),b=a=>new Promise(async i=>{a!=="confirm"&&i(!0),await q({orderId:_.value.id}),i(!0),w()});function C(a){_.value=a,P({message:m("mining.payment")+a.wyj+m("mining.liquidated_damages"),beforeClose:b})}function w(){Object.assign(n,{page:0,loading:!1,finished:!1,error:!1,list:[]})}return(a,i)=>{const c=z,g=T,s=N("i18n-t"),u=S,l=F,v=O,$=E,j=D,x=A;return r(),y(h,null,[e(g,{title:a.$t("mining.subscription_list"),fixed:"",placeholder:""},{left:o(()=>[e(c,{"class-prefix":"iconfont",name:"back",onClick:i[0]||(i[0]=t=>a.$router.back())})]),_:1},8,["title"]),e(x,{class:"list ma-5",loading:p(n).loading,"onUpdate:loading":i[1]||(i[1]=t=>p(n).loading=t),finished:p(n).finished,error:p(n).error,"finished-text":a.$t("mining.no_more"),onLoad:k},{default:o(()=>[(r(!0),y(h,null,R(p(n).list,t=>(r(),d(j,{key:t.id,class:"mb-3 row",border:!1},{default:o(()=>[e(l,{title:t.project.project_name,border:!1,size:"normal"},{"right-icon":o(()=>[t.status==="have in hand"?(r(),d(u,{key:0,type:"primary",plain:""},{default:o(()=>[e(s,{keypath:"mining.underway"})]),_:1})):f("",!0),t.status==="Apply for refund"?(r(),d(u,{key:1,type:"warning"},{default:o(()=>[e(s,{keypath:"mining.applying_refund"})]),_:1})):f("",!0),t.status==="deposit"?(r(),d(u,{key:2},{default:o(()=>[e(s,{keypath:"mining.deposit"})]),_:1})):f("",!0),t.status==="Refunded"?(r(),d(u,{key:3,type:"success"},{default:o(()=>[e(s,{keypath:"mining.refund_successful"})]),_:1})):f("",!0)]),_:2},1032,["title"]),e(l,{title:a.$t("mining.number_application"),value:t.amount,border:!1},null,8,["title","value"]),e(l,{title:a.$t("mining.Application_time"),value:t.interest_gen_next_time,border:!1},null,8,["title","value"]),e(l,{title:a.$t("mining.expected_nissan"),value:t.day_profit,border:!1},null,8,["title","value"]),e(l,{title:a.$t("mining.projected_total_revenue"),value:t.sum_profit,border:!1},null,8,["title","value"]),V("div",U,[e($,null,{default:o(()=>[e(v,{size:"small",type:"warning",disabled:t.status!=="have in hand",onClick:J=>C(t)},{default:o(()=>[e(s,{keypath:"mining.redemption_default"})]),_:2},1032,["disabled","onClick"]),e(v,{size:"small",type:"primary"},{default:o(()=>[e(s,{keypath:"mining.view_earnings_list"})]),_:1})]),_:2},1024)])]),_:2},1024))),128))]),_:1},8,["loading","finished","error","finished-text"])],64)}}},de=M(X,[["__scopeId","data-v-a0fee7a9"]]);export{de as default};
