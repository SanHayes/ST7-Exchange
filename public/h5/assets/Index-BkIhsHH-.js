import{_ as U,N as j,v as A,r as y,O as G,ah as H,k as J,y as w,b as e,M as n,A as c,J as g,z as K,D as r,C as L,R as O,L as k,Q,F as T,E as q,G as p,I as P,S as W,H as X,K as Y,ai as x,aj as Z}from"./index-Bu2moHUJ.js";import{S as ee}from"./index-WrjGnjlB.js";import{T as ae}from"./index-C0Jj2eO0.js";import"./index-CpoYOss3.js";import{F as oe}from"./index-BEDRDnHK.js";import{N as te}from"./index-CtDu_9ne.js";import{s as ne}from"./function-call-DSO97weu.js";import"./use-id-BEyoK7QE.js";const se={class:"main ma-3"},le={class:"verified text-center pa-5 mb-3"},ie={class:"font-md"},re={class:"label font-md mb-3"},de={class:"label font-md my-2"},ce={class:"label font-md my-2"},ue={class:"row my-3 pa-3 font-md"},_e={class:"flex space-between"},me={class:"label"},pe={key:0,class:"value"},ve={class:"flex space-between"},ye={class:"label"},fe={class:"value"},he={class:"flex space-between"},ke={class:"label"},be={class:"value"},we={class:"rule my-3 font-sm"},ge={__name:"Index",setup(xe){const C=j(),N=q(),{t:f}=A(),V=y(!0),B=y([]),l=y(""),s=y(null),b=y(!1);G(async()=>{await C.userInfo()}),H().then(t=>{var o,u;if(t.type==="ok"){const i=((o=t.data)==null?void 0:o.data)||[];B.value=i.sort((a,m)=>a.lock_dividend_days-m.lock_dividend_days),i!=null&&i.length&&(s.value=i[0],l.value=(u=i[0])==null?void 0:u.borrow_amount_min)}}).finally(()=>{V.value=!1});const h=J(()=>{var t,o;return!((t=s.value)!=null&&t.borrow_margin)||!l.value?0:(((o=s.value)==null?void 0:o.borrow_margin)*l.value).toFixed(2)});function D(t){s.value=t,l.value=t==null?void 0:t.borrow_amount_min}function R(){var o,u,i,a,m;if(!l.value){x({type:"warning",message:f("mining.max_number")});return}if(l.value<Number(s.value.borrow_amount_min)){x({type:"warning",message:f("mining.lazy_weight")});return}if(l.value>Number((o=s.value)==null?void 0:o.borrow_amount_max)){x({type:"warning",message:f("tc.loanTips",{day:(u=s.value)==null?void 0:u.lock_dividend_days,amount:(i=s.value)==null?void 0:i.borrow_amount_max})});return}if(h.value>((a=C.user)==null?void 0:a.usdt)){ne({message:f("tc.lack")}).then(()=>{N.push("/mine/charge")}).catch(()=>{});return}b.value=!0;const t={id:(m=s.value)==null?void 0:m.id,amount:l.value};Z(t).then(_=>{console.log("res",_),_.type==="ok"&&N.push("/loaned")}).finally(()=>{b.value=!1})}return(t,o)=>{var z,F,S,$;const u=P,i=te,a=K("i18n-t"),m=W,_=Q,I=oe,E=ae,M=ee;return p(),w(T,null,[e(i,{title:t.$t("loan.loan"),fixed:"",placeholder:""},{right:c(()=>[e(u,{name:"orders-o",size:"24",onClick:o[0]||(o[0]=d=>t.$router.push("/loan/record"))})]),_:1},8,["title"]),n("div",se,[n("div",le,[n("p",ie,[e(a,{keypath:"loan.start_loan"})]),r(V)?(p(),g(_,{key:0,type:"primary"},{icon:c(()=>[e(m,{size:"16",color:"white"})]),default:c(()=>[e(a,{keypath:"loan.verify"})]),_:1})):(p(),g(_,{key:1,icon:"checked",type:"primary"},{default:c(()=>[e(a,{keypath:"loan.verified"})]),_:1}))]),n("div",re,[e(a,{keypath:"tc.amount"})]),e(I,{class:"row",modelValue:r(l),"onUpdate:modelValue":o[2]||(o[2]=d=>L(l)?l.value=d:null),placeholder:t.$t("loan.input_amount")},{"right-icon":c(()=>[e(_,{type:"primary",size:"small",onClick:o[1]||(o[1]=d=>{var v;return l.value=(v=r(s))==null?void 0:v.borrow_amount_max})},{default:c(()=>[e(a,{keypath:"loan.max"})]),_:1})]),_:1},8,["modelValue","placeholder"]),n("div",de,[e(a,{keypath:"tc.margin"})]),e(I,{class:"row",modelValue:r(h),"onUpdate:modelValue":o[3]||(o[3]=d=>L(h)?h.value=d:null),readonly:""},null,8,["modelValue"]),n("div",ce,[e(a,{keypath:"loan.loan_time"})]),e(M,null,{default:c(()=>[(p(!0),w(T,null,X(r(B),d=>{var v;return p(),g(E,{type:"primary",size:"large",plain:d.lock_dividend_days!==((v=r(s))==null?void 0:v.lock_dividend_days),key:d.id,onClick:Ce=>D(d)},{default:c(()=>[Y(k(d.lock_dividend_days)+" ",1),e(a,{keypath:"loan.day"})]),_:2},1032,["plain","onClick"])}),128))]),_:1}),n("div",ue,[n("div",_e,[n("div",me,[e(a,{keypath:"loan.day_rate"})]),(z=r(s))!=null&&z.borrow_lixi?(p(),w("div",pe,k(Number((F=r(s))==null?void 0:F.borrow_lixi).toFixed(3))+" % ",1)):O("",!0)]),n("div",ve,[n("div",ye,[e(a,{keypath:"tc.minimum"})]),n("div",fe,k((S=r(s))==null?void 0:S.borrow_amount_min),1)]),n("div",he,[n("div",ke,[e(a,{keypath:"tc.maximum"})]),n("div",be,k(($=r(s))==null?void 0:$.borrow_amount_max),1)])]),e(_,{type:"primary",block:"",loading:r(b),onClick:R},{default:c(()=>[e(a,{keypath:"tc.apply"})]),_:1},8,["loading"]),n("div",we,[e(a,{keypath:"loan.rule"})])])],64)}}},Le=U(ge,[["__scopeId","data-v-9839baa9"]]);export{Le as default};
