import{_ as L,ae as P,J as w,A as m,y as R,H as I,b as s,D as a,F as U,G as v,aP as Q,k as $,T as Y,aQ as x,W as V,V as H,P as r,z as M,ac as T,L as q,Q as G,I as O,aR as S,aS as z,ai as A}from"./index-Duiu1Gv4.js";import"./index-CM9-s5yJ.js";/* empty css              */import{U as E}from"./index-D4HiOymA.js";/* empty css              */import{P as J}from"./index-BghFPah3.js";import{C as W}from"./index-Dt4AWYn-.js";import{F as K}from"./index-BboBTqNW.js";import{N as X}from"./index-BDCQpW2K.js";import{L as Z}from"./index--3AHX_3t.js";import{C as ee}from"./index-D5eD0Ryq.js";import{h as te}from"./moment-C5S46NFB.js";import{s as oe,c as ae}from"./utils-DNa7tqSd.js";import{Q as se}from"./browser-DT0BrSGx.js";import"./index-tXRF0sRM.js";import"./use-id-BD64h31R.js";import"./use-tab-status-CPtm9LQY.js";import"./_commonjsHelpers-C932wzq6.js";const ne={__name:"ChargeRecord",setup(B,{expose:e}){const n=P({page:0,list:[],loading:!1,finished:!1,error:!1,limit:10});function h(){n.page+=1;const l={page:n.page,limit:n.limit};Q(l).then(u=>{if((u==null?void 0:u.type)==="ok"){const{data:d=[],total:_,pages:f}=u.data;n.list.push(...d),(f===n.page||!d.length)&&(n.finished=!0)}}).catch(u=>{n.error=!0}).finally(()=>{n.loading=!1})}function g(){Object.assign(n,{page:0,list:[],loading:!1,finished:!1,error:!1,limit:10})}return e({reset:g}),(l,u)=>{const d=W,_=ee,f=Z;return v(),w(f,{class:"",loading:a(n).loading,"onUpdate:loading":u[0]||(u[0]=t=>a(n).loading=t),finished:a(n).finished,error:a(n).error,"finished-text":l.$t("mining.no_more"),onLoad:h},{default:m(()=>[(v(!0),R(U,null,I(a(n).list,t=>(v(),w(_,{class:"row mb-3",border:!1,key:t.id},{default:m(()=>[s(d,{title:l.$t("deposit.number_of_coins"),value:a(oe)(t.amount,3),border:!1},null,8,["title","value"]),s(d,{title:l.$t("deposit.type"),value:l.$t("deposit.digital_currency"),border:!1},null,8,["title","value"]),s(d,{title:l.$t("deposit.unit"),value:t.name,border:!1},null,8,["title","value"]),s(d,{title:l.$t("deposit.status"),value:l.$t("code.deposit."+t.status),border:!1},null,8,["title","value"]),s(d,{title:l.$t("out.remarks"),value:t.notes,border:!1},null,8,["title","value"]),s(d,{title:l.$t("deposit.time"),value:a(te)(t.created_at).format("YYYY-MM-DD HH:mm:ss"),border:!1},null,8,["title","value"])]),_:2},1024))),128))]),_:1},8,["loading","finished","error","finished-text"])}}},le=L(ne,[["__scopeId","data-v-c6b56b5c"]]),ie={class:"main pa-3"},re={class:"label font-md"},de={class:"flex qr-code justify-center"},ce={class:"code"},ue={class:"row"},pe={class:"text-center mb-3"},me={class:"label font-md"},fe={class:"label font-md"},_e={class:"flex align-center justify-center my-3"},ve={class:"my-5"},he={class:"label font-md mb-3"},ge={__name:"Charge",setup(B){const e=P({currency:"",pickerValue:[],columns:[],show:!1,cnumbers:null,loading:!1,fileList:[],filePath:""}),n=$(()=>e.columns.find(t=>t.agreement===e.currency)),h=({selectedValues:t,selectedOptions:o})=>{var i;e.currency=(i=o[0])==null?void 0:i.agreement,e.pickerValue=t,e.show=!1};Y(()=>{x().then(t=>{if(t.type==="ok"){const o=t.data||[];e.columns=o;const i=o[0];i&&(e.currency=i.agreement,e.pickerValue=[i])}})});const g={text:"agreement",value:"id"},l=V("canvas");H(n,t=>{t&&se.toCanvas(l.value,t.payment_address,{width:240,height:240})});function u(t){console.log(t.file),t.status="uploading";const o=new FormData;o.append("file",t.file),o.append("type",0),S(o).then(i=>{t.status="done",e.filePath=i.file_path}).catch(i=>{t.status="error"})}const d=$(()=>!e.currency||!e.cnumbers||!e.filePath),_=V("record");function f(){var o;const t={currency:(o=n.value)==null?void 0:o.id,account:e.filePath,amount:e.cnumbers};e.loading=!0,z(t).then(i=>{i.type==="ok"&&(A({type:"success",message:i.message}),setTimeout(()=>{e.cnumbers=null,e.filePath="",e.fileList=[],_.value.reset()},200))}).finally(()=>{e.loading=!1})}return(t,o)=>{var k;const i=O,D=X,p=M("i18n-t"),y=K,F=J,N=T,b=G,j=E;return v(),R(U,null,[s(D,{title:t.$t("deposit.deposit"),fixed:"",placeholder:""},{left:m(()=>[s(i,{"class-prefix":"iconfont",name:"back",onClick:o[0]||(o[0]=c=>t.$router.back())})]),_:1},8,["title"]),r("div",ie,[r("div",re,[s(p,{keypath:"deposit.digital_currency"})]),s(y,{class:"row",modelValue:a(e).currency,"onUpdate:modelValue":o[1]||(o[1]=c=>a(e).currency=c),"is-link":"",readonly:"",name:"picker",placeholder:"",border:!1,onClick:o[2]||(o[2]=c=>a(e).show=!0)},null,8,["modelValue"]),s(N,{show:a(e).show,"onUpdate:show":o[4]||(o[4]=c=>a(e).show=c),"destroy-on-close":"",position:"bottom","safe-area-inset-bottom":!0},{default:m(()=>[s(F,{columns:a(e).columns,"columns-field-names":g,"model-value":a(e).pickerValue,onConfirm:h,onCancel:o[3]||(o[3]=c=>a(e).show=!1)},null,8,["columns","model-value"])]),_:1},8,["show"]),r("div",de,[r("div",ce,[r("canvas",{ref_key:"canvas",ref:l},null,512)])]),r("div",ue,q((k=a(n))==null?void 0:k.payment_address),1),r("div",pe,[s(b,{type:"primary",onClick:o[5]||(o[5]=c=>{var C;return a(ae)((C=a(n))==null?void 0:C.payment_address)})},{default:m(()=>[s(p,{keypath:"deposit.copy"})]),_:1})]),r("div",me,[s(p,{keypath:"deposit.number_of_coins"})]),s(y,{class:"row",modelValue:a(e).cnumbers,"onUpdate:modelValue":o[6]||(o[6]=c=>a(e).cnumbers=c),placeholder:t.$t("deposit.enter_number_coins")},null,8,["modelValue","placeholder"]),r("div",fe,[s(p,{keypath:"deposit.payment_voucher"})]),r("div",_e,[s(j,{accept:"image/*",multiple:!1,"max-count":1,modelValue:a(e).fileList,"onUpdate:modelValue":o[7]||(o[7]=c=>a(e).fileList=c),"after-read":u},null,8,["modelValue"])]),r("div",ve,[s(b,{type:"primary",block:"",loading:a(e).loading,disabled:a(d),onClick:f},{default:m(()=>[s(p,{keypath:"deposit.submit"})]),_:1},8,["loading","disabled"])]),r("div",he,[s(p,{keypath:"deposit.deposit_record"})]),s(le,{ref:"record"},null,512)])],64)}}},Ye=L(ge,[["__scopeId","data-v-ba35ea1b"]]);export{Ye as default};
