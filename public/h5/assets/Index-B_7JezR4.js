var $o=Object.defineProperty;var Ho=(s,t,e)=>t in s?$o(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var Qt=(s,t,e)=>Ho(s,typeof t!="symbol"?t+"":t,e);import{d as Qo,n as gi,m as Je,t as Ze,c as jo,r as q,k as yt,Z as ps,$ as Go,V as Jt,a0 as Uo,b as B,a1 as sn,a2 as rn,p as gs,a3 as ms,a4 as _s,a5 as ys,Y as Jo,a6 as Zo,a7 as on,e as Ko,a8 as qo,a9 as ta,w as ea,aa as Oi,_ as Qe,T as Yn,X as Wi,ab as Ir,y as it,M as z,A as ot,K as oe,L as rt,D as A,I as Xn,C as we,ac as di,S as Yi,F as Ot,G as Q,N as $n,R as Hn,z as Xi,ad as ve,v as Qn,ae as Tr,J as jt,Q as kr,O as Dr,H as li,U as ws,s as ia,af as na}from"./index-C59WfAV9.js";import{C as sa}from"./index-CNb9idrL.js";import{C as jn}from"./index-DoGVdPo7.js";import{T as $i}from"./index-CkDPlaUk.js";/* empty css              *//* empty css              */import{q as ra}from"./index-BnF8-XuV.js";import{g as oa,i as an,s as aa}from"./utils-Cle2ad26.js";import{u as Hi}from"./scoket-BWVIV4i6.js";import{P as Gn}from"./index-BgHWqvyN.js";import{I as Ar}from"./index-BH3P3huK.js";import{F as Rr}from"./index-C8WCAi7y.js";import{s as Fr}from"./function-call-CFVlGoKa.js";import{S as Br}from"./index-EMP4Og3F.js";import{T as la,a as ha}from"./index-F0HvL_65.js";import"./_commonjsHelpers-C932wzq6.js";import"./use-id-B0WZ9kAI.js";import"./use-tab-status-Bl9-JFp9.js";import"./index-mcb0bVRk.js";const[ua,mi]=jo("stepper"),ca=200,_i=(s,t)=>String(s)===String(t),da={min:Je(1),max:Je(1/0),name:Je(""),step:Je(1),theme:String,integer:Boolean,disabled:Boolean,showPlus:Ze,showMinus:Ze,showInput:Ze,longPress:Ze,autoFixed:Ze,allowEmpty:Boolean,modelValue:gi,inputWidth:gi,buttonSize:gi,placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,defaultValue:Je(1),decimalLength:gi};var fa=Qo({name:ua,props:da,emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(s,{emit:t}){const e=(S,C=!0)=>{const{min:E,max:I,allowEmpty:P,decimalLength:T}=s;return P&&S===""||(S=_s(String(S),!s.integer),S=S===""?0:+S,S=Number.isNaN(S)?+E:S,S=C?Math.max(Math.min(+I,S),+E):S,ys(T)&&(S=S.toFixed(+T))),S},i=()=>{var S;const C=(S=s.modelValue)!=null?S:s.defaultValue,E=e(C);return _i(E,s.modelValue)||t("update:modelValue",E),E};let n;const r=q(),o=q(i()),a=yt(()=>s.disabled||s.disableMinus||+o.value<=+s.min),l=yt(()=>s.disabled||s.disablePlus||+o.value>=+s.max),h=yt(()=>({width:ps(s.inputWidth),height:ps(s.buttonSize)})),u=yt(()=>Go(s.buttonSize)),c=()=>{const S=e(o.value);_i(S,o.value)||(o.value=S)},d=S=>{s.beforeChange?Ko(s.beforeChange,{args:[S],done(){o.value=S}}):o.value=S},f=()=>{if(n==="plus"&&l.value||n==="minus"&&a.value){t("overlimit",n);return}const S=n==="minus"?-s.step:+s.step,C=e(ta(+o.value,S));d(C),t(n)},v=S=>{const C=S.target,{value:E}=C,{decimalLength:I}=s;let P=_s(String(E),!s.integer);if(ys(I)&&P.includes(".")){const R=P.split(".");P=`${R[0]}.${R[1].slice(0,+I)}`}s.beforeChange?C.value=String(o.value):_i(E,P)||(C.value=P);const T=P===String(+P);d(T?+P:P)},p=S=>{var C;s.disableInput?(C=r.value)==null||C.blur():t("focus",S)},g=S=>{const C=S.target,E=e(C.value,s.autoFixed);C.value=String(E),o.value=E,Jo(()=>{t("blur",S),Zo()})};let m,_;const w=()=>{_=setTimeout(()=>{f(),w()},ca)},y=()=>{s.longPress&&(m=!1,clearTimeout(_),_=setTimeout(()=>{m=!0,f(),w()},qo))},x=S=>{s.longPress&&(clearTimeout(_),m&&on(S))},M=S=>{s.disableInput&&on(S)},b=S=>({onClick:C=>{on(C),n=S,f()},onTouchstartPassive:()=>{n=S,y()},onTouchend:x,onTouchcancel:x});return Jt(()=>[s.max,s.min,s.integer,s.decimalLength],c),Jt(()=>s.modelValue,S=>{_i(S,o.value)||(o.value=e(S))}),Jt(o,S=>{t("update:modelValue",S),t("change",S,{name:s.name})}),Uo(()=>s.modelValue),()=>B("div",{role:"group",class:mi([s.theme])},[sn(B("button",gs({type:"button",style:u.value,class:[mi("minus",{disabled:a.value}),{[ms]:!a.value}],"aria-disabled":a.value||void 0},b("minus")),null),[[rn,s.showMinus]]),sn(B("input",{ref:r,type:s.integer?"tel":"text",role:"spinbutton",class:mi("input"),value:o.value,style:h.value,disabled:s.disabled,readonly:s.disableInput,inputmode:s.integer?"numeric":"decimal",placeholder:s.placeholder,autocomplete:"off","aria-valuemax":s.max,"aria-valuemin":s.min,"aria-valuenow":o.value,onBlur:g,onInput:v,onFocus:p,onMousedown:M},null),[[rn,s.showInput]]),sn(B("button",gs({type:"button",style:u.value,class:[mi("plus",{disabled:l.value}),{[ms]:!l.value}],"aria-disabled":l.value||void 0},b("plus")),null),[[rn,s.showPlus]])])}});const va=ea(fa);/**
     * @license
     * KLineChart v9.8.12
     * Copyright (c) 2019 lihu.
     * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
     */var Dn=function(s,t){return Dn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])},Dn(s,t)};function Y(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Dn(s,t);function e(){this.constructor=s}s.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var N=function(){return N=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},N.apply(this,arguments)};function Be(s,t,e,i){function n(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(u){try{h(i.next(u))}catch(c){o(c)}}function l(u){try{h(i.throw(u))}catch(c){o(c)}}function h(u){u.done?r(u.value):n(u.value).then(a,l)}h((i=i.apply(s,[])).next())})}function Ve(s,t){var e={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,n,r,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(u){return l([h,u])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,h[0]&&(e=0)),e;)try{if(i=1,n&&(r=h[0]&2?n.return:h[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,h[1])).done)return r;switch(n=0,r&&(h=[h[0]&2,r.value]),h[0]){case 0:case 1:r=h;break;case 4:return e.label++,{value:h[1],done:!1};case 5:e.label++,n=h[1],h=[0];continue;case 7:h=e.ops.pop(),e.trys.pop();continue;default:if(r=e.trys,!(r=r.length>0&&r[r.length-1])&&(h[0]===6||h[0]===2)){e=0;continue}if(h[0]===3&&(!r||h[1]>r[0]&&h[1]<r[3])){e.label=h[1];break}if(h[0]===6&&e.label<r[1]){e.label=r[1],r=h;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(h);break}r[2]&&e.ops.pop(),e.trys.pop();continue}h=t.call(s,e)}catch(u){h=[6,u],n=0}finally{i=r=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function be(s){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&s[t],i=0;if(e)return e.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&i>=s.length&&(s=void 0),{value:s&&s[i++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ee(s,t){var e=typeof Symbol=="function"&&s[Symbol.iterator];if(!e)return s;var i=e.call(s),n,r=[],o;try{for(;(t===void 0||t-- >0)&&!(n=i.next()).done;)r.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return r}function Vr(s,t,e){if(arguments.length===2)for(var i=0,n=t.length,r;i<n;i++)(r||!(i in t))&&(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return s.concat(r||Array.prototype.slice.call(t))}var G;(function(s){s.Dashed="dashed",s.Solid="solid"})(G||(G={}));var H;(function(s){s.Stroke="stroke",s.Fill="fill",s.StrokeFill="stroke_fill"})(H||(H={}));var Oe;(function(s){s.Always="always",s.FollowCross="follow_cross",s.None="none"})(Oe||(Oe={}));var zt;(function(s){s.Standard="standard",s.Rect="rect"})(zt||(zt={}));var ni;(function(s){s.Left="left",s.Middle="middle",s.Right="right"})(ni||(ni={}));var Di;(function(s){s.Fixed="fixed",s.Pointer="pointer"})(Di||(Di={}));var Pt;(function(s){s.CandleSolid="candle_solid",s.CandleStroke="candle_stroke",s.CandleUpStroke="candle_up_stroke",s.CandleDownStroke="candle_down_stroke",s.Ohlc="ohlc",s.Area="area"})(Pt||(Pt={}));var le;(function(s){s.Left="left",s.Right="right"})(le||(le={}));var vt;(function(s){s.Normal="normal",s.Percentage="percentage",s.Log="log"})(vt||(vt={}));var yi="#F92855",ln="rgba(249, 40, 85, .7)",wi="#2DC08E",hn="rgba(45, 192, 142, .7)",pe="#888888",Qi="#FFFFFF",St="#1677FF",me="#76808F",An="#DDDDDD";function Le(s){return"rgba(22, 119, 255, ".concat(s,")")}function pa(){function s(){return{show:!0,size:1,color:"#EDEDED",style:G.Dashed,dashedValue:[2,2]}}return{show:!0,horizontal:s(),vertical:s()}}function ga(){var s={show:!0,color:me,textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"};return{type:Pt.CandleSolid,bar:{upColor:wi,downColor:yi,noChangeColor:pe,upBorderColor:wi,downBorderColor:yi,noChangeBorderColor:pe,upWickColor:wi,downWickColor:yi,noChangeWickColor:pe},area:{lineSize:2,lineColor:St,smooth:!1,value:"close",backgroundColor:[{offset:0,color:Le(.01)},{offset:1,color:Le(.2)}],point:{show:!0,color:St,radius:4,rippleColor:Le(.3),rippleRadius:8,animation:!0,animationDuration:1e3}},priceMark:{show:!0,high:N({},s),low:N({},s),last:{show:!0,upColor:wi,downColor:yi,noChangeColor:pe,line:{show:!0,style:G.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:H.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:G.Solid,borderSize:0,borderDashedValue:[2,2],color:Qi,family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:Oe.Always,showType:zt.Standard,custom:[{title:"time",value:"{time}"},{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}],defaultValue:"n/a",rect:{position:Di.Fixed,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,offsetLeft:4,offsetTop:4,offsetRight:4,offsetBottom:4,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:me,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},icons:[]}}}function ma(){var s=["#FF9600","#935EBD",St,"#E11D74","#01C5C4"].map(function(t){return{style:G.Solid,smooth:!1,size:1,dashedValue:[2,2],color:t}});return{ohlc:{upColor:hn,downColor:ln,noChangeColor:pe},bars:[{style:H.Fill,borderStyle:G.Solid,borderSize:1,borderDashedValue:[2,2],upColor:hn,downColor:ln,noChangeColor:pe}],lines:s,circles:[{style:H.Fill,borderStyle:G.Solid,borderSize:1,borderDashedValue:[2,2],upColor:hn,downColor:ln,noChangeColor:pe}],lastValueMark:{show:!1,text:{show:!1,style:H.Fill,color:Qi,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:G.Solid,borderColor:"transparent",borderSize:0,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:Oe.Always,showType:zt.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:me,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},icons:[]}}}function Lr(){return{show:!0,size:"auto",axisLine:{show:!0,color:An,size:1},tickText:{show:!0,color:me,size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:An}}}function _a(){var s=Lr();return s.type=vt.Normal,s.position=le.Right,s.inside=!1,s.reverse=!1,s}function ya(){function s(){return{show:!0,line:{show:!0,style:G.Dashed,dashedValue:[4,2],size:1,color:me},text:{show:!0,style:H.Fill,color:Qi,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:G.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:me,borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:me}}}return{show:!0,horizontal:s(),vertical:s()}}function wa(){var s=Le(.35),t=Le(.25);function e(){return{style:H.Fill,color:Qi,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:G.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:St,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:St}}return{point:{color:St,borderColor:s,borderSize:1,radius:5,activeColor:St,activeBorderColor:s,activeBorderSize:3,activeRadius:5},line:{style:G.Solid,smooth:!1,color:St,size:1,dashedValue:[2,2]},rect:{style:H.Fill,color:t,borderColor:St,borderSize:1,borderRadius:0,borderStyle:G.Solid,borderDashedValue:[2,2]},polygon:{style:H.Fill,color:St,borderColor:St,borderSize:1,borderStyle:G.Solid,borderDashedValue:[2,2]},circle:{style:H.Fill,color:t,borderColor:St,borderSize:1,borderStyle:G.Solid,borderDashedValue:[2,2]},arc:{style:G.Solid,color:St,size:1,dashedValue:[2,2]},text:e(),rectText:e()}}function ba(){return{size:1,color:An,fill:!0,activeBackgroundColor:Le(.08)}}function Sa(){return{grid:pa(),candle:ga(),indicator:ma(),xAxis:Lr(),yAxis:_a(),separator:ba(),crosshair:ya(),overlay:wa()}}function kt(s,t){if(!(!Wt(s)&&!Wt(t))){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var i=s[e],n=t[e];Wt(n)&&Wt(i)?kt(i,n):k(t[e])&&(s[e]=hi(t[e]))}}}function hi(s){if(!Wt(s))return s;var t;Ft(s)?t=[]:t={};for(var e in s)if(Object.prototype.hasOwnProperty.call(s,e)){var i=s[e];Wt(i)?t[e]=hi(i):t[e]=i}return t}function Ft(s){return Object.prototype.toString.call(s)==="[object Array]"}function Zt(s){return typeof s=="function"}function Wt(s){return typeof s=="object"&&k(s)}function V(s){return typeof s=="number"&&!isNaN(s)}function k(s){return s!=null}function _e(s){return typeof s=="boolean"}function O(s){return typeof s=="string"}var xa=/\\(\\)?/g,Ca=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g");function gt(s,t,e){if(k(s)){var i=[];t.replace(Ca,function(a){for(var l=[],h=1;h<arguments.length;h++)l[h-1]=arguments[h];var u=a;return k(l[1])?u=l[2].replace(xa,"$1"):k(l[0])&&(u=l[0].trim()),i.push(u),""});for(var n=s,r=0,o=i.length;k(n)&&r<o;)n=n==null?void 0:n[i[r++]];return k(n)?n:e??"--"}return e??"--"}function Ma(s,t,e){var i={};return s.formatToParts(new Date(t)).forEach(function(n){var r=n.type,o=n.value;switch(r){case"year":{i.YYYY=o;break}case"month":{i.MM=o;break}case"day":{i.DD=o;break}case"hour":{i.HH=o==="24"?"00":o;break}case"minute":{i.mm=o;break}case"second":{i.ss=o;break}}}),e.replace(/YYYY|MM|DD|HH|mm|ss/g,function(n){return i[n]})}function ut(s,t){var e=+s;return V(e)?e.toFixed(t??2):"".concat(s)}function Ea(s){var t=+s;if(V(t)){if(t>1e9)return"".concat(+(t/1e9).toFixed(3),"B");if(t>1e6)return"".concat(+(t/1e6).toFixed(3),"M");if(t>1e3)return"".concat(+(t/1e3).toFixed(3),"K")}return"".concat(s)}function ct(s,t){var e="".concat(s);if(t.length===0)return e;if(e.includes(".")){var i=e.split(".");return"".concat(i[0].replace(/(\d)(?=(\d{3})+$)/g,function(n){return"".concat(n).concat(t)}),".").concat(i[1])}return e.replace(/(\d)(?=(\d{3})+$)/g,function(n){return"".concat(n).concat(t)})}function ft(s,t){var e="".concat(s),i=new RegExp("\\.0{"+t+",}[1-9][0-9]*$");if(i.test(e)){var n=e.split("."),r=n[n.length-1],o=r.match(/0*/);if(k(o)){var a=o[0].length;return n[n.length-1]=r.replace(/0*/,"0{".concat(a,"}")),n.join(".")}}return e}var Ke;function ae(s){var t,e,i;return(i=(e=(t=s.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||e===void 0?void 0:e.devicePixelRatio)!==null&&i!==void 0?i:1}function Se(s,t,e){return"".concat(t??"normal"," ").concat(s??12,"px ").concat(e??"Helvetica Neue")}function Ai(s,t,e,i){if(!k(Ke)){var n=document.createElement("canvas"),r=ae(n);Ke=n.getContext("2d"),Ke.scale(r,r)}return Ke.font=Se(t,e,i),Math.round(Ke.measureText(s).width)}var Tt;(function(s){s.OnDataReady="onDataReady",s.OnZoom="onZoom",s.OnScroll="onScroll",s.OnVisibleRangeChange="onVisibleRangeChange",s.OnTooltipIconClick="onTooltipIconClick",s.OnCrosshairChange="onCrosshairChange",s.OnCandleBarClick="onCandleBarClick",s.OnPaneDrag="onPaneDrag"})(Tt||(Tt={}));var Pa=function(){function s(){this._callbacks=[]}return s.prototype.subscribe=function(t){var e,i=(e=this._callbacks.indexOf(t))!==null&&e!==void 0?e:-1;i<0&&this._callbacks.push(t)},s.prototype.unsubscribe=function(t){var e;if(Zt(t)){var i=(e=this._callbacks.indexOf(t))!==null&&e!==void 0?e:-1;i>-1&&this._callbacks.splice(i,1)}else this._callbacks=[]},s.prototype.execute=function(t){this._callbacks.forEach(function(e){e(t)})},s.prototype.isEmpty=function(){return this._callbacks.length===0},s}(),It;(function(s){s.Init="init",s.Forward="forward",s.Backward="backward"})(It||(It={}));var Ct;(function(s){s.Normal="normal",s.Price="price",s.Volume="volume"})(Ct||(Ct={}));function Un(s,t,e,i,n){var r=t.result,o=t.figures,a=t.styles,l=gt(a,"circles",i.circles),h=l.length,u=gt(a,"bars",i.bars),c=u.length,d=gt(a,"lines",i.lines),f=d.length,v=0,p=0,g=0,m,_=0;o.forEach(function(w){var y;switch(w.type){case"circle":{_=v;var x=l[v%h];m=N(N({},x),{color:x.noChangeColor}),v++;break}case"bar":{_=p;var M=u[p%c];m=N(N({},M),{color:M.noChangeColor}),p++;break}case"line":{_=g,m=d[g%f],g++;break}}if(k(m)){var b={prev:{kLineData:s[e-1],indicatorData:r[e-1]},current:{kLineData:s[e],indicatorData:r[e]},next:{kLineData:s[e+1],indicatorData:r[e+1]}},S=(y=w.styles)===null||y===void 0?void 0:y.call(w,b,t,i);n(w,N(N({},m),S),_)}})}var Ia=function(){function s(t){this.result=[],this._precisionFlag=!1;var e=t.name,i=t.shortName,n=t.series,r=t.calcParams,o=t.figures,a=t.precision,l=t.shouldOhlc,h=t.shouldFormatBigNumber,u=t.visible,c=t.zLevel,d=t.minValue,f=t.maxValue,v=t.styles,p=t.extendData,g=t.regenerateFigures,m=t.createTooltipDataSource,_=t.draw;this.name=e,this.shortName=i??e,this.series=n??Ct.Normal,this.precision=a??4,this.calcParams=r??[],this.figures=o??[],this.shouldOhlc=l??!1,this.shouldFormatBigNumber=h??!1,this.visible=u??!0,this.zLevel=c??0,this.minValue=d??null,this.maxValue=f??null,this.styles=hi(v??{}),this.extendData=p,this.regenerateFigures=g??null,this.createTooltipDataSource=m??null,this.draw=_??null}return s.prototype.setShortName=function(t){return this.shortName!==t?(this.shortName=t,!0):!1},s.prototype.setSeries=function(t){return this.series!==t?(this.series=t,!0):!1},s.prototype.setPrecision=function(t,e){var i=e??!1,n=Math.floor(t);return n!==this.precision&&t>=0&&(!i||i&&!this._precisionFlag)?(this.precision=n,i||(this._precisionFlag=!0),!0):!1},s.prototype.setCalcParams=function(t){var e,i;return this.calcParams=t,this.figures=(i=(e=this.regenerateFigures)===null||e===void 0?void 0:e.call(this,t))!==null&&i!==void 0?i:this.figures,!0},s.prototype.setShouldOhlc=function(t){return this.shouldOhlc!==t?(this.shouldOhlc=t,!0):!1},s.prototype.setShouldFormatBigNumber=function(t){return this.shouldFormatBigNumber!==t?(this.shouldFormatBigNumber=t,!0):!1},s.prototype.setVisible=function(t){return this.visible!==t?(this.visible=t,!0):!1},s.prototype.setZLevel=function(t){return this.zLevel!==t?(this.zLevel=t,!0):!1},s.prototype.setStyles=function(t){return kt(this.styles,t),!0},s.prototype.setExtendData=function(t){return this.extendData!==t?(this.extendData=t,!0):!1},s.prototype.setFigures=function(t){return this.figures!==t?(this.figures=t,!0):!1},s.prototype.setMinValue=function(t){return this.minValue!==t?(this.minValue=t,!0):!1},s.prototype.setMaxValue=function(t){return this.maxValue!==t?(this.maxValue=t,!0):!1},s.prototype.setRegenerateFigures=function(t){return this.regenerateFigures!==t?(this.regenerateFigures=t,!0):!1},s.prototype.setCreateTooltipDataSource=function(t){return this.createTooltipDataSource!==t?(this.createTooltipDataSource=t,!0):!1},s.prototype.setDraw=function(t){return this.draw!==t?(this.draw=t,!0):!1},s.prototype.calcIndicator=function(t){return Be(this,void 0,void 0,function(){var e;return Ve(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.calc(t,this)];case 1:return e=i.sent(),this.result=e,[2,!0];case 2:return i.sent(),[2,!1];case 3:return[2]}})})},s.extend=function(t){var e=function(i){Y(n,i);function n(){return i.call(this,t)||this}return n.prototype.calc=function(r,o){return t.calc(r,o)},n}(s);return e},s}(),Ne;(function(s){s.Normal="normal",s.WeakMagnet="weak_magnet",s.StrongMagnet="strong_magnet"})(Ne||(Ne={}));function Ta(){return["mouseClickEvent","mouseDoubleClickEvent","mouseRightClickEvent","tapEvent","doubleTapEvent","mouseDownEvent","touchStartEvent","mouseMoveEvent","touchMoveEvent"]}var bs=1,qe=-1,ka="overlay_",Ae="overlay_figure_",Da=function(){function s(t){this.currentStep=bs,this.points=[],this._prevPressedPoint=null,this._prevPressedPoints=[];var e=t.mode,i=t.modeSensitivity,n=t.extendData,r=t.styles,o=t.name,a=t.totalStep,l=t.lock,h=t.visible,u=t.zLevel,c=t.needDefaultPointFigure,d=t.needDefaultXAxisFigure,f=t.needDefaultYAxisFigure,v=t.createPointFigures,p=t.createXAxisFigures,g=t.createYAxisFigures,m=t.performEventPressedMove,_=t.performEventMoveForDrawing,w=t.onDrawStart,y=t.onDrawing,x=t.onDrawEnd,M=t.onClick,b=t.onDoubleClick,S=t.onRightClick,C=t.onPressedMoveStart,E=t.onPressedMoving,I=t.onPressedMoveEnd,P=t.onMouseEnter,T=t.onMouseLeave,R=t.onRemoved,L=t.onSelected,F=t.onDeselected;this.name=o,this.totalStep=!V(a)||a<2?1:a,this.lock=l??!1,this.visible=h??!0,this.zLevel=u??0,this.needDefaultPointFigure=c??!1,this.needDefaultXAxisFigure=d??!1,this.needDefaultYAxisFigure=f??!1,this.mode=e??Ne.Normal,this.modeSensitivity=i??8,this.extendData=n,this.styles=hi(r??{}),this.createPointFigures=v??null,this.createXAxisFigures=p??null,this.createYAxisFigures=g??null,this.performEventPressedMove=m??null,this.performEventMoveForDrawing=_??null,this.onDrawStart=w??null,this.onDrawing=y??null,this.onDrawEnd=x??null,this.onClick=M??null,this.onDoubleClick=b??null,this.onRightClick=S??null,this.onPressedMoveStart=C??null,this.onPressedMoving=E??null,this.onPressedMoveEnd=I??null,this.onMouseEnter=P??null,this.onMouseLeave=T??null,this.onRemoved=R??null,this.onSelected=L??null,this.onDeselected=F??null}return s.prototype.setId=function(t){return O(this.id)?!1:(this.id=t,!0)},s.prototype.setGroupId=function(t){return O(this.groupId)?!1:(this.groupId=t,!0)},s.prototype.setPaneId=function(t){this.paneId=t},s.prototype.setExtendData=function(t){return t!==this.extendData?(this.extendData=t,!0):!1},s.prototype.setStyles=function(t){return kt(this.styles,t),!0},s.prototype.setPoints=function(t){if(t.length>0){var e=void 0;if(this.points=Vr([],Ee(t),!1),t.length>=this.totalStep-1?(this.currentStep=qe,e=this.totalStep-1):(this.currentStep=t.length+1,e=t.length),this.performEventMoveForDrawing!==null)for(var i=0;i<e;i++)this.performEventMoveForDrawing({currentStep:i+2,mode:this.mode,points:this.points,performPointIndex:i,performPoint:this.points[i]});return this.currentStep===qe&&this.performEventPressedMove!==null&&this.performEventPressedMove({currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}),!0}return!1},s.prototype.setLock=function(t){return this.lock!==t?(this.lock=t,!0):!1},s.prototype.setVisible=function(t){return this.visible!==t?(this.visible=t,!0):!1},s.prototype.setZLevel=function(t){return this.zLevel!==t?(this.zLevel=t,!0):!1},s.prototype.setMode=function(t){return this.mode!==t?(this.mode=t,!0):!1},s.prototype.setModeSensitivity=function(t){return this.modeSensitivity!==t?(this.modeSensitivity=t,!0):!1},s.prototype.setOnDrawStartCallback=function(t){return this.onDrawStart!==t?(this.onDrawStart=t,!0):!1},s.prototype.setOnDrawingCallback=function(t){return this.onDrawing!==t?(this.onDrawing=t,!0):!1},s.prototype.setOnDrawEndCallback=function(t){return this.onDrawEnd!==t?(this.onDrawEnd=t,!0):!1},s.prototype.setOnClickCallback=function(t){return this.onClick!==t?(this.onClick=t,!0):!1},s.prototype.setOnDoubleClickCallback=function(t){return this.onDoubleClick!==t?(this.onDoubleClick=t,!0):!1},s.prototype.setOnRightClickCallback=function(t){return this.onRightClick!==t?(this.onRightClick=t,!0):!1},s.prototype.setOnPressedMoveStartCallback=function(t){return this.onPressedMoveStart!==t?(this.onPressedMoveStart=t,!0):!1},s.prototype.setOnPressedMovingCallback=function(t){return this.onPressedMoving!==t?(this.onPressedMoving=t,!0):!1},s.prototype.setOnPressedMoveEndCallback=function(t){return this.onPressedMoveEnd!==t?(this.onPressedMoveEnd=t,!0):!1},s.prototype.setOnMouseEnterCallback=function(t){return this.onMouseEnter!==t?(this.onMouseEnter=t,!0):!1},s.prototype.setOnMouseLeaveCallback=function(t){return this.onMouseLeave!==t?(this.onMouseLeave=t,!0):!1},s.prototype.setOnRemovedCallback=function(t){return this.onRemoved!==t?(this.onRemoved=t,!0):!1},s.prototype.setOnSelectedCallback=function(t){return this.onSelected!==t?(this.onSelected=t,!0):!1},s.prototype.setOnDeselectedCallback=function(t){return this.onDeselected!==t?(this.onDeselected=t,!0):!1},s.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=qe:this.currentStep++},s.prototype.forceComplete=function(){this.currentStep=qe},s.prototype.isDrawing=function(){return this.currentStep!==qe},s.prototype.isStart=function(){return this.currentStep===bs},s.prototype.eventMoveForDrawing=function(t){var e,i=this.currentStep-1,n={};V(t.timestamp)&&(n.timestamp=t.timestamp),V(t.dataIndex)&&(n.dataIndex=t.dataIndex),V(t.value)&&(n.value=t.value),this.points[i]=n,(e=this.performEventMoveForDrawing)===null||e===void 0||e.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:i,performPoint:n})},s.prototype.eventPressedPointMove=function(t,e){var i;V(t.dataIndex)&&(this.points[e].dataIndex=t.dataIndex,this.points[e].timestamp=t.timestamp),V(t.value)&&(this.points[e].value=t.value),(i=this.performEventPressedMove)===null||i===void 0||i.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:e,performPoint:this.points[e]})},s.prototype.startPressedMove=function(t){this._prevPressedPoint=N({},t),this._prevPressedPoints=hi(this.points)},s.prototype.eventPressedOtherMove=function(t,e){if(this._prevPressedPoint!==null){var i;V(t.dataIndex)&&V(this._prevPressedPoint.dataIndex)&&(i=t.dataIndex-this._prevPressedPoint.dataIndex);var n;V(t.value)&&V(this._prevPressedPoint.value)&&(n=t.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map(function(r){var o;V(r.timestamp)&&(r.dataIndex=e.timestampToDataIndex(r.timestamp));var a=N({},r);return V(i)&&V(r.dataIndex)&&(a.dataIndex=r.dataIndex+i,a.timestamp=(o=e.dataIndexToTimestamp(a.dataIndex))!==null&&o!==void 0?o:void 0),V(n)&&V(r.value)&&(a.value=r.value+n),a})}},s.extend=function(t){var e=function(i){Y(n,i);function n(){return i.call(this,t)||this}return n}(s);return e},s}(),mt;(function(s){s[s.Tooltip=0]="Tooltip",s[s.Crosshair=1]="Crosshair",s[s.XAxis=2]="XAxis"})(mt||(mt={}));function Aa(){return{formatDate:Ma,formatBigNumber:Ea}}var Ra="en-US",un=-1;function Ri(s){return Zt(window.requestAnimationFrame)?window.requestAnimationFrame(s):window.setTimeout(s,20)}function Ss(s){Zt(window.cancelAnimationFrame)?window.cancelAnimationFrame(s):window.clearTimeout(s)}var Rn=function(){function s(t){this._options={duration:500,iterationCount:1},this._currentIterationCount=0,this._running=!1,this._time=0,kt(this._options,t)}return s.prototype._loop=function(){var t=this;this._running=!0;var e=function(){var i;if(t._running){var n=new Date().getTime()-t._time;n<t._options.duration?((i=t._doFrameCallback)===null||i===void 0||i.call(t,n),Ri(e)):(t.stop(),t._currentIterationCount++,t._currentIterationCount<t._options.iterationCount&&t.start())}};Ri(e)},s.prototype.doFrame=function(t){return this._doFrameCallback=t,this},s.prototype.setDuration=function(t){return this._options.duration=t,this},s.prototype.setIterationCount=function(t){return this._options.iterationCount=t,this},s.prototype.start=function(){this._running||(this._time=new Date().getTime(),this._loop())},s.prototype.stop=function(){var t;this._running&&((t=this._doFrameCallback)===null||t===void 0||t.call(this,this._options.duration)),this._running=!1},s}(),cn=1,xs=new Date().getTime();function Nr(s){var t=new Date().getTime();return t===xs?++cn:cn=1,xs=t,"".concat(s??"").concat(t,"_").concat(cn)}function Kt(s,t){var e,i=document.createElement(s),n=t??{};for(var r in n)i.style[r]=(e=n[r])!==null&&e!==void 0?e:"";return i}function Fn(s,t,e){var i=0,n=0;for(n=s.length-1;i!==n;){var r=Math.floor((n+i)/2),o=n-i,a=s[r][t];if(e===s[i][t])return i;if(e===s[n][t])return n;if(e===a)return r;if(e>a?i=r:n=r,o<=2)break}return i}function Fa(s){var t=Math.floor(ii(s)),e=fe(t),i=s/e,n=0;return i<1.5?n=1:i<2.5?n=2:i<3.5?n=3:i<4.5?n=4:i<5.5?n=5:i<6.5?n=6:n=8,s=n*e,t>=-20?+s.toFixed(t<0?-t:0):s}function Cs(s,t){t==null&&(t=10),t=Math.min(Math.max(0,t),20);var e=(+s).toFixed(t);return+e}function Ba(s){var t=s.toString(),e=t.indexOf("e");if(e>0){var i=+t.slice(e+1);return i<0?-i:0}else{var n=t.indexOf(".");return n<0?0:t.length-1-n}}function zr(s,t,e){var i=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];return s.forEach(function(n){var r,o;i[0]=Math.max((r=n[t])!==null&&r!==void 0?r:n,i[0]),i[1]=Math.min((o=n[e])!==null&&o!==void 0?o:n,i[1])}),i}function ii(s){return Math.log(s)/Math.log(10)}function fe(s){return Math.pow(10,s)}function Ms(){return{from:0,to:0,realFrom:0,realTo:0}}var Es={MIN:1,MAX:50},Va=8,La=80,Na=.88,Bn=10,za=function(){function s(t){this._dateTimeFormat=this._buildDateTimeFormat(),this._zoomEnabled=!0,this._scrollEnabled=!0,this._totalBarSpace=0,this._barSpace=Va,this._offsetRightDistance=La,this._startLastBarRightSideDiffBarCount=0,this._scrollLimitRole=0,this._minVisibleBarCount={left:2,right:2},this._maxOffsetDistance={left:50,right:50},this._visibleRange=Ms(),this._chartStore=t,this._gapBarSpace=this._calcGapBarSpace(),this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace}return s.prototype._calcGapBarSpace=function(){var t;return this._barSpace>3?t=Math.floor(this._barSpace*Na):(t=Math.floor(this._barSpace),t===this._barSpace&&t--),t%2===0&&t--,t=Math.max(1,t),t},s.prototype.adjustVisibleRange=function(){var t,e,i=this._chartStore.getDataList(),n=i.length,r=this._totalBarSpace/this._barSpace,o,a;this._scrollLimitRole===1?(o=(this._totalBarSpace-this._maxOffsetDistance.right)/this._barSpace,a=(this._totalBarSpace-this._maxOffsetDistance.left)/this._barSpace):(o=this._minVisibleBarCount.left,a=this._minVisibleBarCount.right),o=Math.max(0,o),a=Math.max(0,a);var l=r-Math.min(o,n);this._lastBarRightSideDiffBarCount>l&&(this._lastBarRightSideDiffBarCount=l);var h=-n+Math.min(a,n);this._lastBarRightSideDiffBarCount<h&&(this._lastBarRightSideDiffBarCount=h);var u=Math.round(this._lastBarRightSideDiffBarCount+n+.5),c=u;u>n&&(u=n);var d=Math.round(u-r)-1;d<0&&(d=0);var f=this._lastBarRightSideDiffBarCount>0?Math.round(n+this._lastBarRightSideDiffBarCount-r)-1:d;if(this._visibleRange={from:d,to:u,realFrom:f,realTo:c},this._chartStore.getActionStore().execute(Tt.OnVisibleRangeChange,this._visibleRange),this._chartStore.adjustVisibleDataList(),d===0){var v=i[0];this._chartStore.executeLoadMoreCallback((t=v==null?void 0:v.timestamp)!==null&&t!==void 0?t:null),this._chartStore.executeLoadDataCallback({type:It.Forward,data:v??null})}u===n&&this._chartStore.executeLoadDataCallback({type:It.Backward,data:(e=i[n-1])!==null&&e!==void 0?e:null})},s.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},s.prototype._buildDateTimeFormat=function(t){var e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};O(t)&&(e.timeZone=t);var i=null;try{i=new Intl.DateTimeFormat("en",e)}catch{}return i},s.prototype.setTimezone=function(t){var e=this._buildDateTimeFormat(t);e!==null&&(this._dateTimeFormat=e)},s.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},s.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:Math.floor(this._gapBarSpace/2)}},s.prototype.setBarSpace=function(t,e){t<Es.MIN||t>Es.MAX||this._barSpace===t||(this._barSpace=t,this._gapBarSpace=this._calcGapBarSpace(),e==null||e(),this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0))},s.prototype.setTotalBarSpace=function(t){return this._totalBarSpace!==t&&(this._totalBarSpace=t,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0)),this},s.prototype.setOffsetRightDistance=function(t,e){return this._offsetRightDistance=this._scrollLimitRole===1?Math.min(this._maxOffsetDistance.right,t):t,this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace,(e??!1)&&(this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)),this},s.prototype.resetOffsetRightDistance=function(){this.setOffsetRightDistance(this._offsetRightDistance)},s.prototype.getInitialOffsetRightDistance=function(){return this._offsetRightDistance},s.prototype.getOffsetRightDistance=function(){return Math.max(0,this._lastBarRightSideDiffBarCount*this._barSpace)},s.prototype.getLastBarRightSideDiffBarCount=function(){return this._lastBarRightSideDiffBarCount},s.prototype.setLastBarRightSideDiffBarCount=function(t){return this._lastBarRightSideDiffBarCount=t,this},s.prototype.setMaxOffsetLeftDistance=function(t){return this._scrollLimitRole=1,this._maxOffsetDistance.left=t,this},s.prototype.setMaxOffsetRightDistance=function(t){return this._scrollLimitRole=1,this._maxOffsetDistance.right=t,this},s.prototype.setLeftMinVisibleBarCount=function(t){return this._scrollLimitRole=0,this._minVisibleBarCount.left=t,this},s.prototype.setRightMinVisibleBarCount=function(t){return this._scrollLimitRole=0,this._minVisibleBarCount.right=t,this},s.prototype.getVisibleRange=function(){return this._visibleRange},s.prototype.startScroll=function(){this._startLastBarRightSideDiffBarCount=this._lastBarRightSideDiffBarCount},s.prototype.scroll=function(t){if(this._scrollEnabled){var e=t/this._barSpace,i=this._lastBarRightSideDiffBarCount*this._barSpace;this._lastBarRightSideDiffBarCount=this._startLastBarRightSideDiffBarCount-e,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0);var n=Math.round(i-this._lastBarRightSideDiffBarCount*this._barSpace);n!==0&&this._chartStore.getActionStore().execute(Tt.OnScroll,{distance:n})}},s.prototype.getDataByDataIndex=function(t){var e;return(e=this._chartStore.getDataList()[t])!==null&&e!==void 0?e:null},s.prototype.coordinateToFloatIndex=function(t){var e=this._chartStore.getDataList().length,i=(this._totalBarSpace-t)/this._barSpace,n=e+this._lastBarRightSideDiffBarCount-i;return Math.round(n*1e6)/1e6},s.prototype.dataIndexToTimestamp=function(t){var e,i=this.getDataByDataIndex(t);return(e=i==null?void 0:i.timestamp)!==null&&e!==void 0?e:null},s.prototype.timestampToDataIndex=function(t){var e=this._chartStore.getDataList();return e.length===0?0:Fn(e,"timestamp",t)},s.prototype.dataIndexToCoordinate=function(t){var e=this._chartStore.getDataList().length,i=e+this._lastBarRightSideDiffBarCount-t;return Math.floor(this._totalBarSpace-(i-.5)*this._barSpace)},s.prototype.coordinateToDataIndex=function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1},s.prototype.zoom=function(t,e){var i=this,n;if(this._zoomEnabled){var r=e??null;if(!V(r==null?void 0:r.x)){var o=this._chartStore.getTooltipStore().getCrosshair();r={x:(n=o==null?void 0:o.x)!==null&&n!==void 0?n:this._totalBarSpace/2}}var a=r.x,l=this.coordinateToFloatIndex(a),h=this._barSpace,u=this._barSpace+t*(this._barSpace/Bn);this.setBarSpace(u,function(){i._lastBarRightSideDiffBarCount+=l-i.coordinateToFloatIndex(a)});var c=this._barSpace/h;c!==1&&this._chartStore.getActionStore().execute(Tt.OnZoom,{scale:c})}},s.prototype.setZoomEnabled=function(t){return this._zoomEnabled=t,this},s.prototype.getZoomEnabled=function(){return this._zoomEnabled},s.prototype.setScrollEnabled=function(t){return this._scrollEnabled=t,this},s.prototype.getScrollEnabled=function(){return this._scrollEnabled},s.prototype.clear=function(){this._visibleRange=Ms()},s}(),Oa={name:"AVP",shortName:"AVP",series:Ct.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(s){var t=0,e=0;return s.map(function(i){var n,r,o={},a=(n=i==null?void 0:i.turnover)!==null&&n!==void 0?n:0,l=(r=i==null?void 0:i.volume)!==null&&r!==void 0?r:0;return t+=a,e+=l,e!==0&&(o.avp=t/e),o})}},Wa={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(s,t,e){var i,n,r,o,a=s.prev,l=s.current,h=(n=(i=a.indicatorData)===null||i===void 0?void 0:i.ao)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER,u=(o=(r=l.indicatorData)===null||r===void 0?void 0:r.ao)!==null&&o!==void 0?o:Number.MIN_SAFE_INTEGER,c;u>h?c=gt(t.styles,"bars[0].upColor",e.bars[0].upColor):c=gt(t.styles,"bars[0].downColor",e.bars[0].downColor);var d=u>h?H.Stroke:H.Fill;return{color:c,style:d,borderColor:c}}}],calc:function(s,t){var e=t.calcParams,i=Math.max(e[0],e[1]),n=0,r=0,o=0,a=0;return s.map(function(l,h){var u={},c=(l.low+l.high)/2;if(n+=c,r+=c,h>=e[0]-1){o=n/e[0];var d=s[h-(e[0]-1)];n-=(d.low+d.high)/2}if(h>=e[1]-1){a=r/e[1];var d=s[h-(e[1]-1)];r-=(d.low+d.high)/2}return h>=i-1&&(u.ao=o-a),u})}},Ya={name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(s){return s.map(function(t,e){return{key:"bias".concat(e+1),title:"BIAS".concat(t,": "),type:"line"}})},calc:function(s,t){var e=t.calcParams,i=t.figures,n=[];return s.map(function(r,o){var a={},l=r.close;return e.forEach(function(h,u){var c;if(n[u]=((c=n[u])!==null&&c!==void 0?c:0)+l,o>=h-1){var d=n[u]/e[u];a[i[u].key]=(l-d)/d*100,n[u]-=s[o-(h-1)].close}}),a})}};function Xa(s,t){var e=s.length,i=0;return s.forEach(function(n){var r=n.close-t;i+=r*r}),i=Math.abs(i),Math.sqrt(i/e)}var $a={name:"BOLL",shortName:"BOLL",series:Ct.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=e[0]-1,n=0;return s.map(function(r,o){var a=r.close,l={};if(n+=a,o>=i){l.mid=n/e[0];var h=Xa(s.slice(o-i,o+1),l.mid);l.up=l.mid+e[1]*h,l.dn=l.mid-e[1]*h,n-=s[o-i].close}return l})}},Ha={name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=0,n=0,r=0,o=0;return s.map(function(a,l){var h,u,c={},d=a.high,f=a.low,v=a.open,p=((h=s[l-1])!==null&&h!==void 0?h:a).close;if(r+=d-v,o+=v-f,i+=d-p,n+=p-f,l>=e[0]-1){o!==0?c.ar=r/o*100:c.ar=0,n!==0?c.br=i/n*100:c.br=0;var g=s[l-(e[0]-1)],m=g.high,_=g.low,w=g.open,y=((u=s[l-e[0]])!==null&&u!==void 0?u:s[l-(e[0]-1)]).close;i-=m-y,n-=y-_,r-=m-w,o-=w-_}return c})}},Qa={name:"BBI",shortName:"BBI",series:Ct.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=Math.max.apply(Math,Vr([],Ee(e),!1)),n=[],r=[];return s.map(function(o,a){var l={},h=o.close;if(e.forEach(function(c,d){var f;n[d]=((f=n[d])!==null&&f!==void 0?f:0)+h,a>=c-1&&(r[d]=n[d]/c,n[d]-=s[a-(c-1)].close)}),a>=i-1){var u=0;r.forEach(function(c){u+=c}),l.bbi=u/4}return l})}},ja={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=e[0]-1,n=0,r=[];return s.map(function(o,a){var l={},h=(o.high+o.low+o.close)/3;if(n+=h,r.push(h),a>=i){var u=n/e[0],c=r.slice(a-i,a+1),d=0;c.forEach(function(p){d+=Math.abs(p-u)});var f=d/e[0];l.cci=f!==0?(h-u)/f/.015:0;var v=(s[a-i].high+s[a-i].low+s[a-i].close)/3;n-=v}return l})}},Ga={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=Math.ceil(e[1]/2.5+1),n=Math.ceil(e[2]/2.5+1),r=Math.ceil(e[3]/2.5+1),o=Math.ceil(e[4]/2.5+1),a=0,l=[],h=0,u=[],c=0,d=[],f=0,v=[],p=[];return s.forEach(function(g,m){var _,w,y,x,M,b={},S=(_=s[m-1])!==null&&_!==void 0?_:g,C=(S.high+S.close+S.low+S.open)/4,E=Math.max(0,g.high-C),I=Math.max(0,C-g.low);m>=e[0]-1&&(I!==0?b.cr=E/I*100:b.cr=0,a+=b.cr,h+=b.cr,c+=b.cr,f+=b.cr,m>=e[0]+e[1]-2&&(l.push(a/e[1]),m>=e[0]+e[1]+i-3&&(b.ma1=l[l.length-1-i]),a-=(w=p[m-(e[1]-1)].cr)!==null&&w!==void 0?w:0),m>=e[0]+e[2]-2&&(u.push(h/e[2]),m>=e[0]+e[2]+n-3&&(b.ma2=u[u.length-1-n]),h-=(y=p[m-(e[2]-1)].cr)!==null&&y!==void 0?y:0),m>=e[0]+e[3]-2&&(d.push(c/e[3]),m>=e[0]+e[3]+r-3&&(b.ma3=d[d.length-1-r]),c-=(x=p[m-(e[3]-1)].cr)!==null&&x!==void 0?x:0),m>=e[0]+e[4]-2&&(v.push(f/e[4]),m>=e[0]+e[4]+o-3&&(b.ma4=v[v.length-1-o]),f-=(M=p[m-(e[4]-1)].cr)!==null&&M!==void 0?M:0)),p.push(b)}),p}},Ua={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=Math.max(e[0],e[1]),n=0,r=0,o=0,a=[];return s.forEach(function(l,h){var u,c={},d=l.close;n+=d,r+=d;var f=0,v=0;if(h>=e[0]-1&&(f=n/e[0],n-=s[h-(e[0]-1)].close),h>=e[1]-1&&(v=r/e[1],r-=s[h-(e[1]-1)].close),h>=i-1){var p=f-v;c.dma=p,o+=p,h>=i+e[2]-2&&(c.ama=o/e[2],o-=(u=a[h-(e[2]-1)].dma)!==null&&u!==void 0?u:0)}a.push(c)}),a}},Ja={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=0,n=0,r=0,o=0,a=0,l=0,h=0,u=0,c=[];return s.forEach(function(d,f){var v,p,g={},m=(v=s[f-1])!==null&&v!==void 0?v:d,_=m.close,w=d.high,y=d.low,x=w-y,M=Math.abs(w-_),b=Math.abs(_-y),S=w-m.high,C=m.low-y,E=Math.max(Math.max(x,M),b),I=S>0&&S>C?S:0,P=C>0&&C>S?C:0;if(i+=E,n+=I,r+=P,f>=e[0]-1){f>e[0]-1?(o=o-o/e[0]+E,a=a-a/e[0]+I,l=l-l/e[0]+P):(o=i,a=n,l=r);var T=0,R=0;o!==0&&(T=a*100/o,R=l*100/o),g.pdi=T,g.mdi=R;var L=0;R+T!==0&&(L=Math.abs(R-T)/(R+T)*100),h+=L,f>=e[0]*2-2&&(f>e[0]*2-2?u=(u*(e[0]-1)+L)/e[0]:u=h/e[0],g.adx=u,f>=e[0]*2+e[1]-3&&(g.adxr=(((p=c[f-(e[1]-1)].adx)!==null&&p!==void 0?p:0)+u)/2))}c.push(g)}),c}},Za={name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=0,n=[];return s.map(function(r,o){var a,l={};if(o>0){var h=s[o-1],u=r.high,c=r.low,d=(a=r.volume)!==null&&a!==void 0?a:0,f=(u+c)/2-(h.high+h.low)/2;if(d===0||u-c===0)l.emv=0;else{var v=d/1e8/(u-c);l.emv=f/v}i+=l.emv,n.push(l.emv),o>=e[0]&&(l.maEmv=i/e[0],i-=n[o-e[0]])}return l})}},Ka={name:"EMA",shortName:"EMA",series:Ct.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(s){return s.map(function(t,e){return{key:"ema".concat(e+1),title:"EMA".concat(t,": "),type:"line"}})},calc:function(s,t){var e=t.calcParams,i=t.figures,n=0,r=[];return s.map(function(o,a){var l={},h=o.close;return n+=h,e.forEach(function(u,c){a>=u-1&&(a>u-1?r[c]=(2*h+(u-1)*r[c])/(u+1):r[c]=n/u,l[i[c].key]=r[c])}),l})}},qa={name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=0,n=[];return s.forEach(function(r,o){var a,l={};if(o>=e[0]){var h=r.close,u=s[o-e[0]].close;l.mtm=h-u,i+=l.mtm,o>=e[0]+e[1]-1&&(l.maMtm=i/e[1],i-=(a=n[o-(e[1]-1)].mtm)!==null&&a!==void 0?a:0)}n.push(l)}),n}},tl={name:"MA",shortName:"MA",series:Ct.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regenerateFigures:function(s){return s.map(function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}})},calc:function(s,t){var e=t.calcParams,i=t.figures,n=[];return s.map(function(r,o){var a={},l=r.close;return e.forEach(function(h,u){var c;n[u]=((c=n[u])!==null&&c!==void 0?c:0)+l,o>=h-1&&(a[i[u].key]=n[u]/h,n[u]-=s[o-(h-1)].close)}),a})}},el={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(s,t,e){var i,n,r,o,a=s.prev,l=s.current,h=(n=(i=a.indicatorData)===null||i===void 0?void 0:i.macd)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER,u=(o=(r=l.indicatorData)===null||r===void 0?void 0:r.macd)!==null&&o!==void 0?o:Number.MIN_SAFE_INTEGER,c;u>0?c=gt(t.styles,"bars[0].upColor",e.bars[0].upColor):u<0?c=gt(t.styles,"bars[0].downColor",e.bars[0].downColor):c=gt(t.styles,"bars[0].noChangeColor",e.bars[0].noChangeColor);var d=h<u?H.Stroke:H.Fill;return{style:d,color:c,borderColor:c}}}],calc:function(s,t){var e=t.calcParams,i=0,n,r,o=0,a=0,l=0,h=Math.max(e[0],e[1]);return s.map(function(u,c){var d={},f=u.close;return i+=f,c>=e[0]-1&&(c>e[0]-1?n=(2*f+(e[0]-1)*n)/(e[0]+1):n=i/e[0]),c>=e[1]-1&&(c>e[1]-1?r=(2*f+(e[1]-1)*r)/(e[1]+1):r=i/e[1]),c>=h-1&&(o=n-r,d.dif=o,a+=o,c>=h+e[2]-2&&(c>h+e[2]-2?l=(o*2+l*(e[2]-1))/(e[2]+1):l=a/e[2],d.macd=(o-l)*2,d.dea=l)),d})}},il={name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=0,n=0,r=[];return s.forEach(function(o,a){var l,h,u,c,d=(l=s[a-1])!==null&&l!==void 0?l:o;o.close<d.close?n-=(h=o.volume)!==null&&h!==void 0?h:0:o.close>d.close&&(n+=(u=o.volume)!==null&&u!==void 0?u:0);var f={obv:n};i+=n,a>=e[0]-1&&(f.maObv=i/e[0],i-=(c=r[a-(e[0]-1)].obv)!==null&&c!==void 0?c:0),r.push(f)}),r}},nl={name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(s){var t=0;return s.map(function(e,i){var n,r,o={},a=e.close,l=(n=e.volume)!==null&&n!==void 0?n:1,h=((r=s[i-1])!==null&&r!==void 0?r:e).close,u=0,c=h*l;return c!==0&&(u=(a-h)/c),t+=u,o.pvt=t,o})}},sl={name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=0,n=0,r=[],o=[];return s.forEach(function(a,l){var h,u,c={},d=((h=s[l-1])!==null&&h!==void 0?h:a).close,f=a.close-d>0?1:0;r.push(f),i+=f,l>=e[0]-1&&(c.psy=i/e[0]*100,n+=c.psy,l>=e[0]+e[1]-2&&(c.maPsy=n/e[1],n-=(u=o[l-(e[1]-1)].psy)!==null&&u!==void 0?u:0),i-=r[l-(e[0]-1)]),o.push(c)}),o}},rl={name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=[],n=0;return s.forEach(function(r,o){var a,l,h={};if(o>=e[0]-1){var u=r.close,c=((a=s[o-e[0]])!==null&&a!==void 0?a:s[o-(e[0]-1)]).close;c!==0?h.roc=(u-c)/c*100:h.roc=0,n+=h.roc,o>=e[0]-1+e[1]-1&&(h.maRoc=n/e[1],n-=(l=i[o-(e[1]-1)].roc)!==null&&l!==void 0?l:0)}i.push(h)}),i}},ol={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(s){return s.map(function(t,e){var i=e+1;return{key:"rsi".concat(i),title:"RSI".concat(i,": "),type:"line"}})},calc:function(s,t){var e=t.calcParams,i=t.figures,n=[],r=[];return s.map(function(o,a){var l,h={},u=((l=s[a-1])!==null&&l!==void 0?l:o).close,c=o.close-u;return e.forEach(function(d,f){var v,p,g;if(c>0?n[f]=((v=n[f])!==null&&v!==void 0?v:0)+c:r[f]=((p=r[f])!==null&&p!==void 0?p:0)+Math.abs(c),a>=d-1){r[f]!==0?h[i[f].key]=100-100/(1+n[f]/r[f]):h[i[f].key]=0;var m=s[a-(d-1)],_=(g=s[a-d])!==null&&g!==void 0?g:m,w=m.close-_.close;w>0?n[f]-=w:r[f]-=Math.abs(w)}}),h})}},al={name:"SMA",shortName:"SMA",series:Ct.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(s,t){var e=t.calcParams,i=0,n=0;return s.map(function(r,o){var a={},l=r.close;return i+=l,o>=e[0]-1&&(o>e[0]-1?n=(l*e[1]+n*(e[0]-e[1]+1))/(e[0]+1):n=i/e[0],a.sma=n),a})}},ll={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=[];return s.forEach(function(n,r){var o,a,l,h,u={},c=n.close;if(r>=e[0]-1){var d=zr(s.slice(r-(e[0]-1),r+1),"high","low"),f=d[0],v=d[1],p=f-v,g=(c-v)/(p===0?1:p)*100;u.k=((e[1]-1)*((a=(o=i[r-1])===null||o===void 0?void 0:o.k)!==null&&a!==void 0?a:50)+g)/e[1],u.d=((e[2]-1)*((h=(l=i[r-1])===null||l===void 0?void 0:l.d)!==null&&h!==void 0?h:50)+u.k)/e[2],u.j=3*u.k-2*u.d}i.push(u)}),i}},hl={name:"SAR",shortName:"SAR",series:Ct.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(s,t,e){var i,n,r=s.current,o=(n=(i=r.indicatorData)===null||i===void 0?void 0:i.sar)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER,a=r.kLineData,l=((a==null?void 0:a.high)+(a==null?void 0:a.low))/2,h=o<l?gt(t.styles,"circles[0].upColor",e.circles[0].upColor):gt(t.styles,"circles[0].downColor",e.circles[0].downColor);return{color:h}}}],calc:function(s,t){var e=t.calcParams,i=e[0]/100,n=e[1]/100,r=e[2]/100,o=i,a=-100,l=!1,h=0;return s.map(function(u,c){var d=h,f=u.high,v=u.low;if(l){(a===-100||a<f)&&(a=f,o=Math.min(o+n,r)),h=d+o*(a-d);var p=Math.min(s[Math.max(1,c)-1].low,v);h>u.low?(h=a,o=i,a=-100,l=!l):h>p&&(h=p)}else{(a===-100||a>v)&&(a=v,o=Math.min(o+n,r)),h=d+o*(a-d);var g=Math.max(s[Math.max(1,c)-1].high,f);h<u.high?(h=a,o=0,a=-100,l=!l):h<g&&(h=g)}return{sar:h}})}},ul={name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=0,n,r,o,a=0,l=0,h=0,u=[];return s.forEach(function(c,d){var f,v={},p=c.close;if(i+=p,d>=e[0]-1&&(d>e[0]-1?n=(2*p+(e[0]-1)*n)/(e[0]+1):n=i/e[0],a+=n,d>=e[0]*2-2&&(d>e[0]*2-2?r=(2*n+(e[0]-1)*r)/(e[0]+1):r=a/e[0],l+=r,d>=e[0]*3-3))){var g=void 0,m=0;d>e[0]*3-3?(g=(2*r+(e[0]-1)*o)/(e[0]+1),m=(g-o)/o*100):g=l/e[0],o=g,v.trix=m,h+=m,d>=e[0]*3+e[1]-4&&(v.maTrix=h/e[1],h-=(f=u[d-(e[1]-1)].trix)!==null&&f!==void 0?f:0)}u.push(v)}),u}};function Ps(){return{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(s,t,e){var i=s.current.kLineData,n=gt(t.styles,"bars[0].noChangeColor",e.bars[0].noChangeColor);return k(i)&&(i.close>i.open?n=gt(t.styles,"bars[0].upColor",e.bars[0].upColor):i.close<i.open&&(n=gt(t.styles,"bars[0].downColor",e.bars[0].downColor))),{color:n}}}}var cl={name:"VOL",shortName:"VOL",series:Ct.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},Ps()],regenerateFigures:function(s){var t=s.map(function(e,i){return{key:"ma".concat(i+1),title:"MA".concat(e,": "),type:"line"}});return t.push(Ps()),t},calc:function(s,t){var e=t.calcParams,i=t.figures,n=[];return s.map(function(r,o){var a,l=(a=r.volume)!==null&&a!==void 0?a:0,h={volume:l};return e.forEach(function(u,c){var d,f;n[c]=((d=n[c])!==null&&d!==void 0?d:0)+l,o>=u-1&&(h[i[c].key]=n[c]/u,n[c]-=(f=s[o-(u-1)].volume)!==null&&f!==void 0?f:0)}),h})}},dl={name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(s,t){var e=t.calcParams,i=0,n=0,r=0,o=0,a=[];return s.forEach(function(l,h){var u,c,d,f,v,p={},g=l.close,m=((u=s[h-1])!==null&&u!==void 0?u:l).close,_=(c=l.volume)!==null&&c!==void 0?c:0;if(g>m?i+=_:g<m?n+=_:r+=_,h>=e[0]-1){var w=r/2;n+w===0?p.vr=0:p.vr=(i+w)/(n+w)*100,o+=p.vr,h>=e[0]+e[1]-2&&(p.maVr=o/e[1],o-=(d=a[h-(e[1]-1)].vr)!==null&&d!==void 0?d:0);var y=s[h-(e[0]-1)],x=(f=s[h-e[0]])!==null&&f!==void 0?f:y,M=y.close,b=(v=y.volume)!==null&&v!==void 0?v:0;M>x.close?i-=b:M<x.close?n-=b:r-=b}a.push(p)}),a}},fl={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(s){return s.map(function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),type:"line"}})},calc:function(s,t){var e=t.calcParams,i=t.figures;return s.map(function(n,r){var o={},a=n.close;return e.forEach(function(l,h){var u=l-1;if(r>=u){var c=zr(s.slice(r-u,r+1),"high","low"),d=c[0],f=c[1],v=d-f;o[i[h].key]=v===0?0:(a-d)/v*100}}),o})}},Or={},vl=[Oa,Wa,Ya,$a,Ha,Qa,ja,Ga,Ua,Ja,Za,Ka,qa,tl,el,il,nl,sl,rl,ol,al,ll,hl,ul,cl,dl,fl];vl.forEach(function(s){Or[s.name]=Ia.extend(s)});function Wr(s){var t;return(t=Or[s])!==null&&t!==void 0?t:null}var pl=function(){function s(t){this._instances=new Map,this._chartStore=t}return s.prototype._overrideInstance=function(t,e){var i=e.shortName,n=e.series,r=e.calcParams,o=e.precision,a=e.figures,l=e.minValue,h=e.maxValue,u=e.shouldOhlc,c=e.shouldFormatBigNumber,d=e.visible,f=e.zLevel,v=e.styles,p=e.extendData,g=e.regenerateFigures,m=e.createTooltipDataSource,_=e.draw,w=e.calc,y=!1;O(i)&&t.setShortName(i)&&(y=!0),k(n)&&t.setSeries(n)&&(y=!0);var x=!1;Ft(r)&&t.setCalcParams(r)&&(y=!0,x=!0),Ft(a)&&t.setFigures(a)&&(y=!0,x=!0),l!==void 0&&t.setMinValue(l)&&(y=!0),h!==void 0&&t.setMinValue(h)&&(y=!0),V(o)&&t.setPrecision(o)&&(y=!0),_e(u)&&t.setShouldOhlc(u)&&(y=!0),_e(c)&&t.setShouldFormatBigNumber(c)&&(y=!0),_e(d)&&t.setVisible(d)&&(y=!0);var M=!1;return V(f)&&t.setZLevel(f)&&(y=!0,M=!0),k(v)&&t.setStyles(v)&&(y=!0),p!==void 0&&t.setExtendData(p)&&(y=!0,x=!0),g!==void 0&&t.setRegenerateFigures(g)&&(y=!0),m!==void 0&&t.setCreateTooltipDataSource(m)&&(y=!0),_!==void 0&&t.setDraw(_)&&(y=!0),Zt(w)&&(t.calc=w,x=!0),[y,x,M]},s.prototype._sort=function(t){var e;O(t)?(e=this._instances.get(t))===null||e===void 0||e.sort(function(i,n){return i.zLevel-n.zLevel}):this._instances.forEach(function(i){i.sort(function(n,r){return n.zLevel-r.zLevel})})},s.prototype.addInstance=function(t,e,i){return Be(this,void 0,void 0,function(){var n,r,o,a,l;return Ve(this,function(h){switch(h.label){case 0:return n=t.name,r=this._instances.get(e),k(r)?(o=r.find(function(u){return u.name===n}),k(o)?[4,Promise.reject(new Error("Duplicate indicators."))]:[3,2]):[3,2];case 1:return[2,h.sent()];case 2:return k(r)||(r=[]),a=Wr(n),l=new a,this.synchronizeSeriesPrecision(l),this._overrideInstance(l,t),i||(r=[]),r.push(l),this._instances.set(e,r),this._sort(e),[4,l.calcIndicator(this._chartStore.getDataList())];case 3:return[2,h.sent()]}})})},s.prototype.getInstances=function(t){var e;return(e=this._instances.get(t))!==null&&e!==void 0?e:[]},s.prototype.removeInstance=function(t,e){var i,n=!1,r=this._instances.get(t);if(k(r)){if(O(e)){var o=r.findIndex(function(a){return a.name===e});o>-1&&(r.splice(o,1),n=!0)}else this._instances.set(t,[]),n=!0;((i=this._instances.get(t))===null||i===void 0?void 0:i.length)===0&&this._instances.delete(t)}return n},s.prototype.hasInstances=function(t){return this._instances.has(t)},s.prototype.calcInstance=function(t,e){return Be(this,void 0,void 0,function(){var i,n,r,o,a=this;return Ve(this,function(l){switch(l.label){case 0:return i=[],O(t)?O(e)?(n=this._instances.get(e),k(n)&&(r=n.find(function(h){return h.name===t}),k(r)&&i.push(r.calcIndicator(this._chartStore.getDataList())))):this._instances.forEach(function(h){var u=h.find(function(c){return c.name===t});k(u)&&i.push(u.calcIndicator(a._chartStore.getDataList()))}):this._instances.forEach(function(h){h.forEach(function(u){i.push(u.calcIndicator(a._chartStore.getDataList()))})}),[4,Promise.all(i)];case 1:return o=l.sent(),[2,o.includes(!0)]}})})},s.prototype.getInstanceByPaneId=function(t,e){var i,n,r=function(l){var h=new Map;return l.forEach(function(u){h.set(u.name,u)}),h};if(O(t)){var o=(i=this._instances.get(t))!==null&&i!==void 0?i:[];return O(e)?(n=o==null?void 0:o.find(function(l){return l.name===e}))!==null&&n!==void 0?n:null:r(o)}var a=new Map;return this._instances.forEach(function(l,h){a.set(h,r(l))}),a},s.prototype.synchronizeSeriesPrecision=function(t){var e=this._chartStore.getPrecision(),i=e.price,n=e.volume,r=function(o){switch(o.series){case Ct.Price:{o.setPrecision(i,!0);break}case Ct.Volume:{o.setPrecision(n,!0);break}}};k(t)?r(t):this._instances.forEach(function(o){o.forEach(function(a){r(a)})})},s.prototype.override=function(t,e){return Be(this,void 0,void 0,function(){var i,n,r,o,a,l,h,u=this;return Ve(this,function(c){switch(c.label){case 0:return i=t.name,n=new Map,e!==null?(r=this._instances.get(e),k(r)&&n.set(e,r)):n=this._instances,o=!1,a=[],l=!1,n.forEach(function(d){var f=d.find(function(p){return p.name===i});if(k(f)){var v=u._overrideInstance(f,t);v[2]&&(l=!0),v[1]?a.push(f.calcIndicator(u._chartStore.getDataList())):v[0]&&(o=!0)}}),l&&this._sort(),[4,Promise.all(a)];case 1:return h=c.sent(),[2,[o,h.includes(!0)]]}})})},s}(),gl=function(){function s(t){this._crosshair={},this._activeIcon=null,this._chartStore=t}return s.prototype.setCrosshair=function(t,e){var i=e??{},n=i.notInvalidate,r=i.notExecuteAction,o=this._chartStore.getDataList(),a=t??{},l,h;V(a.x)?(l=this._chartStore.getTimeScaleStore().coordinateToDataIndex(a.x),l<0?h=0:l>o.length-1?h=o.length-1:h=l):(l=o.length-1,h=l);var u=o[h],c=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(l),d={x:this._crosshair.x,y:this._crosshair.y,paneId:this._crosshair.paneId};this._crosshair=N(N({},a),{realX:c,kLineData:u,realDataIndex:l,dataIndex:h}),(d.x!==a.x||d.y!==a.y||d.paneId!==a.paneId)&&(u!==null&&!(r??!1)&&this._chartStore.getChart().crosshairChange(this._crosshair),(n??!1)||this._chartStore.getChart().updatePane(1))},s.prototype.recalculateCrosshair=function(t){this.setCrosshair(this._crosshair,{notInvalidate:t})},s.prototype.getCrosshair=function(){return this._crosshair},s.prototype.setActiveIcon=function(t){this._activeIcon=t??null},s.prototype.getActiveIcon=function(){return this._activeIcon},s.prototype.clear=function(){this.setCrosshair({},{notInvalidate:!0}),this.setActiveIcon()},s}(),ml={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t,e=s.coordinates,i=s.bounding,n=s.overlay,r=s.precision,o=s.thousandsSeparator,a=s.decimalFoldThreshold,l=s.yAxis,h=n.points;if(e.length>0){var u=!((t=l==null?void 0:l.isInCandle())!==null&&t!==void 0)||t?r.price:r.excludePriceVolumeMax,c=[],d=[],f=0,v=i.width;if(e.length>1&&V(h[0].value)&&V(h[1].value)){var p=[1,.786,.618,.5,.382,.236,0],g=e[0].y-e[1].y,m=h[0].value-h[1].value;p.forEach(function(_){var w,y=e[1].y+g*_,x=ft(ct((((w=h[1].value)!==null&&w!==void 0?w:0)+m*_).toFixed(u),o),a);c.push({coordinates:[{x:f,y},{x:v,y}]}),d.push({x:f,y,text:"".concat(x," (").concat((_*100).toFixed(1),"%)"),baseline:"bottom"})})}return[{type:"line",attrs:c},{type:"text",isCheckEvent:!1,attrs:d}]}return[]}},_l={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t=s.coordinates,e=s.bounding,i={x:0,y:t[0].y};return k(t[1])&&t[0].x<t[1].x&&(i.x=e.width),[{type:"line",attrs:{coordinates:[t[0],i]}}]},performEventPressedMove:function(s){var t=s.points,e=s.performPoint;t[0].value=e.value,t[1].value=e.value},performEventMoveForDrawing:function(s){var t=s.currentStep,e=s.points,i=s.performPoint;t===2&&(e[0].value=i.value)}},yl={name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t=s.coordinates,e=[];return t.length===2&&e.push({coordinates:t}),[{type:"line",attrs:e}]},performEventPressedMove:function(s){var t=s.points,e=s.performPoint;t[0].value=e.value,t[1].value=e.value},performEventMoveForDrawing:function(s){var t=s.currentStep,e=s.points,i=s.performPoint;t===2&&(e[0].value=i.value)}},wl={name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t=s.coordinates,e=s.bounding;return[{type:"line",attrs:{coordinates:[{x:0,y:t[0].y},{x:e.width,y:t[0].y}]}}]}},Jn=function(){function s(){this._children=[],this._callbacks=new Map}return s.prototype.registerEvent=function(t,e){return this._callbacks.set(t,e),this},s.prototype.onEvent=function(t,e,i){var n=this._callbacks.get(t);return k(n)&&this.checkEventOn(e)?n(e,i):!1},s.prototype.checkEventOn=function(t){var e,i;try{for(var n=be(this._children),r=n.next();!r.done;r=n.next()){var o=r.value;if(o.checkEventOn(t))return!0}}catch(a){e={error:a}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}return!1},s.prototype.dispatchEvent=function(t,e,i){var n=this._children.length-1;if(n>-1){for(var r=n;r>-1;r--)if(this._children[r].dispatchEvent(t,e,i))return!0}return this.onEvent(t,e,i)},s.prototype.addChild=function(t){return this._children.push(t),this},s.prototype.clear=function(){this._children=[]},s}(),dt=2,bl=function(s){Y(t,s);function t(e){var i=s.call(this)||this;return i.attrs=e.attrs,i.styles=e.styles,i}return t.prototype.checkEventOn=function(e){return this.checkEventOnImp(e,this.attrs,this.styles)},t.prototype.setAttrs=function(e){return this.attrs=e,this},t.prototype.setStyles=function(e){return this.styles=e,this},t.prototype.draw=function(e){this.drawImp(e,this.attrs,this.styles)},t.extend=function(e){var i=function(n){Y(r,n);function r(){return n!==null&&n.apply(this,arguments)||this}return r.prototype.checkEventOnImp=function(o,a,l){return e.checkEventOn(o,a,l)},r.prototype.drawImp=function(o,a,l){e.draw(o,a,l)},r}(t);return i},t}(Jn);function Sl(s,t){var e=[];e=e.concat(t);for(var i=0;i<e.length;i++){var n=e[i].coordinates;if(n.length>1)for(var r=1;r<n.length;r++){var o=n[r-1],a=n[r];if(o.x===a.x){if(Math.abs(o.y-s.y)+Math.abs(a.y-s.y)-Math.abs(o.y-a.y)<dt+dt&&Math.abs(s.x-o.x)<dt)return!0}else{var l=Zn(o,a),h=Yr(l,s),u=Math.abs(h-s.y);if(Math.abs(o.x-s.x)+Math.abs(a.x-s.x)-Math.abs(o.x-a.x)<dt+dt&&u*u/(l[0]*l[0]+1)<dt*dt)return!0}}}return!1}function Yr(s,t){return s!==null?t.x*s[0]+s[1]:t.y}function Fi(s,t,e){var i=Zn(s,t);return Yr(i,e)}function Zn(s,t){var e=s.x-t.x;if(e!==0){var i=(s.y-t.y)/e,n=s.y-i*s.x;return[i,n]}return null}function Xr(s,t,e){var i=t.length,n=V(e)?e>0&&e<1?e:0:e?.5:0;if(n>0&&i>2){for(var r=t[0].x,o=t[0].y,a=1;a<i-1;a++){var l=t[a-1],h=t[a],u=t[a+1],c=h.x-l.x,d=h.y-l.y,f=u.x-h.x,v=u.y-h.y,p=u.x-l.x,g=u.y-l.y,m=Math.sqrt(c*c+d*d),_=Math.sqrt(f*f+v*v),w=_/(_+m),y=h.x+p*n*w,x=h.y+g*n*w;y=Math.min(y,Math.max(u.x,h.x)),x=Math.min(x,Math.max(u.y,h.y)),y=Math.max(y,Math.min(u.x,h.x)),x=Math.max(x,Math.min(u.y,h.y)),p=y-h.x,g=x-h.y;var M=h.x-p*m/_,b=h.y-g*m/_;M=Math.min(M,Math.max(l.x,h.x)),b=Math.min(b,Math.max(l.y,h.y)),M=Math.max(M,Math.min(l.x,h.x)),b=Math.max(b,Math.min(l.y,h.y)),p=h.x-M,g=h.y-b,y=h.x+p*_/m,x=h.y+g*_/m,s.bezierCurveTo(r,o,M,b,h.x,h.y),r=y,o=x}var S=t[i-1];s.bezierCurveTo(r,o,S.x,S.y,S.x,S.y)}else for(var a=1;a<i;a++)s.lineTo(t[a].x,t[a].y)}function xl(s,t,e){var i=[];i=i.concat(t);var n=e.style,r=n===void 0?G.Solid:n,o=e.smooth,a=o===void 0?!1:o,l=e.size,h=l===void 0?1:l,u=e.color,c=u===void 0?"currentColor":u,d=e.dashedValue,f=d===void 0?[2,2]:d;s.lineWidth=h,s.strokeStyle=c,r===G.Dashed?s.setLineDash(f):s.setLineDash([]);var v=h%2===1?.5:0;i.forEach(function(p){var g=p.coordinates;g.length>1&&(g.length===2&&(g[0].x===g[1].x||g[0].y===g[1].y)?(s.beginPath(),g[0].x===g[1].x?(s.moveTo(g[0].x+v,g[0].y),s.lineTo(g[1].x+v,g[1].y)):(s.moveTo(g[0].x,g[0].y+v),s.lineTo(g[1].x,g[1].y+v)),s.stroke(),s.closePath()):(s.save(),h%2===1&&s.translate(.5,.5),s.beginPath(),s.moveTo(g[0].x,g[0].y),Xr(s,g,a),s.stroke(),s.closePath(),s.restore()))})}var Cl={name:"line",checkEventOn:Sl,draw:function(s,t,e){xl(s,t,e)}};function $r(s,t,e){var i=e??0,n=[];if(s.length>1)if(s[0].x===s[1].x){var r=0,o=t.height;if(n.push({coordinates:[{x:s[0].x,y:r},{x:s[0].x,y:o}]}),s.length>2){n.push({coordinates:[{x:s[2].x,y:r},{x:s[2].x,y:o}]});for(var a=s[0].x-s[2].x,l=0;l<i;l++){var h=a*(l+1);n.push({coordinates:[{x:s[0].x+h,y:r},{x:s[0].x+h,y:o}]})}}}else{var u=0,c=t.width,d=Zn(s[0],s[1]),f=d[0],v=d[1];if(n.push({coordinates:[{x:u,y:u*f+v},{x:c,y:c*f+v}]}),s.length>2){var p=s[2].y-f*s[2].x;n.push({coordinates:[{x:u,y:u*f+p},{x:c,y:c*f+p}]});for(var a=v-p,l=0;l<i;l++){var g=v+a*(l+1);n.push({coordinates:[{x:u,y:u*f+g},{x:c,y:c*f+g}]})}}}return n}var Ml={name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t=s.coordinates,e=s.bounding;return[{type:"line",attrs:$r(t,e)}]}},El={name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t=s.coordinates,e=s.bounding;return[{type:"line",attrs:$r(t,e,1)}]}},Pl={name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t,e=s.coordinates,i=s.bounding,n=s.precision,r=s.overlay,o=s.thousandsSeparator,a=s.decimalFoldThreshold,l=s.yAxis,h=r.points[0].value,u=h===void 0?0:h,c=!((t=l==null?void 0:l.isInCandle())!==null&&t!==void 0)||t?n.price:n.excludePriceVolumeMax;return[{type:"line",attrs:{coordinates:[e[0],{x:i.width,y:e[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:e[0].x,y:e[0].y,text:ft(ct(u.toFixed(c),o),a),baseline:"bottom"}}]}};function Il(s,t){if(s.length>1){var e=void 0;return s[0].x===s[1].x&&s[0].y!==s[1].y?s[0].y<s[1].y?e={x:s[0].x,y:t.height}:e={x:s[0].x,y:0}:s[0].x>s[1].x?e={x:0,y:Fi(s[0],s[1],{x:0,y:s[0].y})}:e={x:t.width,y:Fi(s[0],s[1],{x:t.width,y:s[0].y})},{coordinates:[s[0],e]}}return[]}var Tl={name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t=s.coordinates,e=s.bounding;return[{type:"line",attrs:Il(t,e)}]}},kl={name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t=s.coordinates;return t.length===2?[{type:"line",attrs:{coordinates:t}}]:[]}},Dl={name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t=s.coordinates,e=s.bounding;return t.length===2?t[0].x===t[1].x?[{type:"line",attrs:{coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:e.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:Fi(t[0],t[1],{x:0,y:t[0].y})},{x:e.width,y:Fi(t[0],t[1],{x:e.width,y:t[0].y})}]}}]:[]}},Al={name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t=s.coordinates,e=s.bounding;if(t.length===2){var i={x:t[0].x,y:0};return t[0].y<t[1].y&&(i.y=e.height),[{type:"line",attrs:{coordinates:[t[0],i]}}]}return[]},performEventPressedMove:function(s){var t=s.points,e=s.performPoint;t[0].timestamp=e.timestamp,t[0].dataIndex=e.dataIndex,t[1].timestamp=e.timestamp,t[1].dataIndex=e.dataIndex},performEventMoveForDrawing:function(s){var t=s.currentStep,e=s.points,i=s.performPoint;t===2&&(e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex)}},Rl={name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t=s.coordinates;return t.length===2?[{type:"line",attrs:{coordinates:t}}]:[]},performEventPressedMove:function(s){var t=s.points,e=s.performPoint;t[0].timestamp=e.timestamp,t[0].dataIndex=e.dataIndex,t[1].timestamp=e.timestamp,t[1].dataIndex=e.dataIndex},performEventMoveForDrawing:function(s){var t=s.currentStep,e=s.points,i=s.performPoint;t===2&&(e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex)}},Fl={name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(s){var t=s.coordinates,e=s.bounding;return[{type:"line",attrs:{coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:e.height}]}}]}},Bl={name:"simpleAnnotation",totalStep:2,styles:{line:{style:G.Dashed}},createPointFigures:function(s){var t,e=s.overlay,i=s.coordinates,n;k(e.extendData)&&(Zt(e.extendData)?n=e.extendData(e):n=(t=e.extendData)!==null&&t!==void 0?t:"");var r=i[0].x,o=i[0].y-6,a=o-50,l=a-5;return[{type:"line",attrs:{coordinates:[{x:r,y:o},{x:r,y:a}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:r,y:a},{x:r-4,y:l},{x:r+4,y:l}]},ignoreEvent:!0},{type:"text",attrs:{x:r,y:l,text:n??"",align:"center",baseline:"bottom"},ignoreEvent:!0}]}},Vl={name:"simpleTag",totalStep:2,styles:{line:{style:G.Dashed}},createPointFigures:function(s){var t=s.bounding,e=s.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:t.width,y:e[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(s){var t,e,i=s.overlay,n=s.coordinates,r=s.bounding,o=s.yAxis,a=s.precision,l=(t=o==null?void 0:o.isFromZero())!==null&&t!==void 0?t:!1,h,u;l?(h="left",u=0):(h="right",u=r.width);var c;return k(i.extendData)&&(Zt(i.extendData)?c=i.extendData(i):c=(e=i.extendData)!==null&&e!==void 0?e:""),!k(c)&&V(i.points[0].value)&&(c=ut(i.points[0].value,a.price)),{type:"text",attrs:{x:u,y:n[0].y,text:c??"",align:h,baseline:"middle"}}}},Hr={},Ll=[ml,_l,yl,wl,Ml,El,Pl,Tl,kl,Dl,Al,Rl,Fl,Bl,Vl];Ll.forEach(function(s){Hr[s.name]=Da.extend(s)});function Nl(s){var t;return(t=Hr[s])!==null&&t!==void 0?t:null}var zl=30,Ol=100,j={CANDLE:"candle_pane",INDICATOR:"indicator_pane_",X_AXIS:"x_axis_pane"},Wl=function(){function s(t){this._instances=new Map,this._progressInstanceInfo=null,this._pressedInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._hoverInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._clickInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._chartStore=t}return s.prototype._overrideInstance=function(t,e){var i=e.id,n=e.groupId,r=e.points,o=e.styles,a=e.lock,l=e.visible,h=e.zLevel,u=e.mode,c=e.modeSensitivity,d=e.extendData,f=e.onDrawStart,v=e.onDrawing,p=e.onDrawEnd,g=e.onClick,m=e.onDoubleClick,_=e.onRightClick,w=e.onPressedMoveStart,y=e.onPressedMoving,x=e.onPressedMoveEnd,M=e.onMouseEnter,b=e.onMouseLeave,S=e.onRemoved,C=e.onSelected,E=e.onDeselected,I=!1,P=!1;return O(i)&&t.setId(i),O(n)&&t.setGroupId(n),Ft(r)&&t.setPoints(r)&&(I=!0),k(o)&&t.setStyles(o)&&(I=!0),_e(a)&&t.setLock(a),_e(l)&&t.setVisible(l)&&(I=!0),V(h)&&t.setZLevel(h)&&(I=!0,P=!0),k(u)&&t.setMode(u),V(c)&&t.setModeSensitivity(c),d!==void 0&&t.setExtendData(d)&&(I=!0),f!==void 0&&t.setOnDrawStartCallback(f),v!==void 0&&t.setOnDrawingCallback(v),p!==void 0&&t.setOnDrawEndCallback(p),g!==void 0&&t.setOnClickCallback(g),m!==void 0&&t.setOnDoubleClickCallback(m),_!==void 0&&t.setOnRightClickCallback(_),w!==void 0&&t.setOnPressedMoveStartCallback(w),y!==void 0&&t.setOnPressedMovingCallback(y),x!==void 0&&t.setOnPressedMoveEndCallback(x),M!==void 0&&t.setOnMouseEnterCallback(M),b!==void 0&&t.setOnMouseLeaveCallback(b),S!==void 0&&t.setOnRemovedCallback(S),C!==void 0&&t.setOnSelectedCallback(C),E!==void 0&&t.setOnDeselectedCallback(E),[I,P]},s.prototype.getInstanceById=function(t){var e,i;try{for(var n=be(this._instances),r=n.next();!r.done;r=n.next()){var o=r.value,a=o[1],l=a.find(function(h){return h.id===t});if(k(l))return l}}catch(h){e={error:h}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}return this._progressInstanceInfo!==null&&this._progressInstanceInfo.instance.id===t?this._progressInstanceInfo.instance:null},s.prototype._sort=function(t){var e;O(t)?(e=this._instances.get(t))===null||e===void 0||e.sort(function(i,n){return i.zLevel-n.zLevel}):this._instances.forEach(function(i){i.sort(function(n,r){return n.zLevel-r.zLevel})})},s.prototype.addInstances=function(t,e,i){var n=this,r=t.map(function(a){var l,h,u,c,d=(l=a.id)!==null&&l!==void 0?l:Nr(ka);if(n.getInstanceById(d)===null){var f=Nl(a.name);if(f!==null){var v=new f;v.setPaneId(e);var p=(h=a.groupId)!==null&&h!==void 0?h:d;return a.id=d,a.groupId=p,n._overrideInstance(v,a),v.isDrawing()?n._progressInstanceInfo={paneId:e,instance:v,appointPaneFlag:i}:(n._instances.has(e)||n._instances.set(e,[]),(u=n._instances.get(e))===null||u===void 0||u.push(v)),v.isStart()&&((c=v.onDrawStart)===null||c===void 0||c.call(v,{overlay:v})),d}}return null});if(r.some(function(a){return a!==null})){this._sort();var o=this._chartStore.getChart();o.updatePane(1,e),o.updatePane(1,j.X_AXIS)}return r},s.prototype.getProgressInstanceInfo=function(){return this._progressInstanceInfo},s.prototype.progressInstanceComplete=function(){var t;if(this._progressInstanceInfo!==null){var e=this._progressInstanceInfo,i=e.instance,n=e.paneId;i.isDrawing()||(this._instances.has(n)||this._instances.set(n,[]),(t=this._instances.get(n))===null||t===void 0||t.push(i),this._sort(n),this._progressInstanceInfo=null)}},s.prototype.updateProgressInstanceInfo=function(t,e){this._progressInstanceInfo!==null&&(_e(e)&&e&&(this._progressInstanceInfo.appointPaneFlag=e),this._progressInstanceInfo.paneId=t,this._progressInstanceInfo.instance.setPaneId(t))},s.prototype.getInstances=function(t){var e;if(!O(t)){var i=[];return this._instances.forEach(function(n){i=i.concat(n)}),i}return(e=this._instances.get(t))!==null&&e!==void 0?e:[]},s.prototype.override=function(t){var e=this,i=t.id,n=t.groupId,r=t.name,o=!1,a=!1,l=function(f){var v=e._overrideInstance(f,t);v[0]&&(o=!0),v[1]&&(a=!0)};if(O(i)){var h=this.getInstanceById(i);h!==null&&l(h)}else{var u=O(r),c=O(n);if(this._instances.forEach(function(f){f.forEach(function(v){(u&&v.name===r||c&&v.groupId===n||!u&&!c)&&l(v)})}),this._progressInstanceInfo!==null){var d=this._progressInstanceInfo.instance;(u&&d.name===r||c&&d.groupId===n||!u&&!c)&&l(d)}}a&&this._sort(),o&&this._chartStore.getChart().updatePane(1)},s.prototype.removeInstance=function(t){var e,i,n,r=function(p,g){if(O(p.id)){if(g.id!==p.id)return!1}else if(O(p.groupId)){if(g.groupId!==p.groupId)return!1}else if(O(p.name)&&g.name!==p.name)return!1;return!0},o=[],a=k(t);if(this._progressInstanceInfo!==null){var l=this._progressInstanceInfo.instance;(!a||a&&r(t,l))&&(o.push(this._progressInstanceInfo.paneId),(n=l.onRemoved)===null||n===void 0||n.call(l,{overlay:l}),this._progressInstanceInfo=null)}if(a){var h=new Map,u=function(p){var g=p[1],m=g.filter(function(_){var w;return r(t,_)?(o.includes(p[0])||o.push(p[0]),(w=_.onRemoved)===null||w===void 0||w.call(_,{overlay:_}),!1):!0});m.length>0&&h.set(p[0],m)};try{for(var c=be(this._instances),d=c.next();!d.done;d=c.next()){var f=d.value;u(f)}}catch(p){e={error:p}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}this._instances=h}else this._instances.forEach(function(p,g){o.push(g),p.forEach(function(m){var _;(_=m.onRemoved)===null||_===void 0||_.call(m,{overlay:m})})}),this._instances.clear();if(o.length>0){var v=this._chartStore.getChart();o.forEach(function(p){v.updatePane(1,p)}),v.updatePane(1,j.X_AXIS)}},s.prototype.setPressedInstanceInfo=function(t){this._pressedInstanceInfo=t},s.prototype.getPressedInstanceInfo=function(){return this._pressedInstanceInfo},s.prototype.updatePointPosition=function(t,e){if(t>0){var i=this._chartStore.getDataList();this._instances.forEach(function(n){n.forEach(function(r){var o=r.points;o.forEach(function(a){if(!k(a.timestamp)&&k(a.dataIndex)){e===It.Forward&&(a.dataIndex=a.dataIndex+t);var l=i[a.dataIndex];a.timestamp=l==null?void 0:l.timestamp}})})})}},s.prototype.setHoverInstanceInfo=function(t,e){var i,n,r=this._hoverInstanceInfo,o=r.instance,a=r.figureType,l=r.figureKey,h=r.figureIndex;if(((o==null?void 0:o.id)!==((i=t.instance)===null||i===void 0?void 0:i.id)||a!==t.figureType||h!==t.figureIndex)&&(this._hoverInstanceInfo=t,(o==null?void 0:o.id)!==((n=t.instance)===null||n===void 0?void 0:n.id))){var u=!1,c=!1;o!==null&&(c=!0,Zt(o.onMouseLeave)&&(o.onMouseLeave(N({overlay:o,figureKey:l,figureIndex:h},e)),u=!0)),t.instance!==null&&(c=!0,Zt(t.instance.onMouseEnter)&&(t.instance.onMouseEnter(N({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),u=!0)),c&&this._sort(),u||this._chartStore.getChart().updatePane(1)}},s.prototype.getHoverInstanceInfo=function(){return this._hoverInstanceInfo},s.prototype.setClickInstanceInfo=function(t,e){var i,n,r,o,a,l,h,u,c,d=this._clickInstanceInfo,f=d.paneId,v=d.instance,p=d.figureType,g=d.figureKey,m=d.figureIndex;if((n=(i=t.instance)===null||i===void 0?void 0:i.isDrawing())!==null&&n!==void 0&&n||(o=(r=t.instance)===null||r===void 0?void 0:r.onClick)===null||o===void 0||o.call(r,N({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),((v==null?void 0:v.id)!==((a=t.instance)===null||a===void 0?void 0:a.id)||p!==t.figureType||m!==t.figureIndex)&&(this._clickInstanceInfo=t,(v==null?void 0:v.id)!==((l=t.instance)===null||l===void 0?void 0:l.id))){(h=v==null?void 0:v.onDeselected)===null||h===void 0||h.call(v,N({overlay:v,figureKey:g,figureIndex:m},e)),(c=(u=t.instance)===null||u===void 0?void 0:u.onSelected)===null||c===void 0||c.call(u,N({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e));var _=this._chartStore.getChart();_.updatePane(1,t.paneId),f!==t.paneId&&_.updatePane(1,f),_.updatePane(1,j.X_AXIS)}},s.prototype.getClickInstanceInfo=function(){return this._clickInstanceInfo},s.prototype.isEmpty=function(){return this._instances.size===0&&this._progressInstanceInfo===null},s.prototype.isDrawing=function(){var t,e;return this._progressInstanceInfo!==null&&((e=(t=this._progressInstanceInfo)===null||t===void 0?void 0:t.instance.isDrawing())!==null&&e!==void 0?e:!1)},s}(),Yl=function(){function s(){this._actions=new Map}return s.prototype.execute=function(t,e){var i;(i=this._actions.get(t))===null||i===void 0||i.execute(e)},s.prototype.subscribe=function(t,e){var i;this._actions.has(t)||this._actions.set(t,new Pa),(i=this._actions.get(t))===null||i===void 0||i.subscribe(e)},s.prototype.unsubscribe=function(t,e){var i=this._actions.get(t);k(i)&&(i.unsubscribe(e),i.isEmpty()&&this._actions.delete(t))},s.prototype.has=function(t){var e=this._actions.get(t);return k(e)&&!e.isEmpty()},s}(),Xl={grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},$l={grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}},Hl={light:Xl,dark:$l};function Qr(s){var t;return(t=Hl[s])!==null&&t!==void 0?t:null}var Ql=function(){function s(t,e){this._styles=Sa(),this._customApi=Aa(),this._locale=Ra,this._precision={price:2,volume:0},this._thousandsSeparator=",",this._decimalFoldThreshold=3,this._dataList=[],this._loadMoreCallback=null,this._loadDataCallback=null,this._loading=!0,this._forwardMore=!0,this._backwardMore=!0,this._timeScaleStore=new za(this),this._indicatorStore=new pl(this),this._overlayStore=new Wl(this),this._tooltipStore=new gl(this),this._actionStore=new Yl,this._visibleDataList=[],this._chart=t,this.setOptions(e)}return s.prototype.adjustVisibleDataList=function(){this._visibleDataList=[];for(var t=this._timeScaleStore.getVisibleRange(),e=t.realFrom,i=t.realTo,n=e;n<i;n++){var r=this._dataList[n],o=this._timeScaleStore.dataIndexToCoordinate(n);this._visibleDataList.push({dataIndex:n,x:o,data:r})}},s.prototype.setOptions=function(t){var e,i,n,r;if(k(t)){var o=t.locale,a=t.timezone,l=t.styles,h=t.customApi,u=t.thousandsSeparator,c=t.decimalFoldThreshold;if(O(o)&&(this._locale=o),O(a)&&this._timeScaleStore.setTimezone(a),k(l)){var d=null;O(l)?d=Qr(l):d=l,kt(this._styles,d),Ft((i=(e=d==null?void 0:d.candle)===null||e===void 0?void 0:e.tooltip)===null||i===void 0?void 0:i.custom)&&(this._styles.candle.tooltip.custom=(r=(n=d==null?void 0:d.candle)===null||n===void 0?void 0:n.tooltip)===null||r===void 0?void 0:r.custom)}k(h)&&kt(this._customApi,h),O(u)&&(this._thousandsSeparator=u),V(c)&&c>0&&(this._decimalFoldThreshold=c)}return this},s.prototype.getStyles=function(){return this._styles},s.prototype.getLocale=function(){return this._locale},s.prototype.getCustomApi=function(){return this._customApi},s.prototype.getThousandsSeparator=function(){return this._thousandsSeparator},s.prototype.getDecimalFoldThreshold=function(){return this._decimalFoldThreshold},s.prototype.getPrecision=function(){return this._precision},s.prototype.setPrecision=function(t){return this._precision=t,this._indicatorStore.synchronizeSeriesPrecision(),this},s.prototype.getDataList=function(){return this._dataList},s.prototype.getVisibleFirstData=function(){var t,e=this._timeScaleStore.getVisibleRange().from;return(t=this._dataList[e])!==null&&t!==void 0?t:null},s.prototype.getVisibleDataList=function(){return this._visibleDataList},s.prototype.addData=function(t,e,i){return Be(this,void 0,void 0,function(){var n,r,o,a,l,h,u;return Ve(this,function(c){switch(c.label){case 0:if(n=!1,r=!1,o=0,Ft(t)){switch(o=t.length,e){case It.Init:{this.clear(),this._dataList=t,this._forwardMore=i??!0,this._timeScaleStore.resetOffsetRightDistance(),r=!0;break}case It.Backward:{this._dataList=this._dataList.concat(t),this._backwardMore=i??!1,r=o>0;break}case It.Forward:this._dataList=t.concat(this._dataList),this._forwardMore=i??!1,r=o>0}this._loading=!1,n=!0}else a=this._dataList.length,l=t.timestamp,h=gt(this._dataList[a-1],"timestamp",0),l>h?(this._dataList.push(t),u=this._timeScaleStore.getLastBarRightSideDiffBarCount(),u<0&&this._timeScaleStore.setLastBarRightSideDiffBarCount(--u),o=1,n=!0,r=!0):l===h&&(this._dataList[a-1]=t,n=!0,r=!0);if(!n)return[3,5];c.label=1;case 1:return c.trys.push([1,4,,5]),this._overlayStore.updatePointPosition(o,e),r?(this._timeScaleStore.adjustVisibleRange(),this._tooltipStore.recalculateCrosshair(!0),[4,this._indicatorStore.calcInstance()]):[3,3];case 2:c.sent(),this._chart.adjustPaneViewport(!1,!0,!0,!0),c.label=3;case 3:return this._actionStore.execute(Tt.OnDataReady),[3,5];case 4:return c.sent(),[3,5];case 5:return[2]}})})},s.prototype.setLoadMoreCallback=function(t){this._loadMoreCallback=t},s.prototype.executeLoadMoreCallback=function(t){this._forwardMore&&!this._loading&&k(this._loadMoreCallback)&&(this._loading=!0,this._loadMoreCallback(t))},s.prototype.setLoadDataCallback=function(t){this._loadDataCallback=t},s.prototype.executeLoadDataCallback=function(t){var e=this;if(!this._loading&&k(this._loadDataCallback)&&(this._forwardMore&&t.type===It.Forward||this._backwardMore&&t.type===It.Backward)){var i=function(n,r){e.addData(n,t.type,r).then(function(){}).catch(function(){})};this._loading=!0,this._loadDataCallback(N(N({},t),{callback:i}))}},s.prototype.clear=function(){this._forwardMore=!0,this._backwardMore=!0,this._loading=!0,this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear(),this._tooltipStore.clear()},s.prototype.getTimeScaleStore=function(){return this._timeScaleStore},s.prototype.getIndicatorStore=function(){return this._indicatorStore},s.prototype.getOverlayStore=function(){return this._overlayStore},s.prototype.getTooltipStore=function(){return this._tooltipStore},s.prototype.getActionStore=function(){return this._actionStore},s.prototype.getChart=function(){return this._chart},s}(),$={MAIN:"main",X_AXIS:"xAxis",Y_AXIS:"yAxis",SEPARATOR:"separator"},si=7;function jl(){return Be(this,void 0,void 0,function(){return Ve(this,function(s){switch(s.label){case 0:return[4,new Promise(function(t){var e=new ResizeObserver(function(i){t(i.every(function(n){return"devicePixelContentBoxSize"in n})),e.disconnect()});e.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})];case 1:return[2,s.sent()]}})})}var Is=function(){function s(t,e){var i=this;this._supportedDevicePixelContentBox=!1,this._width=0,this._height=0,this._pixelWidth=0,this._pixelHeight=0,this._nextPixelWidth=0,this._nextPixelHeight=0,this._requestAnimationId=un,this._mediaQueryListener=function(){var n=ae(i._element);i._nextPixelWidth=Math.round(i._element.clientWidth*n),i._nextPixelHeight=Math.round(i._element.clientHeight*n),i._resetPixelRatio()},this._listener=e,this._element=Kt("canvas",t),this._ctx=this._element.getContext("2d",{willReadFrequently:!0}),jl().then(function(n){i._supportedDevicePixelContentBox=n,n?(i._resizeObserver=new ResizeObserver(function(r){var o,a=r.find(function(h){return h.target===i._element}),l=(o=a==null?void 0:a.devicePixelContentBoxSize)===null||o===void 0?void 0:o[0];k(l)&&(i._nextPixelWidth=l.inlineSize,i._nextPixelHeight=l.blockSize,(i._pixelWidth!==i._nextPixelWidth||i._pixelHeight!==i._nextPixelHeight)&&i._resetPixelRatio())}),i._resizeObserver.observe(i._element,{box:"device-pixel-content-box"})):(i._mediaQueryList=window.matchMedia("(resolution: ".concat(ae(i._element),"dppx)")),i._mediaQueryList.addListener(i._mediaQueryListener))}).catch(function(n){return!1})}return s.prototype._resetPixelRatio=function(){var t=this;this._executeListener(function(){var e=t._element.clientWidth,i=t._element.clientHeight,n=t._nextPixelWidth/e,r=t._nextPixelHeight/i;t._width=e,t._height=i,t._pixelWidth=t._nextPixelWidth,t._pixelHeight=t._nextPixelHeight,t._element.width=t._nextPixelWidth,t._element.height=t._nextPixelHeight,t._ctx.scale(n,r)})},s.prototype._executeListener=function(t){var e=this;this._requestAnimationId===un&&(this._requestAnimationId=Ri(function(){e._ctx.clearRect(0,0,e._width,e._height),t==null||t(),e._listener(),e._requestAnimationId=un}))},s.prototype.update=function(t,e){if(this._width!==t||this._height!==e){if(this._element.style.width="".concat(t,"px"),this._element.style.height="".concat(e,"px"),!this._supportedDevicePixelContentBox){var i=ae(this._element);this._nextPixelWidth=Math.round(t*i),this._nextPixelHeight=Math.round(e*i),this._resetPixelRatio()}}else this._executeListener()},s.prototype.getElement=function(){return this._element},s.prototype.getContext=function(){return this._ctx},s.prototype.destroy=function(){k(this._resizeObserver)&&this._resizeObserver.unobserve(this._element),k(this._mediaQueryList)&&this._mediaQueryList.removeListener(this._mediaQueryListener)},s}();function jr(s){var t={width:0,height:0,left:0,right:0,top:0,bottom:0};return k(s)&&kt(t,s),t}var Gr=function(s){Y(t,s);function t(e,i){var n=s.call(this)||this;return n._bounding=jr(),n._pane=i,n._rootContainer=e,n._container=n.createContainer(),e.appendChild(n._container),n}return t.prototype.setBounding=function(e){return kt(this._bounding,e),this},t.prototype.getContainer=function(){return this._container},t.prototype.getBounding=function(){return this._bounding},t.prototype.getPane=function(){return this._pane},t.prototype.update=function(e){this.updateImp(this._container,this._bounding,e??3)},t.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},t}(Jn),Kn=function(s){Y(t,s);function t(e,i){var n=s.call(this,e,i)||this;n._mainCanvas=new Is({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},function(){n.updateMain(n._mainCanvas.getContext())}),n._overlayCanvas=new Is({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},function(){n.updateOverlay(n._overlayCanvas.getContext())});var r=n.getContainer();return r.appendChild(n._mainCanvas.getElement()),r.appendChild(n._overlayCanvas.getElement()),n}return t.prototype.createContainer=function(){return Kt("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box",zIndex:"1"})},t.prototype.updateImp=function(e,i,n){var r=i.width,o=i.height,a=i.left;e.style.left="".concat(a,"px");var l=n,h=e.clientWidth,u=e.clientHeight;switch((r!==h||o!==u)&&(e.style.width="".concat(r,"px"),e.style.height="".concat(o,"px"),l=3),l){case 0:{this._mainCanvas.update(r,o);break}case 1:{this._overlayCanvas.update(r,o);break}case 3:case 4:{this._mainCanvas.update(r,o),this._overlayCanvas.update(r,o);break}}},t.prototype.destroy=function(){this._mainCanvas.destroy(),this._overlayCanvas.destroy()},t.prototype.getImage=function(e){var i=this.getBounding(),n=i.width,r=i.height,o=Kt("canvas",{width:"".concat(n,"px"),height:"".concat(r,"px"),boxSizing:"border-box"}),a=o.getContext("2d"),l=ae(o);return o.width=n*l,o.height=r*l,a.scale(l,l),a.drawImage(this._mainCanvas.getElement(),0,0,n,r),e&&a.drawImage(this._overlayCanvas.getElement(),0,0,n,r),o},t}(Gr);function We(s){return s==="transparent"||s==="none"||/^[rR][gG][Bb][Aa]\(([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\s]*,){3}[\s]*0[\s]*\)$/.test(s)||/^[hH][Ss][Ll][Aa]\(([\s]*(360｜3[0-5][0-9]|[012]?[0-9][0-9]?)[\s]*,)([\s]*((100|[0-9][0-9]?)%|0)[\s]*,){2}([\s]*0[\s]*)\)$/.test(s)}function Gl(s,t){var e=[];e=e.concat(t);for(var i=0;i<e.length;i++){var n=e[i],r=n.x,o=n.y,a=n.r,l=s.x-r,h=s.y-o;if(!(l*l+h*h>a*a))return!0}return!1}function Ul(s,t,e){var i=[];i=i.concat(t);var n=e.style,r=n===void 0?H.Fill:n,o=e.color,a=o===void 0?"currentColor":o,l=e.borderSize,h=l===void 0?1:l,u=e.borderColor,c=u===void 0?"currentColor":u,d=e.borderStyle,f=d===void 0?G.Solid:d,v=e.borderDashedValue,p=v===void 0?[2,2]:v,g=(r===H.Fill||e.style===H.StrokeFill)&&(!O(a)||!We(a));g&&(s.fillStyle=a,i.forEach(function(m){var _=m.x,w=m.y,y=m.r;s.beginPath(),s.arc(_,w,y,0,Math.PI*2),s.closePath(),s.fill()})),(r===H.Stroke||e.style===H.StrokeFill)&&h>0&&!We(c)&&(s.strokeStyle=c,s.lineWidth=h,f===G.Dashed?s.setLineDash(p):s.setLineDash([]),i.forEach(function(m){var _=m.x,w=m.y,y=m.r;(!g||y>h)&&(s.beginPath(),s.arc(_,w,y,0,Math.PI*2),s.closePath(),s.stroke())}))}var Jl={name:"circle",checkEventOn:Gl,draw:function(s,t,e){Ul(s,t,e)}};function Zl(s,t){var e=[];e=e.concat(t);for(var i=0;i<e.length;i++){for(var n=!1,r=e[i].coordinates,o=0,a=r.length-1;o<r.length;a=o++)r[o].y>s.y!=r[a].y>s.y&&s.x<(r[a].x-r[o].x)*(s.y-r[o].y)/(r[a].y-r[o].y)+r[o].x&&(n=!n);if(n)return!0}return!1}function Kl(s,t,e){var i=[];i=i.concat(t);var n=e.style,r=n===void 0?H.Fill:n,o=e.color,a=o===void 0?"currentColor":o,l=e.borderSize,h=l===void 0?1:l,u=e.borderColor,c=u===void 0?"currentColor":u,d=e.borderStyle,f=d===void 0?G.Solid:d,v=e.borderDashedValue,p=v===void 0?[2,2]:v;(r===H.Fill||e.style===H.StrokeFill)&&(!O(a)||!We(a))&&(s.fillStyle=a,i.forEach(function(g){var m=g.coordinates;s.beginPath(),s.moveTo(m[0].x,m[0].y);for(var _=1;_<m.length;_++)s.lineTo(m[_].x,m[_].y);s.closePath(),s.fill()})),(r===H.Stroke||e.style===H.StrokeFill)&&h>0&&!We(c)&&(s.strokeStyle=c,s.lineWidth=h,f===G.Dashed?s.setLineDash(p):s.setLineDash([]),i.forEach(function(g){var m=g.coordinates;s.beginPath(),s.moveTo(m[0].x,m[0].y);for(var _=1;_<m.length;_++)s.lineTo(m[_].x,m[_].y);s.closePath(),s.stroke()}))}var ql={name:"polygon",checkEventOn:Zl,draw:function(s,t,e){Kl(s,t,e)}};function th(s,t){var e=[];e=e.concat(t);for(var i=0;i<e.length;i++){var n=e[i],r=n.x,o=n.width;o<dt*2&&(r-=dt,o=dt*2);var a=n.y,l=n.height;if(l<dt*2&&(a-=dt,l=dt*2),s.x>=r&&s.x<=r+o&&s.y>=a&&s.y<=a+l)return!0}return!1}function Ur(s,t,e){var i,n=[];n=n.concat(t);var r=e.style,o=r===void 0?H.Fill:r,a=e.color,l=a===void 0?"transparent":a,h=e.borderSize,u=h===void 0?1:h,c=e.borderColor,d=c===void 0?"transparent":c,f=e.borderStyle,v=f===void 0?G.Solid:f,p=e.borderRadius,g=p===void 0?0:p,m=e.borderDashedValue,_=m===void 0?[2,2]:m,w=(i=s.roundRect)!==null&&i!==void 0?i:s.rect,y=(o===H.Fill||e.style===H.StrokeFill)&&(!O(l)||!We(l));if(y&&(s.fillStyle=l,n.forEach(function(b){var S=b.x,C=b.y,E=b.width,I=b.height;s.beginPath(),w.call(s,S,C,E,I,g),s.closePath(),s.fill()})),(o===H.Stroke||e.style===H.StrokeFill)&&u>0&&!We(d)){s.strokeStyle=d,s.fillStyle=d,s.lineWidth=u,v===G.Dashed?s.setLineDash(_):s.setLineDash([]);var x=u%2===1?.5:0,M=Math.round(x*2);n.forEach(function(b){var S=b.x,C=b.y,E=b.width,I=b.height;E>u*2&&I>u*2?(s.beginPath(),w.call(s,S+x,C+x,E-M,I-M,g),s.closePath(),s.stroke()):y||s.fillRect(S,C,E,I)})}}var eh={name:"rect",checkEventOn:th,draw:function(s,t,e){Ur(s,t,e)}};function Jr(s,t){var e=t.size,i=e===void 0?12:e,n=t.paddingLeft,r=n===void 0?0:n,o=t.paddingTop,a=o===void 0?0:o,l=t.paddingRight,h=l===void 0?0:l,u=t.paddingBottom,c=u===void 0?0:u,d=t.weight,f=d===void 0?"normal":d,v=t.family,p=s.x,g=s.y,m=s.text,_=s.align,w=_===void 0?"left":_,y=s.baseline,x=y===void 0?"top":y,M=s.width,b=s.height,S=M??r+Ai(m,i,f,v)+h,C=b??a+i+c,E;switch(w){case"left":case"start":{E=p;break}case"right":case"end":{E=p-S;break}default:{E=p-S/2;break}}var I;switch(x){case"top":case"hanging":{I=g;break}case"bottom":case"ideographic":case"alphabetic":{I=g-C;break}default:{I=g-C/2;break}}return{x:E,y:I,width:S,height:C}}function ih(s,t,e){var i=[];i=i.concat(t);for(var n=0;n<i.length;n++){var r=Jr(i[n],e),o=r.x,a=r.y,l=r.width,h=r.height;if(s.x>=o&&s.x<=o+l&&s.y>=a&&s.y<=a+h)return!0}return!1}function nh(s,t,e){var i=[];i=i.concat(t);var n=e.color,r=n===void 0?"currentColor":n,o=e.size,a=o===void 0?12:o,l=e.family,h=e.weight,u=e.paddingLeft,c=u===void 0?0:u,d=e.paddingTop,f=d===void 0?0:d,v=e.paddingRight,p=v===void 0?0:v,g=i.map(function(m){return Jr(m,e)});Ur(s,g,N(N({},e),{color:e.backgroundColor})),s.textAlign="left",s.textBaseline="top",s.font=Se(a,h,l),s.fillStyle=r,i.forEach(function(m,_){var w=g[_];s.fillText(m.text,w.x+c,w.y+f,w.width-c-p)})}var Zr={name:"text",checkEventOn:ih,draw:function(s,t,e){nh(s,t,e)}},sh=Zr;function rh(s,t){var e=s.x-t.x,i=s.y-t.y;return Math.sqrt(e*e+i*i)}function oh(s,t){var e=[];e=e.concat(t);for(var i=0;i<e.length;i++){var n=e[i];if(Math.abs(rh(s,n)-n.r)<dt){var r=n.r,o=n.startAngle,a=n.endAngle,l=r*Math.cos(o)+n.x,h=r*Math.sin(o)+n.y,u=r*Math.cos(a)+n.x,c=r*Math.sin(a)+n.y;if(s.x<=Math.max(l,u)+dt&&s.x>=Math.min(l,u)-dt&&s.y<=Math.max(h,c)+dt&&s.y>=Math.min(h,c)-dt)return!0}}return!1}function ah(s,t,e){var i=[];i=i.concat(t);var n=e.style,r=n===void 0?G.Solid:n,o=e.size,a=o===void 0?1:o,l=e.color,h=l===void 0?"currentColor":l,u=e.dashedValue,c=u===void 0?[2,2]:u;s.lineWidth=a,s.strokeStyle=h,r===G.Dashed?s.setLineDash(c):s.setLineDash([]),i.forEach(function(d){var f=d.x,v=d.y,p=d.r,g=d.startAngle,m=d.endAngle;s.beginPath(),s.arc(f,v,p,g,m),s.stroke(),s.closePath()})}var lh={name:"arc",checkEventOn:oh,draw:function(s,t,e){ah(s,t,e)}},Kr={},hh=[Jl,Cl,ql,eh,Zr,sh,lh];hh.forEach(function(s){Kr[s.name]=bl.extend(s)});function uh(s){var t;return(t=Kr[s])!==null&&t!==void 0?t:null}var Xt=function(s){Y(t,s);function t(e){var i=s.call(this)||this;return i._widget=e,i}return t.prototype.getWidget=function(){return this._widget},t.prototype.createFigure=function(e,i){var n=uh(e.name);if(n!==null){var r=new n(e);if(k(i)){for(var o in i)i.hasOwnProperty(o)&&r.registerEvent(o,i[o]);this.addChild(r)}return r}return null},t.prototype.draw=function(e){this.clear(),this.drawImp(e)},t}(Jn),ch=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i,n,r=this.getWidget(),o=this.getWidget().getPane(),a=o.getChart(),l=r.getBounding(),h=a.getStyles().grid,u=h.show;if(u){e.save(),e.globalCompositeOperation="destination-over";var c=h.horizontal,d=c.show;if(d){var f=o.getAxisComponent(),v=f.getTicks().map(function(_){return{coordinates:[{x:0,y:_.coord},{x:l.width,y:_.coord}]}});(i=this.createFigure({name:"line",attrs:v,styles:c}))===null||i===void 0||i.draw(e)}var p=h.vertical,g=p.show;if(g){var m=a.getXAxisPane().getAxisComponent(),v=m.getTicks().map(function(w){return{coordinates:[{x:w.coord,y:0},{x:w.coord,y:l.height}]}});(n=this.createFigure({name:"line",attrs:v,styles:p}))===null||n===void 0||n.draw(e)}e.restore()}},t}(Xt),qn=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.eachChildren=function(e){var i=this.getWidget().getPane(),n=i.getChart().getChartStore(),r=n.getVisibleDataList(),o=n.getTimeScaleStore().getBarSpace();r.forEach(function(a,l){e(a,o,l)})},t}(Xt),qr=function(s){Y(t,s);function t(){var e=s!==null&&s.apply(this,arguments)||this;return e._boundCandleBarClickEvent=function(i){return function(){return e.getWidget().getPane().getChart().getChartStore().getActionStore().execute(Tt.OnCandleBarClick,i),!1}},e}return t.prototype.drawImp=function(e){var i=this,n=this.getWidget().getPane(),r=n.getId()===j.CANDLE,o=n.getChart().getChartStore(),a=this.getCandleBarOptions(o);if(a!==null){var l=0,h=0;if(a.type===Pt.Ohlc){var u=o.getTimeScaleStore().getBarSpace().gapBar;l=Math.min(Math.max(Math.round(u*.2),1),8),l>2&&l%2===1&&l--,h=Math.floor(h/2)}var c=n.getAxisComponent();this.eachChildren(function(d,f){var v=d.data,p=d.x;if(k(v)){var g=v.open,m=v.high,_=v.low,w=v.close,y=a.type,x=a.styles,M=[];w>g?(M[0]=x.upColor,M[1]=x.upBorderColor,M[2]=x.upWickColor):w<g?(M[0]=x.downColor,M[1]=x.downBorderColor,M[2]=x.downWickColor):(M[0]=x.noChangeColor,M[1]=x.noChangeBorderColor,M[2]=x.noChangeWickColor);var b=c.convertToPixel(g),S=c.convertToPixel(w),C=[b,S,c.convertToPixel(m),c.convertToPixel(_)];C.sort(function(I,P){return I-P});var E=[];switch(y){case Pt.CandleSolid:{E=i._createSolidBar(p,C,f,M);break}case Pt.CandleStroke:{E=i._createStrokeBar(p,C,f,M);break}case Pt.CandleUpStroke:{w>g?E=i._createStrokeBar(p,C,f,M):E=i._createSolidBar(p,C,f,M);break}case Pt.CandleDownStroke:{g>w?E=i._createStrokeBar(p,C,f,M):E=i._createSolidBar(p,C,f,M);break}case Pt.Ohlc:{E=[{name:"rect",attrs:[{x:p-h,y:C[0],width:l,height:C[3]-C[0]},{x:p-f.halfGapBar,y:b+l>C[3]?C[3]-l:b,width:f.halfGapBar,height:l},{x:p+h,y:S+l>C[3]?C[3]-l:S,width:f.halfGapBar-h,height:l}],styles:{color:M[0]}}];break}}E.forEach(function(I){var P,T;r&&(T={mouseClickEvent:i._boundCandleBarClickEvent(d)}),(P=i.createFigure(I,T))===null||P===void 0||P.draw(e)})}})}},t.prototype.getCandleBarOptions=function(e){var i=e.getStyles().candle;return{type:i.type,styles:i.bar}},t.prototype._createSolidBar=function(e,i,n,r){return[{name:"rect",attrs:{x:e,y:i[0],width:1,height:i[3]-i[0]},styles:{color:r[2]}},{name:"rect",attrs:{x:e-n.halfGapBar,y:i[1],width:n.gapBar,height:Math.max(1,i[2]-i[1])},styles:{style:H.StrokeFill,color:r[0],borderColor:r[1]}}]},t.prototype._createStrokeBar=function(e,i,n,r){return[{name:"rect",attrs:[{x:e,y:i[0],width:1,height:i[1]-i[0]},{x:e,y:i[2],width:1,height:i[3]-i[2]}],styles:{color:r[2]}},{name:"rect",attrs:{x:e-n.halfGapBar,y:i[1],width:n.gapBar,height:Math.max(1,i[2]-i[1])},styles:{style:H.Stroke,borderColor:r[1]}}]},t}(qn),dh=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.getCandleBarOptions=function(e){var i,n,r=this.getWidget().getPane(),o=r.getAxisComponent();if(!o.isInCandle()){var a=e.getIndicatorStore().getInstances(r.getId());try{for(var l=be(a),h=l.next();!h.done;h=l.next()){var u=h.value;if(u.shouldOhlc&&u.visible){var c=u.styles,d=e.getStyles().indicator,f=gt(c,"ohlc.upColor",d.ohlc.upColor),v=gt(c,"ohlc.downColor",d.ohlc.downColor),p=gt(c,"ohlc.noChangeColor",d.ohlc.noChangeColor);return{type:Pt.Ohlc,styles:{upColor:f,downColor:v,noChangeColor:p,upBorderColor:f,downBorderColor:v,noChangeBorderColor:p,upWickColor:f,downWickColor:v,noChangeWickColor:p}}}}}catch(g){i={error:g}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(i)throw i.error}}}return null},t.prototype.drawImp=function(e){var i=this;s.prototype.drawImp.call(this,e);var n=this.getWidget(),r=n.getPane(),o=r.getChart(),a=n.getBounding(),l=o.getXAxisPane().getAxisComponent(),h=r.getAxisComponent(),u=o.getChartStore(),c=u.getDataList(),d=u.getTimeScaleStore(),f=d.getVisibleRange(),v=u.getIndicatorStore().getInstances(r.getId()),p=u.getStyles().indicator;e.save(),v.forEach(function(g){var m;if(g.visible){g.zLevel<0?e.globalCompositeOperation="destination-over":e.globalCompositeOperation="source-over";var _=!1;if(g.draw!==null&&(e.save(),_=(m=g.draw({ctx:e,kLineDataList:c,indicator:g,visibleRange:f,bounding:a,barSpace:d.getBarSpace(),defaultStyles:p,xAxis:l,yAxis:h}))!==null&&m!==void 0?m:!1,e.restore()),!_){var w=g.result,y=[];i.eachChildren(function(x,M){var b,S,C,E=M.halfGapBar,I=x.dataIndex,P=x.x,T=l.convertToPixel(I-1),R=l.convertToPixel(I+1),L=(b=w[I-1])!==null&&b!==void 0?b:null,F=(S=w[I])!==null&&S!==void 0?S:null,X=(C=w[I+1])!==null&&C!==void 0?C:null,W={x:T},et={x:P},nt={x:R};g.figures.forEach(function(J){var Z=J.key,at=L==null?void 0:L[Z];V(at)&&(W[Z]=h.convertToPixel(at));var st=F==null?void 0:F[Z];V(st)&&(et[Z]=h.convertToPixel(st));var tt=X==null?void 0:X[Z];V(tt)&&(nt[Z]=h.convertToPixel(tt))}),Un(c,g,I,p,function(J,Z,at){var st,tt,ht;if(k(F==null?void 0:F[J.key])){var Bt=et[J.key],Dt=(st=J.attrs)===null||st===void 0?void 0:st.call(J,{data:{prev:L,current:F,next:X},coordinate:{prev:W,current:et,next:nt},bounding:a,barSpace:M,xAxis:l,yAxis:h});if(!k(Dt))switch(J.type){case"circle":{Dt={x:P,y:Bt,r:Math.max(1,E)};break}case"rect":case"bar":{var qt=(tt=J.baseValue)!==null&&tt!==void 0?tt:h.getRange().from,te=h.convertToPixel(qt),he=Math.abs(te-Bt);qt!==(F==null?void 0:F[J.key])&&(he=Math.max(1,he));var Vt=void 0;Bt>te?Vt=te:Vt=Bt,Dt={x:P-E,y:Vt,width:Math.max(1,E*2),height:he};break}case"line":{k(y[at])||(y[at]=[]),V(et[J.key])&&V(nt[J.key])&&y[at].push({coordinates:[{x:et.x,y:et[J.key]},{x:nt.x,y:nt[J.key]}],styles:Z});break}}var De=J.type;k(Dt)&&De!=="line"&&((ht=i.createFigure({name:De==="bar"?"rect":De,attrs:Dt,styles:Z}))===null||ht===void 0||ht.draw(e))}})}),y.forEach(function(x){if(x.length>1){for(var M=[{coordinates:[x[0].coordinates[0],x[0].coordinates[1]],styles:x[0].styles}],b=1;b<x.length;b++){var S=M[M.length-1],C=x[b],E=S.coordinates[S.coordinates.length-1];E.x===C.coordinates[0].x&&E.y===C.coordinates[0].y&&S.styles.style===C.styles.style&&S.styles.color===C.styles.color&&S.styles.size===C.styles.size&&S.styles.smooth===C.styles.smooth&&S.styles.dashedValue[0]===C.styles.dashedValue[0]&&S.styles.dashedValue[1]===C.styles.dashedValue[1]?S.coordinates.push(C.coordinates[1]):M.push({coordinates:[C.coordinates[0],C.coordinates[1]],styles:C.styles})}M.forEach(function(I){var P,T=I.coordinates,R=I.styles;(P=i.createFigure({name:"line",attrs:{coordinates:T},styles:R}))===null||P===void 0||P.draw(e)})}})}}}),e.restore()},t}(qr),fh=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i=this.getWidget(),n=i.getPane(),r=i.getBounding(),o=i.getPane().getChart().getChartStore(),a=o.getTooltipStore().getCrosshair(),l=o.getStyles().crosshair;if(O(a.paneId)&&l.show){if(a.paneId===n.getId()){var h=a.y;this._drawLine(e,[{x:0,y:h},{x:r.width,y:h}],l.horizontal)}var u=a.realX;this._drawLine(e,[{x:u,y:0},{x:u,y:r.height}],l.vertical)}},t.prototype._drawLine=function(e,i,n){var r;if(n.show){var o=n.line;o.show&&((r=this.createFigure({name:"line",attrs:{coordinates:i},styles:o}))===null||r===void 0||r.draw(e))}},t}(Xt),to=function(s){Y(t,s);function t(){var e=s!==null&&s.apply(this,arguments)||this;return e._boundIconClickEvent=function(i){return function(){var n=e.getWidget().getPane();return n.getChart().getChartStore().getActionStore().execute(Tt.OnTooltipIconClick,N({},i)),!0}},e._boundIconMouseMoveEvent=function(i){return function(){var n=e.getWidget().getPane(),r=n.getChart().getChartStore().getTooltipStore();return r.setActiveIcon(N({},i)),!0}},e}return t.prototype.drawImp=function(e){var i=this.getWidget(),n=i.getPane(),r=n.getChart().getChartStore(),o=r.getTooltipStore().getCrosshair();if(k(o.kLineData)){var a=i.getBounding(),l=r.getCustomApi(),h=r.getThousandsSeparator(),u=r.getDecimalFoldThreshold(),c=r.getIndicatorStore().getInstances(n.getId()),d=r.getTooltipStore().getActiveIcon(),f=r.getStyles().indicator,v=f.tooltip,p=v.offsetLeft,g=v.offsetTop,m=v.offsetRight;this.drawIndicatorTooltip(e,n.getId(),r.getDataList(),o,d,c,l,h,u,p,g,a.width-m,f)}},t.prototype.drawIndicatorTooltip=function(e,i,n,r,o,a,l,h,u,c,d,f,v){var p=this,g=v.tooltip;if(this.isDrawTooltip(r,g)){var m=g.text;a.forEach(function(_){var w=0,y={x:c,y:d},x=p.getIndicatorTooltipData(n,r,_,l,h,u,v),M=x.name,b=x.calcParamsText,S=x.values,C=x.icons,E=M.length>0,I=S.length>0;if(E||I){var P=Ee(p.classifyTooltipIcons(C),3),T=P[0],R=P[1],L=P[2];if(w=p.drawStandardTooltipIcons(e,o,T,y,i,_.name,c,w,f),E){var F=M;b.length>0&&(F="".concat(F).concat(b)),w=p.drawStandardTooltipLegends(e,[{title:{text:"",color:m.color},value:{text:F,color:m.color}}],y,c,w,f,m)}w=p.drawStandardTooltipIcons(e,o,R,y,i,_.name,c,w,f),I&&(w=p.drawStandardTooltipLegends(e,S,y,c,w,f,g.text)),w=p.drawStandardTooltipIcons(e,o,L,y,i,_.name,c,w,f),d=y.y+w}})}return d},t.prototype.drawStandardTooltipIcons=function(e,i,n,r,o,a,l,h,u){var c=this;if(n.length>0){var d=0,f=0;n.forEach(function(v){var p=v.marginLeft,g=p===void 0?0:p,m=v.marginTop,_=m===void 0?0:m,w=v.marginRight,y=w===void 0?0:w,x=v.marginBottom,M=x===void 0?0:x,b=v.paddingLeft,S=b===void 0?0:b,C=v.paddingTop,E=C===void 0?0:C,I=v.paddingRight,P=I===void 0?0:I,T=v.paddingBottom,R=T===void 0?0:T,L=v.size,F=v.fontFamily,X=v.icon;e.font=Se(L,"normal",F),d+=g+S+e.measureText(X).width+P+y,f=Math.max(f,_+E+L+R+M)}),r.x+d>u?(r.x=l,r.y+=h,h=f):h=Math.max(h,f),n.forEach(function(v){var p,g=v.marginLeft,m=g===void 0?0:g,_=v.marginTop,w=_===void 0?0:_,y=v.marginRight,x=y===void 0?0:y,M=v.paddingLeft,b=M===void 0?0:M,S=v.paddingTop,C=S===void 0?0:S,E=v.paddingRight,I=E===void 0?0:E,P=v.paddingBottom,T=P===void 0?0:P,R=v.color,L=v.activeColor,F=v.size,X=v.fontFamily,W=v.icon,et=v.backgroundColor,nt=v.activeBackgroundColor,J=(i==null?void 0:i.paneId)===o&&(i==null?void 0:i.indicatorName)===a&&(i==null?void 0:i.iconId)===v.id;(p=c.createFigure({name:"text",attrs:{text:W,x:r.x+m,y:r.y+w},styles:{paddingLeft:b,paddingTop:C,paddingRight:I,paddingBottom:T,color:J?L:R,size:F,family:X,backgroundColor:J?nt:et}},{mouseClickEvent:c._boundIconClickEvent({paneId:o,indicatorName:a,iconId:v.id}),mouseMoveEvent:c._boundIconMouseMoveEvent({paneId:o,indicatorName:a,iconId:v.id})}))===null||p===void 0||p.draw(e),r.x+=m+b+e.measureText(W).width+I+x})}return h},t.prototype.drawStandardTooltipLegends=function(e,i,n,r,o,a,l){var h=this;if(i.length>0){var u=l.marginLeft,c=l.marginTop,d=l.marginRight,f=l.marginBottom,v=l.size,p=l.family,g=l.weight;e.font=Se(v,g,p),i.forEach(function(m){var _,w,y=m.title,x=m.value,M=e.measureText(y.text).width,b=e.measureText(x.text).width,S=M+b,C=c+v+f;n.x+u+S+d>a?(n.x=r,n.y+=o,o=C):o=Math.max(o,C),y.text.length>0&&((_=h.createFigure({name:"text",attrs:{x:n.x+u,y:n.y+c,text:y.text},styles:{color:y.color,size:v,family:p,weight:g}}))===null||_===void 0||_.draw(e)),(w=h.createFigure({name:"text",attrs:{x:n.x+u+M,y:n.y+c,text:x.text},styles:{color:x.color,size:v,family:p,weight:g}}))===null||w===void 0||w.draw(e),n.x+=u+S+d})}return o},t.prototype.isDrawTooltip=function(e,i){var n=i.showRule;return n===Oe.Always||n===Oe.FollowCross&&O(e.paneId)},t.prototype.getIndicatorTooltipData=function(e,i,n,r,o,a,l){var h,u,c=l.tooltip,d=c.showName?n.shortName:"",f="",v=n.calcParams;v.length>0&&c.showParams&&(f="(".concat(v.join(","),")"));var p={name:d,calcParamsText:f,values:[],icons:c.icons},g=i.dataIndex,m=(h=n.result)!==null&&h!==void 0?h:[],_=[];if(n.visible){var w=(u=m[g])!==null&&u!==void 0?u:{};Un(e,n,g,l,function(R,L){var F;if(O(R.title)){var X=L.color,W=(F=w[R.key])!==null&&F!==void 0?F:c.defaultValue;V(W)&&(W=ut(W,n.precision),n.shouldFormatBigNumber&&(W=r.formatBigNumber(W)),W=ft(ct(W,o),a)),_.push({title:{text:R.title,color:X},value:{text:W,color:X}})}}),p.values=_}if(n.createTooltipDataSource!==null){var y=this.getWidget(),x=y.getPane(),M=x.getChart().getChartStore(),b=n.createTooltipDataSource({kLineDataList:e,indicator:n,visibleRange:M.getTimeScaleStore().getVisibleRange(),bounding:y.getBounding(),crosshair:i,defaultStyles:l,xAxis:x.getChart().getXAxisPane().getAxisComponent(),yAxis:x.getAxisComponent()}),S=b.name,C=b.calcParamsText,E=b.values,I=b.icons;if(O(S)&&c.showName&&(p.name=S),O(C)&&c.showParams&&(p.calcParamsText=C),k(I)&&(p.icons=I),k(E)&&n.visible){var P=[],T=l.tooltip.text.color;E.forEach(function(R){var L,F={text:"",color:T};Wt(R.title)?F=R.title:F.text=R.title;var X={text:"",color:T};if(Wt(R.value)?X=R.value:X.text=(L=R.value)!==null&&L!==void 0?L:c.defaultValue,V(X.text)){var W=ut(X.text,n.precision);n.shouldFormatBigNumber&&(W=r.formatBigNumber(W)),W=ft(ct(W,o),a),X.text=W}P.push({title:F,value:X})}),p.values=P}}return p},t.prototype.classifyTooltipIcons=function(e){var i=[],n=[],r=[];return e.forEach(function(o){switch(o.position){case ni.Left:{i.push(o);break}case ni.Middle:{n.push(o);break}case ni.Right:{r.push(o);break}}}),[i,n,r]},t}(Xt),eo=function(s){Y(t,s);function t(e){var i=s.call(this,e)||this;return i._initEvent(),i}return t.prototype._initEvent=function(){var e=this,i=this.getWidget().getPane(),n=i.getId(),r=i.getChart().getChartStore().getOverlayStore();this.registerEvent("mouseMoveEvent",function(o){var a,l=r.getProgressInstanceInfo();if(l!==null){var h=l.instance,u=l.paneId;h.isStart()&&(r.updateProgressInstanceInfo(n),u=n);var c=h.points.length-1,d="".concat(Ae,"point_").concat(c);return h.isDrawing()&&u===n&&(h.eventMoveForDrawing(e._coordinateToPoint(l.instance,o)),(a=h.onDrawing)===null||a===void 0||a.call(h,N({overlay:h,figureKey:d,figureIndex:c},o))),e._figureMouseMoveEvent(h,1,d,c,0)(o)}return r.setHoverInstanceInfo({paneId:n,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},o),!1}).registerEvent("mouseClickEvent",function(o){var a,l,h=r.getProgressInstanceInfo();if(h!==null){var u=h.instance,c=h.paneId;u.isStart()&&(r.updateProgressInstanceInfo(n,!0),c=n);var d=u.points.length-1,f="".concat(Ae,"point_").concat(d);return u.isDrawing()&&c===n&&(u.eventMoveForDrawing(e._coordinateToPoint(u,o)),(a=u.onDrawing)===null||a===void 0||a.call(u,N({overlay:u,figureKey:f,figureIndex:d},o)),u.nextStep(),u.isDrawing()||(r.progressInstanceComplete(),(l=u.onDrawEnd)===null||l===void 0||l.call(u,N({overlay:u,figureKey:f,figureIndex:d},o)))),e._figureMouseClickEvent(u,1,f,d,0)(o)}return r.setClickInstanceInfo({paneId:n,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},o),!1}).registerEvent("mouseDoubleClickEvent",function(o){var a,l=r.getProgressInstanceInfo();if(l!==null){var h=l.instance,u=l.paneId;if(h.isDrawing()&&u===n&&(h.forceComplete(),!h.isDrawing())){r.progressInstanceComplete();var c=h.points.length-1,d="".concat(Ae,"point_").concat(c);(a=h.onDrawEnd)===null||a===void 0||a.call(h,N({overlay:h,figureKey:d,figureIndex:c},o))}var f=h.points.length-1;return e._figureMouseClickEvent(h,1,"".concat(Ae,"point_").concat(f),f,0)(o)}return!1}).registerEvent("mouseRightClickEvent",function(o){var a=r.getProgressInstanceInfo();if(a!==null){var l=a.instance;if(l.isDrawing()){var h=l.points.length-1;return e._figureMouseRightClickEvent(l,1,"".concat(Ae,"point_").concat(h),h,0)(o)}}return!1}).registerEvent("mouseUpEvent",function(o){var a,l=r.getPressedInstanceInfo(),h=l.instance,u=l.figureIndex,c=l.figureKey;return h!==null&&((a=h.onPressedMoveEnd)===null||a===void 0||a.call(h,N({overlay:h,figureKey:c,figureIndex:u},o))),r.setPressedInstanceInfo({paneId:n,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1}),!1}).registerEvent("pressedMouseMoveEvent",function(o){var a,l,h=r.getPressedInstanceInfo(),u=h.instance,c=h.figureType,d=h.figureIndex,f=h.figureKey;if(u!==null){if(!u.lock&&!((l=(a=u.onPressedMoving)===null||a===void 0?void 0:a.call(u,N({overlay:u,figureIndex:d,figureKey:f},o)))!==null&&l!==void 0&&l)){var v=e._coordinateToPoint(u,o);c===1?u.eventPressedPointMove(v,d):u.eventPressedOtherMove(v,e.getWidget().getPane().getChart().getChartStore().getTimeScaleStore())}return!0}return!1})},t.prototype._createFigureEvents=function(e,i,n,r,o,a){var l;if(!e.isDrawing()){var h=[];if(k(a)&&(_e(a)?a&&(h=Ta()):h=a),h.length===0)return{mouseMoveEvent:this._figureMouseMoveEvent(e,i,n,r,o),mouseDownEvent:this._figureMouseDownEvent(e,i,n,r,o),mouseClickEvent:this._figureMouseClickEvent(e,i,n,r,o),mouseRightClickEvent:this._figureMouseRightClickEvent(e,i,n,r,o),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(e,i,n,r,o)};l={},!h.includes("mouseMoveEvent")&&!h.includes("touchMoveEvent")&&(l.mouseMoveEvent=this._figureMouseMoveEvent(e,i,n,r,o)),!h.includes("mouseDownEvent")&&!h.includes("touchStartEvent")&&(l.mouseDownEvent=this._figureMouseDownEvent(e,i,n,r,o)),!h.includes("mouseClickEvent")&&!h.includes("tapEvent")&&(l.mouseClickEvent=this._figureMouseClickEvent(e,i,n,r,o)),!h.includes("mouseDoubleClickEvent")&&!h.includes("doubleTapEvent")&&(l.mouseDoubleClickEvent=this._figureMouseDoubleClickEvent(e,i,n,r,o)),h.includes("mouseRightClickEvent")||(l.mouseRightClickEvent=this._figureMouseRightClickEvent(e,i,n,r,o))}return l},t.prototype._figureMouseMoveEvent=function(e,i,n,r,o){var a=this;return function(l){var h=a.getWidget().getPane(),u=h.getChart().getChartStore().getOverlayStore();return u.setHoverInstanceInfo({paneId:h.getId(),instance:e,figureType:i,figureKey:n,figureIndex:r,attrsIndex:o},l),!0}},t.prototype._figureMouseDownEvent=function(e,i,n,r,o){var a=this;return function(l){var h,u=a.getWidget().getPane(),c=u.getId(),d=u.getChart().getChartStore().getOverlayStore();return e.startPressedMove(a._coordinateToPoint(e,l)),(h=e.onPressedMoveStart)===null||h===void 0||h.call(e,N({overlay:e,figureIndex:r,figureKey:n},l)),d.setPressedInstanceInfo({paneId:c,instance:e,figureType:i,figureKey:n,figureIndex:r,attrsIndex:o}),!0}},t.prototype._figureMouseClickEvent=function(e,i,n,r,o){var a=this;return function(l){var h=a.getWidget().getPane(),u=h.getId(),c=h.getChart().getChartStore().getOverlayStore();return c.setClickInstanceInfo({paneId:u,instance:e,figureType:i,figureKey:n,figureIndex:r,attrsIndex:o},l),!0}},t.prototype._figureMouseDoubleClickEvent=function(e,i,n,r,o){return function(a){var l;return(l=e.onDoubleClick)===null||l===void 0||l.call(e,N(N({},a),{figureIndex:r,figureKey:n,overlay:e})),!0}},t.prototype._figureMouseRightClickEvent=function(e,i,n,r,o){var a=this;return function(l){var h,u;if(!((u=(h=e.onRightClick)===null||h===void 0?void 0:h.call(e,N({overlay:e,figureIndex:r,figureKey:n},l)))!==null&&u!==void 0&&u)){var c=a.getWidget().getPane(),d=c.getChart().getChartStore().getOverlayStore();d.removeInstance(e)}return!0}},t.prototype._coordinateToPoint=function(e,i){var n,r={},o=this.getWidget().getPane(),a=o.getChart(),l=o.getId(),h=a.getChartStore().getTimeScaleStore();if(this.coordinateToPointTimestampDataIndexFlag()){var u=a.getXAxisPane().getAxisComponent(),c=u.convertFromPixel(i.x),d=(n=h.dataIndexToTimestamp(c))!==null&&n!==void 0?n:void 0;r.dataIndex=c,r.timestamp=d}if(this.coordinateToPointValueFlag()){var f=o.getAxisComponent(),v=f.convertFromPixel(i.y);if(e.mode!==Ne.Normal&&l===j.CANDLE&&V(r.dataIndex)){var p=h.getDataByDataIndex(r.dataIndex);if(p!==null){var g=e.modeSensitivity;if(v>p.high)if(e.mode===Ne.WeakMagnet){var m=f.convertToPixel(p.high),_=f.convertFromPixel(m-g);v<_&&(v=p.high)}else v=p.high;else if(v<p.low)if(e.mode===Ne.WeakMagnet){var w=f.convertToPixel(p.low),_=f.convertFromPixel(w-g);v>_&&(v=p.low)}else v=p.low;else{var y=Math.max(p.open,p.close),x=Math.min(p.open,p.close);v>y?v-y<p.high-v?v=y:v=p.high:v<x?v-p.low<x-v?v=p.low:v=x:y-v<v-x?v=y:v=x}}}r.value=v}return r},t.prototype.coordinateToPointValueFlag=function(){return!0},t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},t.prototype.dispatchEvent=function(e,i,n){return this.getWidget().getPane().getChart().getChartStore().getOverlayStore().isDrawing()?this.onEvent(e,i,n):s.prototype.dispatchEvent.call(this,e,i,n)},t.prototype.checkEventOn=function(){return!0},t.prototype.drawImp=function(e){var i=this,n=this.getWidget(),r=n.getPane(),o=r.getId(),a=r.getChart(),l=r.getAxisComponent(),h=a.getXAxisPane().getAxisComponent(),u=n.getBounding(),c=a.getChartStore(),d=c.getCustomApi(),f=c.getThousandsSeparator(),v=c.getDecimalFoldThreshold(),p=c.getTimeScaleStore(),g=p.getDateTimeFormat(),m=p.getBarSpace(),_=c.getPrecision(),w=c.getStyles().overlay,y=c.getOverlayStore(),x=y.getHoverInstanceInfo(),M=y.getClickInstanceInfo(),b=this.getCompleteOverlays(y,o),S=c.getIndicatorStore().getInstances(o),C=S.reduce(function(P,T){var R=T.precision;return P[T.name]=R,P.max=Math.max(P.max,R),P.min=Math.min(P.min,R),P.excludePriceVolumeMax=Math.max(P.excludePriceVolumeMax,R),P.excludePriceVolumeMin=Math.min(P.excludePriceVolumeMin,R),P},N(N({},_),{max:Math.max(_.price,_.volume),min:Math.min(_.price,_.volume),excludePriceVolumeMax:Number.MIN_SAFE_INTEGER,excludePriceVolumeMin:Number.MAX_SAFE_INTEGER}));b.forEach(function(P){P.visible&&i._drawOverlay(e,P,u,m,C,g,d,f,v,w,h,l,x,M,p)});var E=y.getProgressInstanceInfo();if(E!==null){var I=this.getProgressOverlay(E,o);I!==null&&I.visible&&this._drawOverlay(e,I,u,m,C,g,d,f,v,w,h,l,x,M,p)}},t.prototype._drawOverlay=function(e,i,n,r,o,a,l,h,u,c,d,f,v,p,g){var m=i.points,_=m.map(function(y){var x,M,b=y.dataIndex;V(y.timestamp)&&(b=g.timestampToDataIndex(y.timestamp));var S={x:0,y:0};return V(b)&&(S.x=(x=d==null?void 0:d.convertToPixel(b))!==null&&x!==void 0?x:0),V(y.value)&&(S.y=(M=f==null?void 0:f.convertToPixel(y.value))!==null&&M!==void 0?M:0),S});if(_.length>0){var w=new Array().concat(this.getFigures(i,_,n,r,o,h,u,a,c,d,f));this.drawFigures(e,i,w,c)}this.drawDefaultFigures(e,i,_,n,o,a,l,h,u,c,d,f,v,p)},t.prototype.drawFigures=function(e,i,n,r){var o=this;n.forEach(function(a,l){var h=a.type,u=a.styles,c=a.attrs,d=a.ignoreEvent,f=[].concat(c);f.forEach(function(v,p){var g,m,_,w=o._createFigureEvents(i,2,(g=a.key)!==null&&g!==void 0?g:"",l,p,d),y=N(N(N({},r[h]),(m=i.styles)===null||m===void 0?void 0:m[h]),u);(_=o.createFigure({name:h,attrs:v,styles:y},w))===null||_===void 0||_.draw(e)})})},t.prototype.getCompleteOverlays=function(e,i){return e.getInstances(i)},t.prototype.getProgressOverlay=function(e,i){return e.paneId===i?e.instance:null},t.prototype.getFigures=function(e,i,n,r,o,a,l,h,u,c,d){var f,v;return(v=(f=e.createPointFigures)===null||f===void 0?void 0:f.call(e,{overlay:e,coordinates:i,bounding:n,barSpace:r,precision:o,thousandsSeparator:a,decimalFoldThreshold:l,dateTimeFormat:h,defaultStyles:u,xAxis:c,yAxis:d}))!==null&&v!==void 0?v:[]},t.prototype.drawDefaultFigures=function(e,i,n,r,o,a,l,h,u,c,d,f,v,p){var g=this,m,_;if(i.needDefaultPointFigure&&(((m=v.instance)===null||m===void 0?void 0:m.id)===i.id&&v.figureType!==0||((_=p.instance)===null||_===void 0?void 0:_.id)===i.id&&p.figureType!==0)){var w=i.styles,y=N(N({},c.point),w==null?void 0:w.point);n.forEach(function(x,M){var b,S,C,E=x.x,I=x.y,P=y.radius,T=y.color,R=y.borderColor,L=y.borderSize;((b=v.instance)===null||b===void 0?void 0:b.id)===i.id&&v.figureType===1&&v.figureIndex===M&&(P=y.activeRadius,T=y.activeColor,R=y.activeBorderColor,L=y.activeBorderSize),(S=g.createFigure({name:"circle",attrs:{x:E,y:I,r:P+L},styles:{color:R}},g._createFigureEvents(i,1,"".concat(Ae,"point_").concat(M),M,0)))===null||S===void 0||S.draw(e),(C=g.createFigure({name:"circle",attrs:{x:E,y:I,r:P},styles:{color:T}}))===null||C===void 0||C.draw(e)})}},t}(Xt),io=function(s){Y(t,s);function t(e,i){var n=s.call(this,e,i)||this;return n._gridView=new ch(n),n._indicatorView=new dh(n),n._crosshairLineView=new fh(n),n._tooltipView=n.createTooltipView(),n._overlayView=new eo(n),n.addChild(n._tooltipView),n.addChild(n._overlayView),n.getContainer().style.cursor="crosshair",n.registerEvent("mouseMoveEvent",function(){return i.getChart().getChartStore().getTooltipStore().setActiveIcon(),!1}),n}return t.prototype.getName=function(){return $.MAIN},t.prototype.updateMain=function(e){this.updateMainContent(e),this._indicatorView.draw(e),this._gridView.draw(e)},t.prototype.createTooltipView=function(){return new to(this)},t.prototype.updateMainContent=function(e){},t.prototype.updateOverlay=function(e){this._overlayView.draw(e),this._crosshairLineView.draw(e),this._tooltipView.draw(e)},t}(Kn),vh=function(s){Y(t,s);function t(){var e=s!==null&&s.apply(this,arguments)||this;return e._ripplePoint=e.createFigure({name:"circle",attrs:{x:0,y:0,r:0},styles:{style:"fill"}}),e._animationFrameTime=0,e._animation=new Rn({iterationCount:1/0}).doFrame(function(i){e._animationFrameTime=i;var n=e.getWidget().getPane();n.getChart().updatePane(0,n.getId())}),e}return t.prototype.drawImp=function(e){var i,n,r,o=this.getWidget(),a=o.getPane(),l=a.getChart(),h=l.getDataList(),u=h.length-1,c=o.getBounding(),d=a.getAxisComponent(),f=l.getStyles().candle.area,v=[],p=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER,m=null;if(this.eachChildren(function(b){var S=b.data,C=b.x,E=S==null?void 0:S[f.value];if(V(E)){var I=d.convertToPixel(E);g===Number.MIN_SAFE_INTEGER&&(g=C),v.push({x:C,y:I}),p=Math.min(p,I),b.dataIndex===u&&(m={x:C,y:I})}}),v.length>0){(i=this.createFigure({name:"line",attrs:{coordinates:v},styles:{color:f.lineColor,size:f.lineSize,smooth:f.smooth}}))===null||i===void 0||i.draw(e);var _=f.backgroundColor,w=void 0;if(Ft(_)){var y=e.createLinearGradient(0,c.height,0,p);try{_.forEach(function(b){var S=b.offset,C=b.color;y.addColorStop(S,C)})}catch{}w=y}else w=_;e.fillStyle=w,e.beginPath(),e.moveTo(g,c.height),e.lineTo(v[0].x,v[0].y),Xr(e,v,f.smooth),e.lineTo(v[v.length-1].x,c.height),e.closePath(),e.fill()}var x=f.point;if(x.show&&k(m)){(n=this.createFigure({name:"circle",attrs:{x:m.x,y:m.y,r:x.radius},styles:{style:"fill",color:x.color}}))===null||n===void 0||n.draw(e);var M=x.rippleRadius;x.animation&&(M=x.radius+this._animationFrameTime/x.animationDuration*(x.rippleRadius-x.radius),this._animation.setDuration(x.animationDuration).start()),(r=this._ripplePoint)===null||r===void 0||r.setAttrs({x:m.x,y:m.y,r:M}).setStyles({style:"fill",color:x.rippleColor}).draw(e)}else this.stopAnimation()},t.prototype.stopAnimation=function(){this._animation.stop()},t}(qn),ph=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i=this.getWidget(),n=i.getPane(),r=n.getChart().getChartStore(),o=r.getStyles().candle.priceMark,a=o.high,l=o.low;if(o.show&&(a.show||l.show)){var h=r.getThousandsSeparator(),u=r.getDecimalFoldThreshold(),c=r.getPrecision(),d=n.getAxisComponent(),f=Number.MIN_SAFE_INTEGER,v=0,p=Number.MAX_SAFE_INTEGER,g=0;this.eachChildren(function(w){var y=w.data,x=w.x;k(y)&&(f<y.high&&(f=y.high,v=x),p>y.low&&(p=y.low,g=x))});var m=d.convertToPixel(f),_=d.convertToPixel(p);a.show&&f!==Number.MIN_SAFE_INTEGER&&this._drawMark(e,ft(ct(ut(f,c.price),h),u),{x:v,y:m},m<_?[-2,-5]:[2,5],a),l.show&&p!==Number.MAX_SAFE_INTEGER&&this._drawMark(e,ft(ct(ut(p,c.price),h),u),{x:g,y:_},m<_?[2,5]:[-2,-5],l)}},t.prototype._drawMark=function(e,i,n,r,o){var a,l,h,u=n.x,c=n.y+r[0];(a=this.createFigure({name:"line",attrs:{coordinates:[{x:u-2,y:c+r[0]},{x:u,y:c},{x:u+2,y:c+r[0]}]},styles:{color:o.color}}))===null||a===void 0||a.draw(e);var d,f,v,p=this.getWidget().getBounding().width;u>p/2?(d=u-5,f=d-o.textOffset,v="right"):(d=u+5,v="left",f=d+o.textOffset);var g=c+r[1];(l=this.createFigure({name:"line",attrs:{coordinates:[{x:u,y:c},{x:u,y:g},{x:d,y:g}]},styles:{color:o.color}}))===null||l===void 0||l.draw(e),(h=this.createFigure({name:"text",attrs:{x:f,y:g,text:i,align:v,baseline:"middle"},styles:{color:o.color,size:o.textSize,family:o.textFamily,weight:o.textWeight}}))===null||h===void 0||h.draw(e)},t}(qn),gh=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i,n=this.getWidget(),r=n.getPane(),o=n.getBounding(),a=r.getChart().getChartStore(),l=a.getStyles().candle.priceMark,h=l.last,u=h.line;if(l.show&&h.show&&u.show){var c=r.getAxisComponent(),d=a.getDataList(),f=d[d.length-1];if(f!=null){var v=f.close,p=f.open,g=c.convertToNicePixel(v),m=void 0;v>p?m=h.upColor:v<p?m=h.downColor:m=h.noChangeColor,(i=this.createFigure({name:"line",attrs:{coordinates:[{x:0,y:g},{x:o.width,y:g}]},styles:{style:u.style,color:m,size:u.size,dashedValue:u.dashedValue}}))===null||i===void 0||i.draw(e)}}},t}(Xt),mh={time:"时间：",open:"开：",high:"高：",low:"低：",close:"收：",volume:"成交量：",turnover:"成交额：",change:"涨幅："},_h={time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",turnover:"Turnover: ",change:"Change: "},yh={"zh-CN":mh,"en-US":_h};function wh(s,t){var e,i;return(i=(e=yh[t])===null||e===void 0?void 0:e[s])!==null&&i!==void 0?i:s}var bh=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i=this.getWidget(),n=i.getPane(),r=n.getId(),o=n.getChart().getChartStore(),a=o.getTooltipStore().getCrosshair();if(k(a.kLineData)){var l=i.getBounding(),h=n.getYAxisWidget().getBounding(),u=o.getDataList(),c=o.getPrecision(),d=o.getLocale(),f=o.getCustomApi(),v=o.getThousandsSeparator(),p=o.getDecimalFoldThreshold(),g=o.getTooltipStore().getActiveIcon(),m=o.getIndicatorStore().getInstances(n.getId()),_=o.getTimeScaleStore().getDateTimeFormat(),w=o.getStyles(),y=w.candle,x=w.indicator;if(y.tooltip.showType===zt.Rect&&x.tooltip.showType===zt.Rect){var M=this.isDrawTooltip(a,y.tooltip),b=this.isDrawTooltip(a,x.tooltip);this._drawRectTooltip(e,u,m,l,h,a,c,_,d,f,v,p,M,b,y.tooltip.offsetTop,w)}else if(y.tooltip.showType===zt.Standard&&x.tooltip.showType===zt.Standard){var S=y.tooltip,C=S.offsetLeft,E=S.offsetTop,I=S.offsetRight,P=l.width-I,T=this._drawCandleStandardTooltip(e,u,r,a,g,c,_,d,f,v,p,C,E,P,y);this.drawIndicatorTooltip(e,r,u,a,g,m,f,v,p,C,T,P,x)}else if(y.tooltip.showType===zt.Rect&&x.tooltip.showType===zt.Standard){var R=y.tooltip,C=R.offsetLeft,E=R.offsetTop,I=R.offsetRight,P=l.width-I,L=this.drawIndicatorTooltip(e,r,u,a,g,m,f,v,p,C,E,P,x),M=this.isDrawTooltip(a,y.tooltip);this._drawRectTooltip(e,u,m,l,h,a,c,_,d,f,v,p,M,!1,L,w)}else{var F=y.tooltip,C=F.offsetLeft,E=F.offsetTop,I=F.offsetRight,P=l.width-I,X=this._drawCandleStandardTooltip(e,u,r,a,g,c,_,d,f,v,p,C,E,P,y),b=this.isDrawTooltip(a,x.tooltip);this._drawRectTooltip(e,u,m,l,h,a,c,_,d,f,v,p,!1,b,X,w)}}},t.prototype._drawCandleStandardTooltip=function(e,i,n,r,o,a,l,h,u,c,d,f,v,p,g){var m,_,w,y=g.tooltip,x=y.text,M=0,b={x:f,y:v};if(this.isDrawTooltip(r,y)){var S=(m=r.dataIndex)!==null&&m!==void 0?m:0,C=this._getCandleTooltipLegends({prev:(_=i[S-1])!==null&&_!==void 0?_:null,current:r.kLineData,next:(w=i[S+1])!==null&&w!==void 0?w:null},a,l,h,u,c,d,g),E=Ee(this.classifyTooltipIcons(y.icons),3),I=E[0],P=E[1],T=E[2];M=this.drawStandardTooltipIcons(e,o,I,b,n,"",f,M,p),M=this.drawStandardTooltipIcons(e,o,P,b,n,"",f,M,p),C.length>0&&(M=this.drawStandardTooltipLegends(e,C,b,f,M,p,x)),M=this.drawStandardTooltipIcons(e,o,T,b,n,"",f,M,p)}return b.y+M},t.prototype._drawRectTooltip=function(e,i,n,r,o,a,l,h,u,c,d,f,v,p,g,m){var _=this,w,y,x,M,b,S=m.candle,C=m.indicator,E=S.tooltip,I=C.tooltip;if(v||p){var P=(w=a.dataIndex)!==null&&w!==void 0?w:0,T=this._getCandleTooltipLegends({prev:(y=i[P-1])!==null&&y!==void 0?y:null,current:a.kLineData,next:(x=i[P+1])!==null&&x!==void 0?x:null},l,h,u,c,d,f,S),R=E.offsetLeft,L=E.offsetTop,F=E.offsetRight,X=E.offsetBottom,W=E.text,et=W.marginLeft,nt=W.marginRight,J=W.marginTop,Z=W.marginBottom,at=W.size,st=W.weight,tt=W.family,ht=E.rect,Bt=ht.position,Dt=ht.paddingLeft,qt=ht.paddingRight,te=ht.paddingTop,he=ht.paddingBottom,Vt=ht.offsetLeft,De=ht.offsetRight,tn=ht.offsetTop,os=ht.offsetBottom,ee=ht.borderSize,Bo=ht.borderRadius,Vo=ht.borderColor,Lo=ht.color,Ge=0,ie=0,ne=0;v&&(e.font=Se(at,st,tt),T.forEach(function($t){var Mt=$t.title,Et=$t.value,Rt="".concat(Mt.text).concat(Et.text),Ht=e.measureText(Rt).width+et+nt;Ge=Math.max(Ge,Ht)}),ne+=(Z+J+at)*T.length);var ue=I.text,as=ue.marginLeft,ls=ue.marginRight,hs=ue.marginTop,us=ue.marginBottom,Ue=ue.size,en=ue.weight,nn=ue.family,cs=[];if(p&&(e.font=Se(Ue,en,nn),n.forEach(function($t){var Mt,Et=(Mt=_.getIndicatorTooltipData(i,a,$t,c,d,f,C).values)!==null&&Mt!==void 0?Mt:[];cs.push(Et),Et.forEach(function(Rt){var Ht=Rt.title,pi=Rt.value,Yo="".concat(Ht.text).concat(pi.text),Xo=e.measureText(Yo).width+as+ls;Ge=Math.max(Ge,Xo),ne+=hs+us+Ue})})),ie+=Ge,ie!==0&&ne!==0){ie+=ee*2+Dt+qt,ne+=ee*2+te+he;var No=r.width/2,ds=Bt===Di.Pointer&&a.paneId===j.CANDLE,fs=((M=a.realX)!==null&&M!==void 0?M:0)>No,At=0;if(ds){var vs=a.realX;fs?At=vs-De-ie:At=vs+Vt}else fs?(At=Vt+R,m.yAxis.inside&&m.yAxis.position===le.Left&&(At+=o.width)):(At=r.width-De-ie-F,m.yAxis.inside&&m.yAxis.position===le.Right&&(At-=o.width));var ce=g+tn;if(ds){var zo=a.y;ce=zo-ne/2,ce+ne>r.height-os-X&&(ce=r.height-os-ne-X),ce<g+tn&&(ce=g+tn+L)}(b=this.createFigure({name:"rect",attrs:{x:At,y:ce,width:ie,height:ne},styles:{style:H.StrokeFill,color:Lo,borderColor:Vo,borderSize:ee,borderRadius:Bo}}))===null||b===void 0||b.draw(e);var Oo=At+ee+Dt+et,se=ce+ee+te;if(v&&T.forEach(function($t){var Mt,Et;se+=J;var Rt=$t.title;(Mt=_.createFigure({name:"text",attrs:{x:Oo,y:se,text:Rt.text},styles:{color:Rt.color,size:at,family:tt,weight:st}}))===null||Mt===void 0||Mt.draw(e);var Ht=$t.value;(Et=_.createFigure({name:"text",attrs:{x:At+ie-ee-nt-qt,y:se,text:Ht.text,align:"right"},styles:{color:Ht.color,size:at,family:tt,weight:st}}))===null||Et===void 0||Et.draw(e),se+=at+Z}),p){var Wo=At+ee+Dt+as;cs.forEach(function($t){$t.forEach(function(Mt){var Et,Rt;se+=hs;var Ht=Mt.title,pi=Mt.value;(Et=_.createFigure({name:"text",attrs:{x:Wo,y:se,text:Ht.text},styles:{color:Ht.color,size:Ue,family:nn,weight:en}}))===null||Et===void 0||Et.draw(e),(Rt=_.createFigure({name:"text",attrs:{x:At+ie-ee-ls-qt,y:se,text:pi.text,align:"right"},styles:{color:pi.color,size:Ue,family:nn,weight:en}}))===null||Rt===void 0||Rt.draw(e),se+=Ue+us})})}}}},t.prototype._getCandleTooltipLegends=function(e,i,n,r,o,a,l,h){var u,c,d,f,v,p=h.tooltip,g=p.text.color,m=e.current,_=(c=(u=e.prev)===null||u===void 0?void 0:u.close)!==null&&c!==void 0?c:m.close,w=m.close-_,y=i.price,x=i.volume,M={"{time}":o.formatDate(n,m.timestamp,"YYYY-MM-DD HH:mm",mt.Tooltip),"{open}":ft(ct(ut(m.open,y),a),l),"{high}":ft(ct(ut(m.high,y),a),l),"{low}":ft(ct(ut(m.low,y),a),l),"{close}":ft(ct(ut(m.close,y),a),l),"{volume}":ft(ct(o.formatBigNumber(ut((d=m.volume)!==null&&d!==void 0?d:p.defaultValue,x)),a),l),"{turnover}":ft(ct(ut((f=m.turnover)!==null&&f!==void 0?f:p.defaultValue,y),a),l),"{change}":_===0?p.defaultValue:"".concat(ct(ut(w/_*100),a),"%")},b=(v=Zt(p.custom)?p.custom(e,h):p.custom)!==null&&v!==void 0?v:[];return b.map(function(S){var C,E=S.title,I=S.value,P={text:"",color:""};Wt(E)?P=N({},E):(P.text=E,P.color=g),P.text=wh(P.text,r);var T={text:p.defaultValue,color:""};Wt(I)?T=N({},I):(T.text=I,T.color=g);var R=T.text.match(/{(\S*)}/);if(R!==null&&R.length>1){var L="{".concat(R[1],"}");T.text=T.text.replace(L,(C=M[L])!==null&&C!==void 0?C:p.defaultValue),L==="{change}"&&(T.color=w===0?h.priceMark.last.noChangeColor:w>0?h.priceMark.last.upColor:h.priceMark.last.downColor)}return{title:P,value:T}})},t}(to),Sh=function(s){Y(t,s);function t(e,i){var n=s.call(this,e,i)||this;return n._candleBarView=new qr(n),n._candleAreaView=new vh(n),n._candleHighLowPriceView=new ph(n),n._candleLastPriceLineView=new gh(n),n.addChild(n._candleBarView),n}return t.prototype.updateMainContent=function(e){var i=this.getPane().getChart().getStyles().candle;i.type!==Pt.Area?(this._candleBarView.draw(e),this._candleHighLowPriceView.draw(e),this._candleAreaView.stopAnimation()):this._candleAreaView.draw(e),this._candleLastPriceLineView.draw(e)},t.prototype.createTooltipView=function(){return new bh(this)},t}(io),no=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i=this,n,r,o=this.getWidget(),a=o.getPane(),l=o.getBounding(),h=a.getAxisComponent(),u=this.getAxisStyles(a.getChart().getStyles());if(u.show){u.axisLine.show&&((n=this.createFigure({name:"line",attrs:this.createAxisLine(l,u),styles:u.axisLine}))===null||n===void 0||n.draw(e));var c=h.getTicks();if(u.tickLine.show){var d=this.createTickLines(c,l,u);d.forEach(function(v){var p;(p=i.createFigure({name:"line",attrs:v,styles:u.tickLine}))===null||p===void 0||p.draw(e)})}if(u.tickText.show){var f=this.createTickTexts(c,l,u);(r=this.createFigure({name:"text",attrs:f,styles:u.tickText}))===null||r===void 0||r.draw(e)}}},t}(Xt),xh=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.getAxisStyles=function(e){return e.yAxis},t.prototype.createAxisLine=function(e,i){var n=this.getWidget().getPane().getAxisComponent(),r=i.axisLine.size,o;return n.isFromZero()?o=0:o=e.width-r,{coordinates:[{x:o,y:0},{x:o,y:e.height}]}},t.prototype.createTickLines=function(e,i,n){var r=this.getWidget().getPane().getAxisComponent(),o=n.axisLine,a=n.tickLine,l=0,h=0;return r.isFromZero()?(l=0,o.show&&(l+=o.size),h=l+a.length):(l=i.width,o.show&&(l-=o.size),h=l-a.length),e.map(function(u){return{coordinates:[{x:l,y:u.coord},{x:h,y:u.coord}]}})},t.prototype.createTickTexts=function(e,i,n){var r=this.getWidget().getPane().getAxisComponent(),o=n.axisLine,a=n.tickLine,l=n.tickText,h=0;r.isFromZero()?(h=l.marginStart,o.show&&(h+=o.size),a.show&&(h+=a.length)):(h=i.width-l.marginEnd,o.show&&(h-=o.size),a.show&&(h-=a.length));var u=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return e.map(function(c){return{x:h,y:c.coord,text:c.text,align:u,baseline:"middle"}})},t}(no),Ch=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i,n=this.getWidget(),r=n.getPane(),o=n.getBounding(),a=r.getChart().getChartStore(),l=a.getStyles().candle.priceMark,h=l.last,u=h.text;if(l.show&&h.show&&u.show){var c=a.getPrecision(),d=r.getAxisComponent(),f=a.getDataList(),v=f[f.length-1];if(k(v)){var p=v.close,g=v.open,m=d.convertToNicePixel(p),_=void 0;p>g?_=h.upColor:p<g?_=h.downColor:_=h.noChangeColor;var w=void 0;if(d.getType()===vt.Percentage){var y=a.getVisibleFirstData(),x=y.close;w="".concat(((p-x)/x*100).toFixed(2),"%")}else w=ut(p,c.price);w=ft(ct(w,a.getThousandsSeparator()),a.getDecimalFoldThreshold());var M=void 0,b=void 0;d.isFromZero()?(M=0,b="left"):(M=o.width,b="right"),(i=this.createFigure({name:"text",attrs:{x:M,y:m,text:w,align:b,baseline:"middle"},styles:N(N({},u),{backgroundColor:_})}))===null||i===void 0||i.draw(e)}}},t}(Xt),Mh=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i=this,n=this.getWidget(),r=n.getPane(),o=n.getBounding(),a=r.getChart().getChartStore(),l=a.getCustomApi(),h=a.getStyles().indicator,u=h.lastValueMark,c=u.text;if(u.show){var d=r.getAxisComponent(),f=a.getDataList(),v=f.length-1,p=a.getIndicatorStore().getInstances(r.getId()),g=a.getThousandsSeparator(),m=a.getDecimalFoldThreshold();p.forEach(function(_){var w=_.result,y=w[v];if(k(y)&&_.visible){var x=_.precision;Un(f,_,v,h,function(M,b){var S,C=y[M.key];if(V(C)){var E=d.convertToNicePixel(C),I=ut(C,x);_.shouldFormatBigNumber&&(I=l.formatBigNumber(I)),I=ft(ct(I,g),m);var P=void 0,T=void 0;d.isFromZero()?(P=0,T="left"):(P=o.width,T="right"),(S=i.createFigure({name:"text",attrs:{x:P,y:E,text:I,align:T,baseline:"middle"},styles:N(N({},c),{backgroundColor:b.color})}))===null||S===void 0||S.draw(e)}})}})}},t}(Xt),so=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},t.prototype.drawDefaultFigures=function(e,i,n,r,o,a,l,h,u,c,d,f,v,p){this.drawFigures(e,i,this.getDefaultFigures(i,n,r,o,a,l,h,u,d,f,p),c)},t.prototype.getDefaultFigures=function(e,i,n,r,o,a,l,h,u,c,d){var f,v,p=[];if(e.needDefaultYAxisFigure&&e.id===((f=d.instance)===null||f===void 0?void 0:f.id)&&d.paneId===this.getWidget().getPane().getId()){var g=Number.MAX_SAFE_INTEGER,m=Number.MIN_SAFE_INTEGER,_=(v=c==null?void 0:c.isFromZero())!==null&&v!==void 0?v:!1,w,y;_?(w="left",y=0):(w="right",y=n.width),i.forEach(function(x,M){var b=e.points[M];if(V(b.value)){g=Math.min(g,x.y),m=Math.max(m,x.y);var S=ft(ct(ut(b.value,r.price),l),h);p.push({type:"text",attrs:{x:y,y:x.y,text:S,align:w,baseline:"middle"},ignoreEvent:!0})}}),i.length>1&&p.unshift({type:"rect",attrs:{x:0,y:g,width:n.width,height:m-g},ignoreEvent:!0})}return p},t.prototype.getFigures=function(e,i,n,r,o,a,l,h,u,c,d){var f,v;return(v=(f=e.createYAxisFigures)===null||f===void 0?void 0:f.call(e,{overlay:e,coordinates:i,bounding:n,barSpace:r,precision:o,thousandsSeparator:a,decimalFoldThreshold:l,dateTimeFormat:h,defaultStyles:u,xAxis:c,yAxis:d}))!==null&&v!==void 0?v:[]},t}(eo),ro=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i,n=this.getWidget(),r=n.getPane(),o=n.getBounding(),a=n.getPane().getChart().getChartStore(),l=a.getTooltipStore().getCrosshair(),h=a.getStyles().crosshair;if(O(l.paneId)&&this.compare(l,r.getId())&&h.show){var u=this.getDirectionStyles(h),c=u.text;if(u.show&&c.show){var d=r.getAxisComponent(),f=this.getText(l,a,d);e.font=Se(c.size,c.weight,c.family),(i=this.createFigure({name:"text",attrs:this.getTextAttrs(f,e.measureText(f).width,l,o,d,c),styles:c}))===null||i===void 0||i.draw(e)}}},t.prototype.compare=function(e,i){return e.paneId===i},t.prototype.getDirectionStyles=function(e){return e.horizontal},t.prototype.getText=function(e,i,n){var r=n,o=n.convertFromPixel(e.y),a;if(r.getType()===vt.Percentage){var l=i.getVisibleFirstData();a="".concat(((o-l.close)/l.close*100).toFixed(2),"%")}else{var h=i.getIndicatorStore().getInstances(e.paneId),u=0,c=!1;r.isInCandle()?u=i.getPrecision().price:h.forEach(function(d){u=Math.max(d.precision,u),c||(c=d.shouldFormatBigNumber)}),a=ut(o,u),c&&(a=i.getCustomApi().formatBigNumber(a))}return ft(ct(a,i.getThousandsSeparator()),i.getDecimalFoldThreshold())},t.prototype.getTextAttrs=function(e,i,n,r,o,a){var l=o,h,u;return l.isFromZero()?(h=0,u="left"):(h=r.width,u="right"),{x:h,y:n.y,text:e,align:u,baseline:"middle"}},t}(Xt),Eh=function(s){Y(t,s);function t(e,i){var n=s.call(this,e,i)||this;return n._yAxisView=new xh(n),n._candleLastPriceLabelView=new Ch(n),n._indicatorLastValueView=new Mh(n),n._overlayYAxisView=new so(n),n._crosshairHorizontalLabelView=new ro(n),n.getContainer().style.cursor="ns-resize",n.addChild(n._overlayYAxisView),n}return t.prototype.getName=function(){return $.Y_AXIS},t.prototype.updateMain=function(e){this._yAxisView.draw(e),this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(e),this._indicatorLastValueView.draw(e)},t.prototype.updateOverlay=function(e){this._overlayYAxisView.draw(e),this._crosshairHorizontalLabelView.draw(e)},t}(Kn),oo=function(){function s(t){this._range={from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0},this._prevRange={from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=t}return s.prototype.getParent=function(){return this._parent},s.prototype.buildTicks=function(t){if(this._autoCalcTickFlag&&(this._range=this.calcRange()),this._prevRange.from!==this._range.from||this._prevRange.to!==this._range.to||t){this._prevRange=this._range;var e=this.optimalTicks(this._calcTicks());return this._ticks=this.createTicks({range:this._range,bounding:this.getSelfBounding(),defaultTicks:e}),!0}return!1},s.prototype.getTicks=function(){return this._ticks},s.prototype.getScrollZoomEnabled=function(){var t;return(t=this.getParent().getOptions().axisOptions.scrollZoomEnabled)!==null&&t!==void 0?t:!0},s.prototype.setRange=function(t){this._autoCalcTickFlag=!1,this._range=t},s.prototype.getRange=function(){return this._range},s.prototype.setAutoCalcTickFlag=function(t){this._autoCalcTickFlag=t},s.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},s.prototype._calcTicks=function(){var t=this._range,e=t.realFrom,i=t.realTo,n=t.realRange,r=[];if(n>=0){var o=Ee(this._calcTickInterval(n),2),a=o[0],l=o[1],h=Cs(Math.ceil(e/a)*a,l),u=Cs(Math.floor(i/a)*a,l),c=0,d=h;if(a!==0)for(;d<=u;){var f=d.toFixed(l);r[c]={text:f,coord:0,value:f},++c,d+=a}}return r},s.prototype._calcTickInterval=function(t){var e=Fa(t/8),i=Ba(e);return[e,i]},s}(),Ph=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.calcRange=function(){var e,i,n,r,o=this.getParent(),a=o.getChart(),l=a.getChartStore(),h=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER,c=[],d=!1,f=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER,p=Number.MAX_SAFE_INTEGER,g=l.getIndicatorStore().getInstances(o.getId());g.forEach(function(Z){var at,st,tt;d||(d=(at=Z.shouldOhlc)!==null&&at!==void 0?at:!1),p=Math.min(p,Z.precision),V(Z.minValue)&&(f=Math.min(f,Z.minValue)),V(Z.maxValue)&&(v=Math.max(v,Z.maxValue)),c.push({figures:(st=Z.figures)!==null&&st!==void 0?st:[],result:(tt=Z.result)!==null&&tt!==void 0?tt:[]})});var m=4,_=this.isInCandle();if(_){var w=l.getPrecision().price;p!==Number.MAX_SAFE_INTEGER?m=Math.min(p,w):m=w}else p!==Number.MAX_SAFE_INTEGER&&(m=p);var y=l.getVisibleDataList(),x=a.getStyles().candle,M=x.type===Pt.Area,b=x.area.value,S=_&&!M||!_&&d;y.forEach(function(Z){var at=Z.dataIndex,st=Z.data;if(k(st)&&(S&&(h=Math.min(h,st.low),u=Math.max(u,st.high)),_&&M)){var tt=st[b];V(tt)&&(h=Math.min(h,tt),u=Math.max(u,tt))}c.forEach(function(ht){var Bt,Dt=ht.figures,qt=ht.result,te=(Bt=qt[at])!==null&&Bt!==void 0?Bt:{};Dt.forEach(function(he){var Vt=te[he.key];V(Vt)&&(h=Math.min(h,Vt),u=Math.max(u,Vt))})})}),h!==Number.MAX_SAFE_INTEGER&&u!==Number.MIN_SAFE_INTEGER?(h=Math.min(f,h),u=Math.max(v,u)):(h=0,u=10);var C=this.getType(),E;switch(C){case vt.Percentage:{var I=l.getVisibleFirstData();k(I)&&V(I.close)&&(h=(h-I.close)/I.close*100,u=(u-I.close)/I.close*100),E=Math.pow(10,-2);break}case vt.Log:{h=ii(h),u=ii(u),E=.05*fe(-m);break}default:E=fe(-m)}if(h===u||Math.abs(h-u)<E){var P=f===h,T=v===u;h=P?h:T?h-8*E:h-4*E,u=T?u:P?u+8*E:u+4*E}var R=(i=(e=this.getParent().getYAxisWidget())===null||e===void 0?void 0:e.getBounding().height)!==null&&i!==void 0?i:0,L=o.getOptions().gap,F=(n=L==null?void 0:L.top)!==null&&n!==void 0?n:.2;F>=1&&(F=F/R);var X=(r=L==null?void 0:L.bottom)!==null&&r!==void 0?r:.1;X>=1&&(X=X/R);var W=Math.abs(u-h);h=h-W*X,u=u+W*F,W=Math.abs(u-h);var et,nt,J;return C===vt.Log?(et=fe(h),nt=fe(u),J=Math.abs(nt-et)):(et=h,nt=u,J=W),{from:h,to:u,range:W,realFrom:et,realTo:nt,realRange:J}},t.prototype._innerConvertToPixel=function(e){var i,n,r=(n=(i=this.getParent().getYAxisWidget())===null||i===void 0?void 0:i.getBounding().height)!==null&&n!==void 0?n:0,o=this.getRange(),a=o.from,l=o.range,h=(e-a)/l;return this.isReverse()?Math.round(h*r):Math.round((1-h)*r)},t.prototype.isInCandle=function(){return this.getParent().getId()===j.CANDLE},t.prototype.getType=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.type:vt.Normal},t.prototype.getPosition=function(){return this.getParent().getChart().getStyles().yAxis.position},t.prototype.isReverse=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.reverse:!1},t.prototype.isFromZero=function(){var e=this.getParent().getChart().getStyles().yAxis,i=e.inside;return e.position===le.Left&&i||e.position===le.Right&&!i},t.prototype.optimalTicks=function(e){var i=this,n,r,o=this.getParent(),a=(r=(n=o.getYAxisWidget())===null||n===void 0?void 0:n.getBounding().height)!==null&&r!==void 0?r:0,l=o.getChart().getChartStore(),h=l.getCustomApi(),u=[],c=this.getType(),d=l.getIndicatorStore().getInstances(o.getId()),f=l.getThousandsSeparator(),v=l.getDecimalFoldThreshold(),p=0,g=!1;this.isInCandle()?p=l.getPrecision().price:d.forEach(function(w){p=Math.max(p,w.precision),g||(g=w.shouldFormatBigNumber)});var m=l.getStyles().xAxis.tickText.size,_;return e.forEach(function(w){var y=w.value,x,M=i._innerConvertToPixel(+y);switch(c){case vt.Percentage:{x="".concat(ut(y,2),"%");break}case vt.Log:{M=i._innerConvertToPixel(ii(+y)),x=ut(y,p);break}default:{x=ut(y,p),g&&(x=h.formatBigNumber(y));break}}x=ft(ct(x,f),v);var b=V(_);M>m&&M<a-m&&(b&&Math.abs(_-M)>m*2||!b)&&(u.push({text:x,coord:M,value:y}),_=M)}),u},t.prototype.getAutoSize=function(){var e=this.getParent(),i=e.getChart(),n=i.getStyles(),r=n.yAxis,o=r.size;if(o!=="auto")return o;var a=i.getChartStore(),l=a.getCustomApi(),h=0;if(r.show&&(r.axisLine.show&&(h+=r.axisLine.size),r.tickLine.show&&(h+=r.tickLine.length),r.tickText.show)){var u=0;this.getTicks().forEach(function(y){u=Math.max(u,Ai(y.text,r.tickText.size,r.tickText.weight,r.tickText.family))}),h+=r.tickText.marginStart+r.tickText.marginEnd+u}var c=n.crosshair,d=0;if(c.show&&c.horizontal.show&&c.horizontal.text.show){var f=a.getIndicatorStore().getInstances(e.getId()),v=0,p=!1;f.forEach(function(y){v=Math.max(y.precision,v),p||(p=y.shouldFormatBigNumber)});var g=2;if(this.getType()!==vt.Percentage)if(this.isInCandle()){var m=a.getPrecision().price,_=n.indicator.lastValueMark;_.show&&_.text.show?g=Math.max(v,m):g=m}else g=v;var w=ut(this.getRange().to,g);p&&(w=l.formatBigNumber(w)),w=ft(w,a.getDecimalFoldThreshold()),d+=c.horizontal.text.paddingLeft+c.horizontal.text.paddingRight+c.horizontal.text.borderSize*2+Ai(w,c.horizontal.text.size,c.horizontal.text.weight,c.horizontal.text.family)}return Math.max(h,d)},t.prototype.getSelfBounding=function(){return this.getParent().getYAxisWidget().getBounding()},t.prototype.convertFromPixel=function(e){var i,n,r=(n=(i=this.getParent().getYAxisWidget())===null||i===void 0?void 0:i.getBounding().height)!==null&&n!==void 0?n:0,o=this.getRange(),a=o.from,l=o.range,h=this.isReverse()?e/r:1-e/r,u=h*l+a;switch(this.getType()){case vt.Percentage:{var c=this.getParent().getChart().getChartStore().getVisibleFirstData();return k(c)&&V(c.close)?c.close*u/100+c.close:0}case vt.Log:return fe(u);default:return u}},t.prototype.convertToRealValue=function(e){var i=e;return this.getType()===vt.Log&&(i=fe(e)),i},t.prototype.convertToPixel=function(e){var i=e;switch(this.getType()){case vt.Percentage:{var n=this.getParent().getChart().getChartStore().getVisibleFirstData();k(n)&&V(n.close)&&(i=(e-n.close)/n.close*100);break}case vt.Log:{i=ii(e);break}default:i=e}return this._innerConvertToPixel(i)},t.prototype.convertToNicePixel=function(e){var i,n,r=(n=(i=this.getParent().getYAxisWidget())===null||i===void 0?void 0:i.getBounding().height)!==null&&n!==void 0?n:0,o=this.convertToPixel(e);return Math.round(Math.max(r*.05,Math.min(o,r*.98)))},t.extend=function(e){var i=function(n){Y(r,n);function r(){return n!==null&&n.apply(this,arguments)||this}return r.prototype.createTicks=function(o){return e.createTicks(o)},r}(t);return i},t}(oo),Ih={name:"default",createTicks:function(s){var t=s.defaultTicks;return t}},Ts={default:Ph.extend(Ih)};function Th(s){var t;return(t=Ts[s])!==null&&t!==void 0?t:Ts.default}var ao=function(){function s(t,e,i,n){this._bounding=jr(),this._chart=i,this._id=n,this._init(t,e)}return s.prototype._init=function(t,e){this._rootContainer=t,this._container=Kt("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"}),e!==null?t.insertBefore(this._container,e):t.appendChild(this._container)},s.prototype.getContainer=function(){return this._container},s.prototype.getId=function(){return this._id},s.prototype.getChart=function(){return this._chart},s.prototype.getBounding=function(){return this._bounding},s.prototype.update=function(t){this._bounding.height!==this._container.clientHeight&&(this._container.style.height="".concat(this._bounding.height,"px")),this.updateImp(t??3,this._container,this._bounding)},s.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},s}(),lo=function(s){Y(t,s);function t(e,i,n,r,o){var a=s.call(this,e,i,n,r)||this;a._yAxisWidget=null,a._options={minHeight:zl,dragEnabled:!0,gap:{top:.2,bottom:.1},axisOptions:{name:"default",scrollZoomEnabled:!0}};var l=a.getContainer();return a._mainWidget=a.createMainWidget(l),a._yAxisWidget=a.createYAxisWidget(l),a.setOptions(o),a}return t.prototype.setOptions=function(e){var i,n,r,o=(i=e.axisOptions)===null||i===void 0?void 0:i.name;(this._options.axisOptions.name!==o&&O(o)||!k(this._axis))&&(this._axis=this.createAxisComponent(o??"default")),kt(this._options,e);var a,l;return this.getId()===j.X_AXIS?(a=this.getMainWidget().getContainer(),l="ew-resize"):(a=this.getYAxisWidget().getContainer(),l="ns-resize"),!((r=(n=e.axisOptions)===null||n===void 0?void 0:n.scrollZoomEnabled)!==null&&r!==void 0)||r?a.style.cursor=l:a.style.cursor="default",this},t.prototype.getOptions=function(){return this._options},t.prototype.getAxisComponent=function(){return this._axis},t.prototype.setBounding=function(e,i,n){var r,o;kt(this.getBounding(),e);var a={};return k(e.height)&&(a.height=e.height),k(e.top)&&(a.top=e.top),this._mainWidget.setBounding(a),(r=this._yAxisWidget)===null||r===void 0||r.setBounding(a),k(i)&&this._mainWidget.setBounding(i),k(n)&&((o=this._yAxisWidget)===null||o===void 0||o.setBounding(n)),this},t.prototype.getMainWidget=function(){return this._mainWidget},t.prototype.getYAxisWidget=function(){return this._yAxisWidget},t.prototype.updateImp=function(e){var i;this._mainWidget.update(e),(i=this._yAxisWidget)===null||i===void 0||i.update(e)},t.prototype.destroy=function(){var e;s.prototype.destroy.call(this),this._mainWidget.destroy(),(e=this._yAxisWidget)===null||e===void 0||e.destroy()},t.prototype.getImage=function(e){var i=this.getBounding(),n=i.width,r=i.height,o=Kt("canvas",{width:"".concat(n,"px"),height:"".concat(r,"px"),boxSizing:"border-box"}),a=o.getContext("2d"),l=ae(o);o.width=n*l,o.height=r*l,a.scale(l,l);var h=this._mainWidget.getBounding();if(a.drawImage(this._mainWidget.getImage(e),h.left,0,h.width,h.height),this._yAxisWidget!==null){var u=this._yAxisWidget.getBounding();a.drawImage(this._yAxisWidget.getImage(e),u.left,0,u.width,u.height)}return o},t.prototype.createYAxisWidget=function(e){return null},t}(ao),ho=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.createAxisComponent=function(e){var i=Th(e??"default");return new i(this)},t.prototype.createMainWidget=function(e){return new io(e,this)},t.prototype.createYAxisWidget=function(e){return new Eh(e,this)},t}(lo),kh=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.createMainWidget=function(e){return new Sh(e,this)},t}(ho),Dh=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.getAxisStyles=function(e){return e.xAxis},t.prototype.createAxisLine=function(e){return{coordinates:[{x:0,y:0},{x:e.width,y:0}]}},t.prototype.createTickLines=function(e,i,n){var r=n.tickLine,o=n.axisLine.size;return e.map(function(a){return{coordinates:[{x:a.coord,y:0},{x:a.coord,y:o+r.length}]}})},t.prototype.createTickTexts=function(e,i,n){var r=n.tickText,o=n.axisLine.size,a=n.tickLine.length;return e.map(function(l){return{x:l.coord,y:o+a+r.marginStart,text:l.text,align:"center",baseline:"top"}})},t}(no),Ah=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},t.prototype.coordinateToPointValueFlag=function(){return!1},t.prototype.getCompleteOverlays=function(e){return e.getInstances()},t.prototype.getProgressOverlay=function(e){return e.instance},t.prototype.getDefaultFigures=function(e,i,n,r,o,a,l,h,u,c,d){var f,v=[];if(e.needDefaultXAxisFigure&&e.id===((f=d.instance)===null||f===void 0?void 0:f.id)){var p=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;i.forEach(function(m,_){p=Math.min(p,m.x),g=Math.max(g,m.x);var w=e.points[_];if(V(w.timestamp)){var y=a.formatDate(o,w.timestamp,"YYYY-MM-DD HH:mm",mt.Crosshair);v.push({type:"text",attrs:{x:m.x,y:0,text:y,align:"center"},ignoreEvent:!0})}}),i.length>1&&v.unshift({type:"rect",attrs:{x:p,y:0,width:g-p,height:n.height},ignoreEvent:!0})}return v},t.prototype.getFigures=function(e,i,n,r,o,a,l,h,u,c,d){var f,v;return(v=(f=e.createXAxisFigures)===null||f===void 0?void 0:f.call(e,{overlay:e,coordinates:i,bounding:n,barSpace:r,precision:o,thousandsSeparator:a,decimalFoldThreshold:l,dateTimeFormat:h,defaultStyles:u,xAxis:c,yAxis:d}))!==null&&v!==void 0?v:[]},t}(so),Rh=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.compare=function(e){return k(e.kLineData)&&e.dataIndex===e.realDataIndex},t.prototype.getDirectionStyles=function(e){return e.vertical},t.prototype.getText=function(e,i){var n,r=(n=e.kLineData)===null||n===void 0?void 0:n.timestamp;return i.getCustomApi().formatDate(i.getTimeScaleStore().getDateTimeFormat(),r,"YYYY-MM-DD HH:mm",mt.Crosshair)},t.prototype.getTextAttrs=function(e,i,n,r,o,a){var l=n.realX,h,u="center";return l-i/2-a.paddingLeft<0?(h=0,u="left"):l+i/2+a.paddingRight>r.width?(h=r.width,u="right"):h=l,{x:h,y:0,text:e,align:u,baseline:"top"}},t}(ro),Fh=function(s){Y(t,s);function t(e,i){var n=s.call(this,e,i)||this;return n._xAxisView=new Dh(n),n._overlayXAxisView=new Ah(n),n._crosshairVerticalLabelView=new Rh(n),n.getContainer().style.cursor="ew-resize",n.addChild(n._overlayXAxisView),n}return t.prototype.getName=function(){return $.X_AXIS},t.prototype.updateMain=function(e){this._xAxisView.draw(e)},t.prototype.updateOverlay=function(e){this._overlayXAxisView.draw(e),this._crosshairVerticalLabelView.draw(e)},t}(Kn),Bh=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.calcRange=function(){var e=this.getParent().getChart().getChartStore(),i=e.getTimeScaleStore().getVisibleRange(),n=i.from,r=i.to,o=n,a=r-1,l=r-n;return{from:o,to:a,range:l,realFrom:o,realTo:a,realRange:l}},t.prototype.optimalTicks=function(e){var i,n,r=this.getParent().getChart(),o=r.getChartStore(),a=o.getCustomApi().formatDate,l=[],h=e.length,u=o.getDataList();if(h>0){var c=o.getTimeScaleStore().getDateTimeFormat(),d=r.getStyles().xAxis.tickText,f=Ai("00-00 00:00",d.size,d.weight,d.family),v=parseInt(e[0].value,10),p=this.convertToPixel(v),g=1;if(h>1){var m=parseInt(e[1].value,10),_=this.convertToPixel(m),w=Math.abs(_-p);w<f&&(g=Math.ceil(f/w))}for(var y=0;y<h;y+=g){var x=parseInt(e[y].value,10),M=u[x],b=M.timestamp,S=a(c,b,"HH:mm",mt.XAxis);if(y!==0){var C=parseInt(e[y-g].value,10),E=u[C],I=E.timestamp;S=(i=this._optimalTickLabel(a,c,b,I))!==null&&i!==void 0?i:S}var P=this.convertToPixel(x);l.push({text:S,coord:P,value:b})}var T=l.length;if(T===1)l[0].text=a(c,l[0].value,"YYYY-MM-DD HH:mm",mt.XAxis);else{var R=l[0].value,L=l[1].value;if(k(l[2])){var F=l[2].text;/^[0-9]{2}-[0-9]{2}$/.test(F)?l[0].text=a(c,R,"MM-DD",mt.XAxis):/^[0-9]{4}-[0-9]{2}$/.test(F)?l[0].text=a(c,R,"YYYY-MM",mt.XAxis):/^[0-9]{4}$/.test(F)&&(l[0].text=a(c,R,"YYYY",mt.XAxis))}else l[0].text=(n=this._optimalTickLabel(a,c,R,L))!==null&&n!==void 0?n:l[0].text}}return l},t.prototype._optimalTickLabel=function(e,i,n,r){var o=e(i,n,"YYYY",mt.XAxis),a=e(i,n,"YYYY-MM",mt.XAxis),l=e(i,n,"MM-DD",mt.XAxis);return o!==e(i,r,"YYYY",mt.XAxis)?o:a!==e(i,r,"YYYY-MM",mt.XAxis)?a:l!==e(i,r,"MM-DD",mt.XAxis)?l:null},t.prototype.getAutoSize=function(){var e=this.getParent().getChart().getStyles(),i=e.xAxis,n=i.size;if(n!=="auto")return n;var r=e.crosshair,o=0;i.show&&(i.axisLine.show&&(o+=i.axisLine.size),i.tickLine.show&&(o+=i.tickLine.length),i.tickText.show&&(o+=i.tickText.marginStart+i.tickText.marginEnd+i.tickText.size));var a=0;return r.show&&r.vertical.show&&r.vertical.text.show&&(a+=r.vertical.text.paddingTop+r.vertical.text.paddingBottom+r.vertical.text.borderSize*2+r.vertical.text.size),Math.max(o,a)},t.prototype.getSelfBounding=function(){return this.getParent().getMainWidget().getBounding()},t.prototype.convertTimestampFromPixel=function(e){var i=this.getParent().getChart().getChartStore().getTimeScaleStore(),n=i.coordinateToDataIndex(e);return i.dataIndexToTimestamp(n)},t.prototype.convertTimestampToPixel=function(e){var i=this.getParent().getChart().getChartStore().getTimeScaleStore(),n=i.timestampToDataIndex(e);return i.dataIndexToCoordinate(n)},t.prototype.convertFromPixel=function(e){return this.getParent().getChart().getChartStore().getTimeScaleStore().coordinateToDataIndex(e)},t.prototype.convertToPixel=function(e){return this.getParent().getChart().getChartStore().getTimeScaleStore().dataIndexToCoordinate(e)},t.extend=function(e){var i=function(n){Y(r,n);function r(){return n!==null&&n.apply(this,arguments)||this}return r.prototype.createTicks=function(o){return e.createTicks(o)},r}(t);return i},t}(oo),Vh={name:"default",createTicks:function(s){var t=s.defaultTicks;return t}},ks={default:Bh.extend(Vh)};function Lh(s){var t;return(t=ks[s])!==null&&t!==void 0?t:ks.default}var Nh=function(s){Y(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.createAxisComponent=function(e){var i=Lh(e);return new i(this)},t.prototype.createMainWidget=function(e){return new Fh(e,this)},t}(lo);function zh(s,t){var e=0;return function(){var i=Date.now();i-e>t&&(s.apply(this,arguments),e=i)}}var Oh=function(s){Y(t,s);function t(e,i){var n=s.call(this,e,i)||this;return n._dragFlag=!1,n._dragStartY=0,n._topPaneHeight=0,n._bottomPaneHeight=0,n._pressedMouseMoveEvent=zh(n._pressedTouchMouseMoveEvent,20),n.registerEvent("touchStartEvent",n._mouseDownEvent.bind(n)).registerEvent("touchMoveEvent",n._pressedMouseMoveEvent.bind(n)).registerEvent("touchEndEvent",n._mouseUpEvent.bind(n)).registerEvent("mouseDownEvent",n._mouseDownEvent.bind(n)).registerEvent("mouseUpEvent",n._mouseUpEvent.bind(n)).registerEvent("pressedMouseMoveEvent",n._pressedMouseMoveEvent.bind(n)).registerEvent("mouseEnterEvent",n._mouseEnterEvent.bind(n)).registerEvent("mouseLeaveEvent",n._mouseLeaveEvent.bind(n)),n}return t.prototype.getName=function(){return $.SEPARATOR},t.prototype.checkEventOn=function(){return!0},t.prototype._mouseDownEvent=function(e){this._dragFlag=!0,this._dragStartY=e.pageY;var i=this.getPane();return this._topPaneHeight=i.getTopPane().getBounding().height,this._bottomPaneHeight=i.getBottomPane().getBounding().height,!0},t.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._mouseLeaveEvent()},t.prototype._pressedTouchMouseMoveEvent=function(e){var i=e.pageY-this._dragStartY,n=this.getPane(),r=n.getTopPane(),o=n.getBottomPane(),a=i<0;if(r!==null&&(o!=null&&o.getOptions().dragEnabled)){var l=void 0,h=void 0,u=void 0,c=void 0;a?(l=r,h=o,u=this._topPaneHeight,c=this._bottomPaneHeight):(l=o,h=r,u=this._bottomPaneHeight,c=this._topPaneHeight);var d=l.getOptions().minHeight;if(u>d){var f=Math.max(u-Math.abs(i),d),v=u-f;l.setBounding({height:f}),h.setBounding({height:c+v});var p=n.getChart();p.getChartStore().getActionStore().execute(Tt.OnPaneDrag,{paneId:n.getId()}),p.adjustPaneViewport(!0,!0,!0,!0,!0)}}return!0},t.prototype._mouseEnterEvent=function(){var e,i=this.getPane(),n=i.getBottomPane();if((e=n==null?void 0:n.getOptions().dragEnabled)!==null&&e!==void 0&&e){var r=i.getChart(),o=r.getStyles().separator;return this.getContainer().style.background=o.activeBackgroundColor,!0}return!1},t.prototype._mouseLeaveEvent=function(){return this._dragFlag?!1:(this.getContainer().style.background="",!0)},t.prototype.createContainer=function(){return Kt("div",{width:"100%",height:"".concat(si,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"})},t.prototype.updateImp=function(e,i,n){if(n===4||n===2){var r=this.getPane().getChart().getStyles().separator;e.style.top="".concat(-Math.floor((si-r.size)/2),"px"),e.style.height="".concat(si,"px")}},t}(Gr),Ds=function(s){Y(t,s);function t(e,i,n,r,o,a){var l=s.call(this,e,i,n,r)||this;return l.getContainer().style.overflow="",l._topPane=o,l._bottomPane=a,l._separatorWidget=new Oh(l.getContainer(),l),l}return t.prototype.setBounding=function(e){return kt(this.getBounding(),e),this},t.prototype.getTopPane=function(){return this._topPane},t.prototype.setTopPane=function(e){return this._topPane=e,this},t.prototype.getBottomPane=function(){return this._bottomPane},t.prototype.setBottomPane=function(e){return this._bottomPane=e,this},t.prototype.getWidget=function(){return this._separatorWidget},t.prototype.getImage=function(e){var i=this.getBounding(),n=i.width,r=i.height,o=this.getChart().getStyles().separator,a=Kt("canvas",{width:"".concat(n,"px"),height:"".concat(r,"px"),boxSizing:"border-box"}),l=a.getContext("2d"),h=ae(a);return a.width=n*h,a.height=r*h,l.scale(h,h),l.fillStyle=o.color,l.fillRect(0,0,n,r),a},t.prototype.updateImp=function(e,i,n){if(e===4||e===2){var r=this.getChart().getStyles().separator;i.style.backgroundColor=r.color,i.style.height="".concat(n.height,"px"),i.style.marginLeft="".concat(n.left,"px"),i.style.width="".concat(n.width,"px"),this._separatorWidget.update(e)}},t}(ao);function As(){var s;return typeof window>"u"?!1:((s=window.navigator.userAgent.toLowerCase().indexOf("firefox"))!==null&&s!==void 0?s:-1)>-1}function dn(){return typeof window>"u"?!1:/iPhone|iPad|iPod/.test(window.navigator.platform)}var Wh=10,Yh=function(){function s(t,e,i){var n=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!dn(),this._onFirefoxOutsideMouseUp=function(r){n._mouseUpHandler(r)},this._onMobileSafariDoubleClick=function(r){if(n._firesTouchEvents(r)){if(++n._tapCount,n._tapTimeoutId!==null&&n._tapCount>1){var o=n._mouseTouchMoveWithDownInfo(n._getCoordinate(r),n._tapCoordinate).manhattanDistance;o<30&&!n._cancelTap&&n._processEvent(n._makeCompatEvent(r),n._handler.doubleTapEvent),n._resetTapTimeout()}}else if(++n._clickCount,n._clickTimeoutId!==null&&n._clickCount>1){var o=n._mouseTouchMoveWithDownInfo(n._getCoordinate(r),n._clickCoordinate).manhattanDistance;o<5&&!n._cancelClick&&n._processEvent(n._makeCompatEvent(r),n._handler.mouseDoubleClickEvent),n._resetClickTimeout()}},this._target=t,this._handler=e,this._options=i,this._init()}return s.prototype.destroy=function(){this._unsubscribeOutsideMouseEvents!==null&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),this._unsubscribeOutsideTouchEvents!==null&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),this._unsubscribeMousemove!==null&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),this._unsubscribeMouseWheel!==null&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),this._unsubscribeContextMenu!==null&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),this._unsubscribeMobileSafariEvents!==null&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},s.prototype._mouseEnterHandler=function(t){var e=this,i,n,r;(i=this._unsubscribeMousemove)===null||i===void 0||i.call(this),(n=this._unsubscribeMouseWheel)===null||n===void 0||n.call(this),(r=this._unsubscribeContextMenu)===null||r===void 0||r.call(this);var o=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){e._target.removeEventListener("mousemove",o)},this._target.addEventListener("mousemove",o);var a=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){e._target.removeEventListener("wheel",a)},this._target.addEventListener("wheel",a,{passive:!1});var l=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){e._target.removeEventListener("contextmenu",l)},this._target.addEventListener("contextmenu",l,{passive:!1}),!this._firesTouchEvents(t)&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},s.prototype._resetClickTimeout=function(){this._clickTimeoutId!==null&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},s.prototype._resetTapTimeout=function(){this._tapTimeoutId!==null&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},s.prototype._mouseMoveHandler=function(t){this._mousePressed||this._touchMoveStartCoordinate!==null||this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},s.prototype._mouseWheelHandler=function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(!k(this._handler.mouseWheelHortEvent)||(this._preventDefault(t),Math.abs(t.deltaX)===0))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(t),-t.deltaX)}else{if(!k(this._handler.mouseWheelVertEvent))return;var e=-(t.deltaY/100);if(e===0)return;switch(this._preventDefault(t),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32;break}if(e!==0){var i=Math.sign(e)*Math.min(1,Math.abs(e));this._handler.mouseWheelVertEvent(this._makeCompatEvent(t),i)}}},s.prototype._contextMenuHandler=function(t){this._preventDefault(t)},s.prototype._touchMoveHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(e!==null&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._startPinchMiddleCoordinate===null&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var i=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._touchMoveStartCoordinate),n=i.xOffset,r=i.yOffset,o=i.manhattanDistance;if(!(!this._touchMoveExceededManhattanDistance&&o<5)){if(!this._touchMoveExceededManhattanDistance){var a=n*.5,l=r>=a&&!this._options.treatVertDragAsPageScroll(),h=a>r&&!this._options.treatHorzDragAsPageScroll();!l&&!h&&(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(t,e),this._handler.touchMoveEvent)}}},s.prototype._mouseMoveWithDownHandler=function(t){if(t.button===0){var e=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._mouseMoveStartCoordinate),i=e.manhattanDistance;i>=5&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(t),this._handler.pressedMouseMoveEvent)}},s.prototype._mouseTouchMoveWithDownInfo=function(t,e){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y),r=i+n;return{xOffset:i,yOffset:n,manhattanDistance:r}},s.prototype._touchEndHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e!==null){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var i=this._makeCompatEvent(t,e);if(this._processEvent(i,this._handler.touchEndEvent),++this._tapCount,this._tapTimeoutId!==null&&this._tapCount>1){var n=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate).manhattanDistance;n<30&&!this._cancelTap&&this._processEvent(i,this._handler.doubleTapEvent),this._resetTapTimeout()}else this._cancelTap||(this._processEvent(i,this._handler.tapEvent),k(this._handler.tapEvent)&&this._preventDefault(t));this._tapCount===0&&this._preventDefault(t),t.touches.length===0&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(t))}},s.prototype._mouseUpHandler=function(t){if(t.button===0){var e=this._makeCompatEvent(t);if(this._mouseMoveStartCoordinate=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),As()){var i=this._target.ownerDocument.documentElement;i.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp)}if(!this._firesTouchEvents(t))if(this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId!==null&&this._clickCount>1){var n=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._clickCoordinate).manhattanDistance;n<5&&!this._cancelClick&&this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()}else this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent)}},s.prototype._clearLongTapTimeout=function(){this._longTapTimeoutId!==null&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},s.prototype._touchStartHandler=function(t){if(this._activeTouchId===null){var e=t.changedTouches[0];this._activeTouchId=e.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(t);var i=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(e),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);{var n=this._touchMoveHandler.bind(this),r=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){i.removeEventListener("touchmove",n),i.removeEventListener("touchend",r)},i.addEventListener("touchmove",n,{passive:!1}),i.addEventListener("touchend",r,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),500)}this._processEvent(this._makeCompatEvent(t,e),this._handler.touchStartEvent),this._tapTimeoutId===null&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(e))}},s.prototype._mouseDownHandler=function(t){if(t.button===2){this._preventDefault(t),this._processEvent(this._makeCompatEvent(t),this._handler.mouseRightClickEvent);return}if(t.button===0){var e=this._target.ownerDocument.documentElement;As()&&e.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(t),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);{var i=this._mouseMoveWithDownHandler.bind(this),n=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){e.removeEventListener("mousemove",i),e.removeEventListener("mouseup",n)},e.addEventListener("mousemove",i),e.addEventListener("mouseup",n)}this._mousePressed=!0,!this._firesTouchEvents(t)&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseDownEvent),this._clickTimeoutId===null&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(t)))}},s.prototype._init=function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));{var e=this._target.ownerDocument,i=function(n){t._handler.mouseDownOutsideEvent!=null&&(n.composed&&t._target.contains(n.composedPath()[0])||n.target!==null&&t._target.contains(n.target)||t._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){e.removeEventListener("touchstart",i)},this._unsubscribeOutsideMouseEvents=function(){e.removeEventListener("mousedown",i)},e.addEventListener("mousedown",i),e.addEventListener("touchstart",i,{passive:!0})}dn()&&(this._unsubscribeMobileSafariEvents=function(){t._target.removeEventListener("dblclick",t._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",function(n){if(n.button===1)return n.preventDefault(),!1}),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",function(){},{passive:!1})},s.prototype._initPinch=function(){var t=this;!k(this._handler.pinchStartEvent)&&!k(this._handler.pinchEvent)&&!k(this._handler.pinchEndEvent)||(this._target.addEventListener("touchstart",function(e){t._checkPinchState(e.touches)},{passive:!0}),this._target.addEventListener("touchmove",function(e){if(!(e.touches.length!==2||t._startPinchMiddleCoordinate===null)&&k(t._handler.pinchEvent)){var i=t._getTouchDistance(e.touches[0],e.touches[1]),n=i/t._startPinchDistance;t._handler.pinchEvent(N(N({},t._startPinchMiddleCoordinate),{pageX:0,pageY:0}),n),t._preventDefault(e)}},{passive:!1}),this._target.addEventListener("touchend",function(e){t._checkPinchState(e.touches)}))},s.prototype._checkPinchState=function(t){t.length===1&&(this._pinchPrevented=!1),t.length!==2||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)},s.prototype._startPinch=function(t){var e,i=(e=this._target.getBoundingClientRect())!==null&&e!==void 0?e:{left:0,top:0};this._startPinchMiddleCoordinate={x:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,y:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this._startPinchDistance=this._getTouchDistance(t[0],t[1]),k(this._handler.pinchStartEvent)&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},s.prototype._stopPinch=function(){this._startPinchMiddleCoordinate!==null&&(this._startPinchMiddleCoordinate=null,k(this._handler.pinchEndEvent)&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},s.prototype._mouseLeaveHandler=function(t){var e,i,n;(e=this._unsubscribeMousemove)===null||e===void 0||e.call(this),(i=this._unsubscribeMouseWheel)===null||i===void 0||i.call(this),(n=this._unsubscribeContextMenu)===null||n===void 0||n.call(this),!this._firesTouchEvents(t)&&this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!dn())},s.prototype._longTapHandler=function(t){var e=this._touchWithId(t.touches,this._activeTouchId);e!==null&&(this._processEvent(this._makeCompatEvent(t,e),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},s.prototype._firesTouchEvents=function(t){var e;return k((e=t.sourceCapabilities)===null||e===void 0?void 0:e.firesTouchEvents)?t.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(t)<this._lastTouchEventTimeStamp+500},s.prototype._processEvent=function(t,e){e==null||e.call(this._handler,t)},s.prototype._makeCompatEvent=function(t,e){var i=this,n,r=e??t,o=(n=this._target.getBoundingClientRect())!==null&&n!==void 0?n:{left:0,top:0};return{x:r.clientX-o.left,y:r.clientY-o.top,pageX:r.pageX,pageY:r.pageY,isTouch:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click"&&t.type!=="wheel",preventDefault:function(){t.type!=="touchstart"&&i._preventDefault(t)}}},s.prototype._getTouchDistance=function(t,e){var i=t.clientX-e.clientX,n=t.clientY-e.clientY;return Math.sqrt(i*i+n*n)},s.prototype._preventDefault=function(t){t.cancelable&&t.preventDefault()},s.prototype._getCoordinate=function(t){return{x:t.pageX,y:t.pageY}},s.prototype._eventTimeStamp=function(t){var e;return(e=t.timeStamp)!==null&&e!==void 0?e:performance.now()},s.prototype._touchWithId=function(t,e){for(var i=0;i<t.length;++i)if(t[i].identifier===e)return t[i];return null},s}(),Xh=function(){function s(t,e){var i=this;this._flingStartTime=new Date().getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(n){if(n.shiftKey)switch(n.code){case"Equal":{i._chart.getChartStore().getTimeScaleStore().zoom(.5);break}case"Minus":{i._chart.getChartStore().getTimeScaleStore().zoom(-.5);break}case"ArrowLeft":{var r=i._chart.getChartStore().getTimeScaleStore();r.startScroll(),r.scroll(-3*r.getBarSpace().bar);break}case"ArrowRight":{var r=i._chart.getChartStore().getTimeScaleStore();r.startScroll(),r.scroll(3*r.getBarSpace().bar);break}}},this._container=t,this._chart=e,this._event=new Yh(t,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),t.addEventListener("keydown",this._boundKeyBoardDownEvent)}return s.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},s.prototype.pinchEvent=function(t,e){var i=this._findWidgetByEvent(t),n=i.pane,r=i.widget;if((n==null?void 0:n.getId())!==j.X_AXIS&&(r==null?void 0:r.getName())===$.MAIN){var o=this._makeWidgetEvent(t,r),a=(e-this._pinchScale)*5;return this._pinchScale=e,this._chart.getChartStore().getTimeScaleStore().zoom(a,{x:o.x,y:o.y}),!0}return!1},s.prototype.mouseWheelHortEvent=function(t,e){var i=this._chart.getChartStore().getTimeScaleStore();return i.startScroll(),i.scroll(e),!0},s.prototype.mouseWheelVertEvent=function(t,e){var i=this._findWidgetByEvent(t).widget,n=this._makeWidgetEvent(t,i),r=i==null?void 0:i.getName();return r===$.MAIN?(this._chart.getChartStore().getTimeScaleStore().zoom(e,{x:n.x,y:n.y}),!0):!1},s.prototype.mouseDownEvent=function(t){var e,i,n=this._findWidgetByEvent(t),r=n.pane,o=n.widget;if(this._mouseDownWidget=o,o!==null){var a=this._makeWidgetEvent(t,o),l=o.getName();switch(l){case $.SEPARATOR:return o.dispatchEvent("mouseDownEvent",a);case $.MAIN:{var h=(e=r.getAxisComponent().getRange())!==null&&e!==void 0?e:null;return this._prevYAxisRange=h===null?h:N({},h),this._startScrollCoordinate={x:a.x,y:a.y},this._chart.getChartStore().getTimeScaleStore().startScroll(),o.dispatchEvent("mouseDownEvent",a)}case $.X_AXIS:{var u=o.dispatchEvent("mouseDownEvent",a);return u&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:a.x,y:a.y},this._xAxisStartScaleDistance=a.pageX,u}case $.Y_AXIS:{var u=o.dispatchEvent("mouseDownEvent",a);u&&this._chart.updatePane(1);var h=(i=r.getAxisComponent().getRange())!==null&&i!==void 0?i:null;return this._prevYAxisRange=h===null?h:N({},h),this._yAxisStartScaleDistance=a.pageY,u}}}return!1},s.prototype.mouseMoveEvent=function(t){var e,i,n,r=this._findWidgetByEvent(t),o=r.pane,a=r.widget,l=this._makeWidgetEvent(t,a);if((((e=this._mouseMoveTriggerWidgetInfo.pane)===null||e===void 0?void 0:e.getId())!==(o==null?void 0:o.getId())||((i=this._mouseMoveTriggerWidgetInfo.widget)===null||i===void 0?void 0:i.getName())!==(a==null?void 0:a.getName()))&&(a==null||a.dispatchEvent("mouseEnterEvent",l),(n=this._mouseMoveTriggerWidgetInfo.widget)===null||n===void 0||n.dispatchEvent("mouseLeaveEvent",l),this._mouseMoveTriggerWidgetInfo={pane:o,widget:a}),a!==null){var h=a.getName();switch(h){case $.MAIN:{var u=a.dispatchEvent("mouseMoveEvent",l),c=this._chart.getChartStore(),d={x:l.x,y:l.y,paneId:o==null?void 0:o.getId()};return u&&c.getTooltipStore().getActiveIcon()!==null&&(d=void 0,a!==null&&(a.getContainer().style.cursor="pointer")),this._chart.getChartStore().getTooltipStore().setCrosshair(d),u}case $.SEPARATOR:case $.X_AXIS:case $.Y_AXIS:{var u=a.dispatchEvent("mouseMoveEvent",l);return this._chart.getChartStore().getTooltipStore().setCrosshair(),u}}}return!1},s.prototype.pressedMouseMoveEvent=function(t){var e,i,n,r,o;if(this._mouseDownWidget!==null&&this._mouseDownWidget.getName()===$.SEPARATOR)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",t);var a=this._findWidgetByEvent(t),l=a.pane,h=a.widget;if(h!==null&&((e=this._mouseDownWidget)===null||e===void 0?void 0:e.getPane().getId())===(l==null?void 0:l.getId())&&((i=this._mouseDownWidget)===null||i===void 0?void 0:i.getName())===h.getName()){var u=this._makeWidgetEvent(t,h),c=h.getName();switch(c){case $.MAIN:{var d=h.getBounding(),f=h.dispatchEvent("pressedMouseMoveEvent",u);if(!f&&this._startScrollCoordinate!==null){var v=l.getAxisComponent();if(this._prevYAxisRange!==null&&!v.getAutoCalcTickFlag()&&v.getScrollZoomEnabled()){var p=this._prevYAxisRange,g=p.from,m=p.to,_=p.range,w;(n=v==null?void 0:v.isReverse())!==null&&n!==void 0&&n?w=this._startScrollCoordinate.y-u.y:w=u.y-this._startScrollCoordinate.y;var y=w/d.height,x=_*y,M=g+x,b=m+x,S=v.convertToRealValue(M),C=v.convertToRealValue(b);v.setRange({from:M,to:b,range:b-M,realFrom:S,realTo:C,realRange:C-S})}var E=u.x-this._startScrollCoordinate.x;this._chart.getChartStore().getTimeScaleStore().scroll(E)}return this._chart.getChartStore().getTooltipStore().setCrosshair({x:u.x,y:u.y,paneId:l==null?void 0:l.getId()}),f}case $.X_AXIS:{var f=h.dispatchEvent("pressedMouseMoveEvent",u);if(f)this._chart.updatePane(1);else{var I=l.getAxisComponent();if(!((r=I==null?void 0:I.getScrollZoomEnabled())!==null&&r!==void 0)||r){var y=this._xAxisStartScaleDistance/u.pageX;if(Number.isFinite(y)){var P=(y-this._xAxisScale)*10;this._xAxisScale=y,this._chart.getChartStore().getTimeScaleStore().zoom(P,(o=this._xAxisStartScaleCoordinate)!==null&&o!==void 0?o:void 0)}}}return f}case $.Y_AXIS:{var f=h.dispatchEvent("pressedMouseMoveEvent",u);if(f)this._chart.updatePane(1);else{var v=l.getAxisComponent();if(this._prevYAxisRange!==null&&v.getScrollZoomEnabled()){var T=this._prevYAxisRange,g=T.from,m=T.to,_=T.range,y=u.pageY/this._yAxisStartScaleDistance,R=_*y,x=(R-_)/2,M=g-x,b=m+x,S=v.convertToRealValue(M),C=v.convertToRealValue(b);v.setRange({from:M,to:b,range:R,realFrom:S,realTo:C,realRange:C-S}),this._chart.adjustPaneViewport(!1,!0,!0,!0)}}return f}}}return!1},s.prototype.mouseUpEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(e!==null){var n=this._makeWidgetEvent(t,e),r=e.getName();switch(r){case $.MAIN:case $.SEPARATOR:case $.X_AXIS:case $.Y_AXIS:{i=e.dispatchEvent("mouseUpEvent",n);break}}i&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,i},s.prototype.mouseClickEvent=function(t){var e=this._findWidgetByEvent(t).widget;if(e!==null){var i=this._makeWidgetEvent(t,e);return e.dispatchEvent("mouseClickEvent",i)}return!1},s.prototype.mouseRightClickEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(e!==null){var n=this._makeWidgetEvent(t,e),r=e.getName();switch(r){case $.MAIN:case $.X_AXIS:case $.Y_AXIS:{i=e.dispatchEvent("mouseRightClickEvent",n);break}}i&&this._chart.updatePane(1)}return!1},s.prototype.mouseDoubleClickEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(n!==null){var r=n.getName();switch(r){case $.MAIN:{var o=this._makeWidgetEvent(t,n);return n.dispatchEvent("mouseDoubleClickEvent",o)}case $.Y_AXIS:{var a=i.getAxisComponent();if(!a.getAutoCalcTickFlag())return a.setAutoCalcTickFlag(!0),this._chart.adjustPaneViewport(!1,!0,!0,!0),!0;break}}}return!1},s.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().getTooltipStore().setCrosshair(),!0},s.prototype.touchStartEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(n!==null){var r=this._makeWidgetEvent(t,n),o=n.getName();switch(o){case $.MAIN:{var a=this._chart.getChartStore(),l=a.getTooltipStore();if(n.dispatchEvent("mouseDownEvent",r))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,l.setCrosshair(void 0,{notInvalidate:!0}),this._chart.updatePane(1),!0;if(this._flingScrollRequestId!==null&&(Ss(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=new Date().getTime(),this._startScrollCoordinate={x:r.x,y:r.y},a.getTimeScaleStore().startScroll(),this._touchZoomed=!1,this._touchCoordinate!==null){var h=r.x-this._touchCoordinate.x,u=r.y-this._touchCoordinate.y,c=Math.sqrt(h*h+u*u);c<Wh?(this._touchCoordinate={x:r.x,y:r.y},l.setCrosshair({x:r.x,y:r.y,paneId:i==null?void 0:i.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,l.setCrosshair())}return!0}case $.X_AXIS:case $.Y_AXIS:{var d=n.dispatchEvent("mouseDownEvent",r);return d&&this._chart.updatePane(1),d}}}return!1},s.prototype.touchMoveEvent=function(t){var e,i,n,r=this._findWidgetByEvent(t),o=r.pane,a=r.widget;if(a!==null){var l=this._makeWidgetEvent(t,a),h=a.getName(),u=this._chart.getChartStore(),c=u.getTooltipStore();switch(h){case $.MAIN:{if(a.dispatchEvent("pressedMouseMoveEvent",l))return(e=l.preventDefault)===null||e===void 0||e.call(l),c.setCrosshair(void 0,{notInvalidate:!0}),this._chart.updatePane(1),!0;if(this._touchCoordinate!==null)(i=l.preventDefault)===null||i===void 0||i.call(l),c.setCrosshair({x:l.x,y:l.y,paneId:o==null?void 0:o.getId()});else if(this._startScrollCoordinate!==null&&Math.abs(this._startScrollCoordinate.x-l.x)>this._startScrollCoordinate.y-l.y){var d=l.x-this._startScrollCoordinate.x;u.getTimeScaleStore().scroll(d)}return!0}case $.X_AXIS:case $.Y_AXIS:{var f=a.dispatchEvent("pressedMouseMoveEvent",l);return f&&((n=l.preventDefault)===null||n===void 0||n.call(l),this._chart.updatePane(1)),f}}}return!1},s.prototype.touchEndEvent=function(t){var e=this,i=this._findWidgetByEvent(t).widget;if(i!==null){var n=this._makeWidgetEvent(t,i),r=i.getName();switch(r){case $.MAIN:{if(i.dispatchEvent("mouseUpEvent",n),this._startScrollCoordinate!==null){var o=new Date().getTime()-this._flingStartTime,a=n.x-this._startScrollCoordinate.x,l=a/(o>0?o:1)*20;if(o<200&&Math.abs(l)>0){var h=this._chart.getChartStore().getTimeScaleStore(),u=function(){e._flingScrollRequestId=Ri(function(){h.startScroll(),h.scroll(l),l=l*(1-.025),Math.abs(l)<1?e._flingScrollRequestId!==null&&(Ss(e._flingScrollRequestId),e._flingScrollRequestId=null):u()})};u()}}return!0}case $.X_AXIS:case $.Y_AXIS:{var c=i.dispatchEvent("mouseUpEvent",n);c&&this._chart.updatePane(1)}}}return!1},s.prototype.tapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget,r=!1;if(n!==null){var o=this._makeWidgetEvent(t,n),a=n.dispatchEvent("mouseClickEvent",o);if(n.getName()===$.MAIN){var l=this._makeWidgetEvent(t,n),h=this._chart.getChartStore(),u=h.getTooltipStore();a?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,u.setCrosshair(void 0,{notInvalidate:!0}),r=!0):(!this._touchCancelCrosshair&&!this._touchZoomed&&(this._touchCoordinate={x:l.x,y:l.y},u.setCrosshair({x:l.x,y:l.y,paneId:i==null?void 0:i.getId()},{notInvalidate:!0}),r=!0),this._touchCancelCrosshair=!1)}(r||a)&&this._chart.updatePane(1)}return r},s.prototype.doubleTapEvent=function(t){return this.mouseDoubleClickEvent(t)},s.prototype.longTapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(n!==null&&n.getName()===$.MAIN){var r=this._makeWidgetEvent(t,n);return this._touchCoordinate={x:r.x,y:r.y},this._chart.getChartStore().getTooltipStore().setCrosshair({x:r.x,y:r.y,paneId:i==null?void 0:i.getId()}),!0}return!1},s.prototype._findWidgetByEvent=function(t){var e,i,n,r,o=t.x,a=t.y,l=this._chart.getAllSeparatorPanes(),h=this._chart.getChartStore().getStyles().separator.size;try{for(var u=be(l),c=u.next();!c.done;c=u.next()){var d=Ee(c.value,2),f=d[1],v=f.getBounding(),p=v.top-Math.round((si-h)/2);if(o>=v.left&&o<=v.left+v.width&&a>=p&&a<=p+si)return{pane:f,widget:f.getWidget()}}}catch(E){e={error:E}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(e)throw e.error}}var g=this._chart.getAllDrawPanes(),m=null;try{for(var _=be(g),w=_.next();!w.done;w=_.next()){var y=w.value,v=y.getBounding();if(o>=v.left&&o<=v.left+v.width&&a>=v.top&&a<=v.top+v.height){m=y;break}}}catch(E){n={error:E}}finally{try{w&&!w.done&&(r=_.return)&&r.call(_)}finally{if(n)throw n.error}}var x=null;if(m!==null){if(x===null){var M=m.getMainWidget(),b=M.getBounding();o>=b.left&&o<=b.left+b.width&&a>=b.top&&a<=b.top+b.height&&(x=M)}if(x===null){var S=m.getYAxisWidget();if(S!==null){var C=S.getBounding();o>=C.left&&o<=C.left+C.width&&a>=C.top&&a<=C.top+C.height&&(x=S)}}}return{pane:m,widget:x}},s.prototype._makeWidgetEvent=function(t,e){var i,n,r,o=(i=e==null?void 0:e.getBounding())!==null&&i!==void 0?i:null;return N(N({},t),{x:t.x-((n=o==null?void 0:o.left)!==null&&n!==void 0?n:0),y:t.y-((r=o==null?void 0:o.top)!==null&&r!==void 0?r:0)})},s.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},s}(),Nt;(function(s){s.Root="root",s.Main="main",s.YAxis="yAxis"})(Nt||(Nt={}));var uo=function(){function s(t,e){this._drawPanes=[],this._separatorPanes=new Map,this._initContainer(t),this._chartEvent=new Xh(this._chartContainer,this),this._chartStore=new Ql(this,e),this._initPanes(e),this.adjustPaneViewport(!0,!0,!0)}return s.prototype._initContainer=function(t){this._container=t,this._chartContainer=Kt("div",{position:"relative",width:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)},s.prototype._initPanes=function(t){var e=this,i,n=(i=t==null?void 0:t.layout)!==null&&i!==void 0?i:[{type:"candle"}],r=!1,o=!1,a=function(l){if(!o){var h=e._createPane(Nh,j.X_AXIS,l??{});e._xAxisPane=h,o=!0}};n.forEach(function(l){var h,u,c;switch(l.type){case"candle":{if(!r){var d=(h=l.options)!==null&&h!==void 0?h:{};kt(d,{id:j.CANDLE}),e._candlePane=e._createPane(kh,j.CANDLE,d);var f=(u=l.content)!==null&&u!==void 0?u:[];f.forEach(function(p){e.createIndicator(p,!0,d)}),r=!0}break}case"indicator":{var f=(c=l.content)!==null&&c!==void 0?c:[];if(f.length>0){var v;f.forEach(function(g){k(v)?e.createIndicator(g,!0,{id:v}):v=e.createIndicator(g,!0,l.options)})}break}case"xAxis":{a(l.options);break}}}),a({position:"bottom"})},s.prototype._createPane=function(t,e,i){var n=null,r=null,o=i==null?void 0:i.position;switch(o){case"top":{var a=this._drawPanes[0];k(a)&&(r=new t(this._chartContainer,a.getContainer(),this,e,i??{}),n=0);break}case"bottom":break;default:for(var l=this._drawPanes.length-1;l>-1;l--){var h=this._drawPanes[l],u=this._drawPanes[l-1];if((h==null?void 0:h.getOptions().position)==="bottom"&&(u==null?void 0:u.getOptions().position)!=="bottom"){r=new t(this._chartContainer,h.getContainer(),this,e,i??{}),n=l;break}}}k(r)||(r=new t(this._chartContainer,null,this,e,i??{}));var c;if(V(n)?(this._drawPanes.splice(n,0,r),c=n):(this._drawPanes.push(r),c=this._drawPanes.length-1),r.getId()!==j.X_AXIS){var d=this._drawPanes[c+1];if(k(d)&&d.getId()===j.X_AXIS&&(d=this._drawPanes[c+2]),k(d)){var f=this._separatorPanes.get(d);k(f)?f.setTopPane(r):(f=new Ds(this._chartContainer,d.getContainer(),this,"",r,d),this._separatorPanes.set(d,f))}var v=this._drawPanes[c-1];if(k(v)&&v.getId()===j.X_AXIS&&(v=this._drawPanes[c-2]),k(v)){var f=new Ds(this._chartContainer,r.getContainer(),this,"",v,r);this._separatorPanes.set(r,f)}}return r},s.prototype._measurePaneHeight=function(){var t=this,e,i=Math.floor(this._container.clientHeight),n=this._chartStore.getStyles().separator.size,r=this._xAxisPane.getAxisComponent().getAutoSize(),o=i-r-this._separatorPanes.size*n;o<0&&(o=0);var a=0;this._drawPanes.forEach(function(u){if(u.getId()!==j.CANDLE&&u.getId()!==j.X_AXIS){var c=u.getBounding().height,d=u.getOptions().minHeight;c<d&&(c=d),a+c>o?(a=o,c=Math.max(o-a,0)):a+=c,u.setBounding({height:c})}});var l=o-a;(e=this._candlePane)===null||e===void 0||e.setBounding({height:l}),this._xAxisPane.setBounding({height:r});var h=0;this._drawPanes.forEach(function(u){var c=t._separatorPanes.get(u);k(c)&&(c.setBounding({height:n,top:h}),h+=n),u.setBounding({top:h}),h+=u.getBounding().height})},s.prototype._measurePaneWidth=function(){var t=this,e=Math.floor(this._container.clientWidth),i=this._chartStore.getStyles(),n=i.yAxis,r=n.position===le.Left,o=!n.inside,a=0,l=0,h=0,u=0;this._drawPanes.forEach(function(g){g.getId()!==j.X_AXIS&&(l=Math.max(l,g.getAxisComponent().getAutoSize()))}),l>e&&(l=e),o?(a=e-l,r?(h=0,u=l):(h=e-l,u=0)):(a=e,u=0,r?h=0:h=e-l),this._chartStore.getTimeScaleStore().setTotalBarSpace(a);var c={width:e},d={width:a,left:u},f={width:l,left:h},v=i.separator.fill,p;o&&!v?p=d:p=c,this._drawPanes.forEach(function(g){var m;(m=t._separatorPanes.get(g))===null||m===void 0||m.setBounding(p),g.setBounding(c,d,f)})},s.prototype._setPaneOptions=function(t,e){var i,n;if(O(t.id)){var r=this.getDrawPaneById(t.id),o=!1;if(r!==null){var a=e;if(t.id!==j.CANDLE&&V(t.height)&&t.height>0){var l=Math.max((i=t.minHeight)!==null&&i!==void 0?i:r.getOptions().minHeight,0),h=Math.max(l,t.height);r.setBounding({height:h}),a=!0,o=!0}(O((n=t.axisOptions)===null||n===void 0?void 0:n.name)||k(t.gap))&&(a=!0),r.setOptions(t),a&&this.adjustPaneViewport(o,!0,!0,!0,!0)}}},s.prototype.getDrawPaneById=function(t){if(t===j.CANDLE)return this._candlePane;if(t===j.X_AXIS)return this._xAxisPane;var e=this._drawPanes.find(function(i){return i.getId()===t});return e??null},s.prototype.getContainer=function(){return this._container},s.prototype.getChartStore=function(){return this._chartStore},s.prototype.getXAxisPane=function(){return this._xAxisPane},s.prototype.getAllDrawPanes=function(){return this._drawPanes},s.prototype.getAllSeparatorPanes=function(){return this._separatorPanes},s.prototype.adjustPaneViewport=function(t,e,i,n,r){t&&this._measurePaneHeight();var o=e,a=n??!1,l=r??!1;(a||l)&&this._drawPanes.forEach(function(h){var u=h.getAxisComponent().buildTicks(l);o||(o=u)}),o&&this._measurePaneWidth(),(i??!1)&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4))},s.prototype.updatePane=function(t,e){if(k(e)){var i=this.getDrawPaneById(e);i==null||i.update(t)}else this._separatorPanes.forEach(function(n){n.update(t)}),this._drawPanes.forEach(function(n){n.update(t)})},s.prototype.crosshairChange=function(t){var e=this,i=this._chartStore.getActionStore();if(i.has(Tt.OnCrosshairChange)){var n={};this._drawPanes.forEach(function(r){var o=r.getId(),a={},l=e._chartStore.getIndicatorStore().getInstances(o);l.forEach(function(h){var u,c=h.result;a[h.name]=c[(u=t.dataIndex)!==null&&u!==void 0?u:c.length-1]}),n[o]=a}),O(t.paneId)&&i.execute(Tt.OnCrosshairChange,N(N({},t),{indicatorData:n}))}},s.prototype.getDom=function(t,e){var i,n;if(O(t)){var r=this.getDrawPaneById(t);if(r!==null){var o=e??Nt.Root;switch(o){case Nt.Root:return r.getContainer();case Nt.Main:return r.getMainWidget().getContainer();case Nt.YAxis:return(n=(i=r.getYAxisWidget())===null||i===void 0?void 0:i.getContainer())!==null&&n!==void 0?n:null}}}else return this._chartContainer;return null},s.prototype.getSize=function(t,e){var i,n;if(k(t)){var r=this.getDrawPaneById(t);if(r!==null){var o=e??Nt.Root;switch(o){case Nt.Root:return r.getBounding();case Nt.Main:return r.getMainWidget().getBounding();case Nt.YAxis:return(n=(i=r.getYAxisWidget())===null||i===void 0?void 0:i.getBounding())!==null&&n!==void 0?n:null}}}else return{width:Math.floor(this._chartContainer.clientWidth),height:Math.floor(this._chartContainer.clientHeight),left:0,top:0,right:0,bottom:0};return null},s.prototype.setStyles=function(t){var e,i;this._chartStore.setOptions({styles:t});var n;O(t)?n=Qr(t):n=t,k((e=n==null?void 0:n.yAxis)===null||e===void 0?void 0:e.type)&&((i=this._candlePane)===null||i===void 0||i.getAxisComponent().setAutoCalcTickFlag(!0)),this.adjustPaneViewport(!0,!0,!0,!0,!0)},s.prototype.getStyles=function(){return this._chartStore.getStyles()},s.prototype.setLocale=function(t){this._chartStore.setOptions({locale:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},s.prototype.getLocale=function(){return this._chartStore.getLocale()},s.prototype.setCustomApi=function(t){this._chartStore.setOptions({customApi:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},s.prototype.setPriceVolumePrecision=function(t,e){this._chartStore.setPrecision({price:t,volume:e})},s.prototype.getPriceVolumePrecision=function(){return this._chartStore.getPrecision()},s.prototype.setTimezone=function(t){this._chartStore.setOptions({timezone:t}),this._xAxisPane.getAxisComponent().buildTicks(!0),this._xAxisPane.update(3)},s.prototype.getTimezone=function(){return this._chartStore.getTimeScaleStore().getTimezone()},s.prototype.setOffsetRightDistance=function(t){this._chartStore.getTimeScaleStore().setOffsetRightDistance(t,!0)},s.prototype.getOffsetRightDistance=function(){return this._chartStore.getTimeScaleStore().getOffsetRightDistance()},s.prototype.setMaxOffsetLeftDistance=function(t){t<0||this._chartStore.getTimeScaleStore().setMaxOffsetLeftDistance(t)},s.prototype.setMaxOffsetRightDistance=function(t){t<0||this._chartStore.getTimeScaleStore().setMaxOffsetRightDistance(t)},s.prototype.setLeftMinVisibleBarCount=function(t){t<0||this._chartStore.getTimeScaleStore().setLeftMinVisibleBarCount(Math.ceil(t))},s.prototype.setRightMinVisibleBarCount=function(t){t<0||this._chartStore.getTimeScaleStore().setRightMinVisibleBarCount(Math.ceil(t))},s.prototype.setBarSpace=function(t){this._chartStore.getTimeScaleStore().setBarSpace(t)},s.prototype.getBarSpace=function(){return this._chartStore.getTimeScaleStore().getBarSpace().bar},s.prototype.getVisibleRange=function(){return this._chartStore.getTimeScaleStore().getVisibleRange()},s.prototype.clearData=function(){this._chartStore.clear()},s.prototype.getDataList=function(){return this._chartStore.getDataList()},s.prototype.applyNewData=function(t,e,i){this._chartStore.addData(t,It.Init,e).then(function(){}).catch(function(){}).finally(function(){i==null||i()})},s.prototype.applyMoreData=function(t,e,i){this._chartStore.addData(t,It.Forward,e??!0).then(function(){}).catch(function(){}).finally(function(){i==null||i()})},s.prototype.updateData=function(t,e){this._chartStore.addData(t).then(function(){}).catch(function(){}).finally(function(){e==null||e()})},s.prototype.loadMore=function(t){this._chartStore.setLoadMoreCallback(t)},s.prototype.setLoadDataCallback=function(t){this._chartStore.setLoadDataCallback(t)},s.prototype.createIndicator=function(t,e,i,n){var r=this,o,a=O(t)?{name:t}:t;if(Wr(a.name)===null)return null;var l=i==null?void 0:i.id,h=this.getDrawPaneById(l??"");if(h!==null)this._chartStore.getIndicatorStore().addInstance(a,l??"",e??!1).then(function(d){var f;r._setPaneOptions(i??{},(f=h.getAxisComponent().buildTicks(!0))!==null&&f!==void 0?f:!1)}).catch(function(d){});else{l??(l=Nr(j.INDICATOR));var u=this._createPane(ho,l,i??{}),c=(o=i==null?void 0:i.height)!==null&&o!==void 0?o:Ol;u.setBounding({height:c}),this._chartStore.getIndicatorStore().addInstance(a,l,e??!1).finally(function(){r.adjustPaneViewport(!0,!0,!0,!0,!0),n==null||n()})}return l??null},s.prototype.overrideIndicator=function(t,e,i){var n=this;this._chartStore.getIndicatorStore().override(t,e??null).then(function(r){var o=Ee(r,2),a=o[0],l=o[1];(a||l)&&(n.adjustPaneViewport(!1,l,!0,l),i==null||i())}).catch(function(){})},s.prototype.getIndicatorByPaneId=function(t,e){return this._chartStore.getIndicatorStore().getInstanceByPaneId(t,e)},s.prototype.removeIndicator=function(t,e){var i,n,r,o=this._chartStore.getIndicatorStore(),a=o.removeInstance(t,e);if(a){var l=!1;if(t!==j.CANDLE&&!o.hasInstances(t)){var h=this.getDrawPaneById(t),u=this._drawPanes.findIndex(function(m){return m.getId()===t});if(h!==null){l=!0;var c=this._separatorPanes.get(h);if(k(c)){var d=c==null?void 0:c.getTopPane();try{for(var f=be(this._separatorPanes),v=f.next();!v.done;v=f.next()){var p=v.value;if(p[1].getTopPane().getId()===h.getId()){p[1].setTopPane(d);break}}}catch(m){i={error:m}}finally{try{v&&!v.done&&(n=f.return)&&n.call(f)}finally{if(i)throw i.error}}c.destroy(),this._separatorPanes.delete(h)}this._drawPanes.splice(u,1),h.destroy();var g=this._drawPanes[0];k(g)&&g.getId()===j.X_AXIS&&(g=this._drawPanes[1]),(r=this._separatorPanes.get(g))===null||r===void 0||r.destroy(),this._separatorPanes.delete(g)}}this.adjustPaneViewport(l,!0,!0,!0,!0)}},s.prototype.createOverlay=function(t,e){var i=[];if(O(t))i=[{name:t}];else if(Ft(t))i=t.map(function(a){return O(a)?{name:a}:a});else{var n=t;i=[n]}var r=!0;(!k(e)||this.getDrawPaneById(e)===null)&&(e=j.CANDLE,r=!1);var o=this._chartStore.getOverlayStore().addInstances(i,e,r);return Ft(t)?o:o[0]},s.prototype.getOverlayById=function(t){return this._chartStore.getOverlayStore().getInstanceById(t)},s.prototype.overrideOverlay=function(t){this._chartStore.getOverlayStore().override(t)},s.prototype.removeOverlay=function(t){var e;k(t)&&(O(t)?e={id:t}:e=t),this._chartStore.getOverlayStore().removeInstance(e)},s.prototype.setPaneOptions=function(t){this._setPaneOptions(t,!1)},s.prototype.setZoomEnabled=function(t){this._chartStore.getTimeScaleStore().setZoomEnabled(t)},s.prototype.isZoomEnabled=function(){return this._chartStore.getTimeScaleStore().getZoomEnabled()},s.prototype.setScrollEnabled=function(t){this._chartStore.getTimeScaleStore().setScrollEnabled(t)},s.prototype.isScrollEnabled=function(){return this._chartStore.getTimeScaleStore().getScrollEnabled()},s.prototype.scrollByDistance=function(t,e){var i=V(e)&&e>0?e:0,n=this._chartStore.getTimeScaleStore();if(n.startScroll(),i>0){var r=new Rn({duration:i});r.doFrame(function(o){var a=t*(o/i);n.scroll(a)}),r.start()}else n.scroll(t)},s.prototype.scrollToRealTime=function(t){var e=this._chartStore.getTimeScaleStore(),i=e.getBarSpace().bar,n=e.getLastBarRightSideDiffBarCount()-e.getInitialOffsetRightDistance()/i,r=n*i;this.scrollByDistance(r,t)},s.prototype.scrollToDataIndex=function(t,e){var i=this._chartStore.getTimeScaleStore(),n=(i.getLastBarRightSideDiffBarCount()+(this.getDataList().length-1-t))*i.getBarSpace().bar;this.scrollByDistance(n,e)},s.prototype.scrollToTimestamp=function(t,e){var i=Fn(this.getDataList(),"timestamp",t);this.scrollToDataIndex(i,e)},s.prototype.zoomAtCoordinate=function(t,e,i){var n=V(i)&&i>0?i:0,r=this._chartStore.getTimeScaleStore(),o=r.getBarSpace().bar,a=o*t,l=a-o;if(n>0){var h=0,u=new Rn({duration:n});u.doFrame(function(c){var d=l*(c/n),f=(d-h)/r.getBarSpace().bar*Bn;r.zoom(f,e),h=d}),u.start()}else r.zoom(l/o*Bn,e)},s.prototype.zoomAtDataIndex=function(t,e,i){var n=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:n,y:0},i)},s.prototype.zoomAtTimestamp=function(t,e,i){var n=Fn(this.getDataList(),"timestamp",e);this.zoomAtDataIndex(t,n,i)},s.prototype.convertToPixel=function(t,e){var i,n=e.paneId,r=n===void 0?j.CANDLE:n,o=e.absolute,a=o===void 0?!1:o,l=[];if(r!==j.X_AXIS){var h=this.getDrawPaneById(r);if(h!==null){var u=this._chartStore.getTimeScaleStore(),c=h.getBounding(),d=new Array().concat(t),f=this._xAxisPane.getAxisComponent(),v=h.getAxisComponent();l=d.map(function(p){var g={},m=p.dataIndex;if(V(p.timestamp)&&(m=u.timestampToDataIndex(p.timestamp)),V(m)&&(g.x=f==null?void 0:f.convertToPixel(m)),V(p.value)){var _=v==null?void 0:v.convertToPixel(p.value);g.y=a?c.top+_:_}return g})}}return Ft(t)?l:(i=l[0])!==null&&i!==void 0?i:{}},s.prototype.convertFromPixel=function(t,e){var i,n=e.paneId,r=n===void 0?j.CANDLE:n,o=e.absolute,a=o===void 0?!1:o,l=[];if(r!==j.X_AXIS){var h=this.getDrawPaneById(r);if(h!==null){var u=this._chartStore.getTimeScaleStore(),c=h.getBounding(),d=new Array().concat(t),f=this._xAxisPane.getAxisComponent(),v=h.getAxisComponent();l=d.map(function(p){var g,m,_={};if(V(p.x)){var w=(g=f==null?void 0:f.convertFromPixel(p.x))!==null&&g!==void 0?g:-1;_.dataIndex=w,_.timestamp=(m=u.dataIndexToTimestamp(w))!==null&&m!==void 0?m:void 0}if(V(p.y)){var y=a?p.y-c.top:p.y;_.value=v.convertFromPixel(y)}return _})}}return Ft(t)?l:(i=l[0])!==null&&i!==void 0?i:{}},s.prototype.executeAction=function(t,e){var i;switch(t){case Tt.OnCrosshairChange:{var n=N({},e);n.paneId=(i=n.paneId)!==null&&i!==void 0?i:j.CANDLE,this._chartStore.getTooltipStore().setCrosshair(n,{notExecuteAction:!0});break}}},s.prototype.subscribeAction=function(t,e){this._chartStore.getActionStore().subscribe(t,e)},s.prototype.unsubscribeAction=function(t,e){this._chartStore.getActionStore().unsubscribe(t,e)},s.prototype.getConvertPictureUrl=function(t,e,i){var n=this,r=this._chartContainer.clientWidth,o=this._chartContainer.clientHeight,a=Kt("canvas",{width:"".concat(r,"px"),height:"".concat(o,"px"),boxSizing:"border-box"}),l=a.getContext("2d"),h=ae(a);a.width=r*h,a.height=o*h,l.scale(h,h),l.fillStyle=i??"#FFFFFF",l.fillRect(0,0,r,o);var u=t??!1;return this._drawPanes.forEach(function(c){var d=n._separatorPanes.get(c);if(k(d)){var f=d.getBounding();l.drawImage(d.getImage(u),f.left,f.top,f.width,f.height)}var v=c.getBounding();l.drawImage(c.getImage(u),0,v.top,r,v.height)}),a.toDataURL("image/".concat(e??"jpeg"))},s.prototype.resize=function(){this.adjustPaneViewport(!0,!0,!0,!0,!0)},s.prototype.destroy=function(){this._chartEvent.destroy(),this._drawPanes.forEach(function(t){t.destroy()}),this._drawPanes=[],this._separatorPanes.forEach(function(t){t.destroy()}),this._separatorPanes.clear(),this._container.removeChild(this._chartContainer)},s}(),Bi=new Map,$h=1;function Hh(s,t){var e;if(O(s)?e=document.getElementById(s):e=s,e===null)return null;var i=Bi.get(e.id);if(k(i))return i;var n="k_line_chart_".concat($h++);return i=new uo(e,t),i.id=n,e.setAttribute("k-line-chart-id",n),Bi.set(n,i),i}function Qh(s){var t,e,i;if(s instanceof uo)i=s.id;else{var n=void 0;O(s)?n=document.getElementById(s):n=s,i=(t=n==null?void 0:n.getAttribute("k-line-chart-id"))!==null&&t!==void 0?t:null}i!==null&&((e=Bi.get(i))===null||e===void 0||e.destroy(),Bi.delete(i))}function co(s){return Oi({method:"POST",url:"/klineMarket",data:s})}function jh(s){return Oi({method:"POST",url:"/lever/submit",data:s})}function Gh(){return Oi({method:"GET",url:"/seconds"})}function Uh(s){return Oi({method:"POST",url:"/MicroOrder/submit",data:s})}const Jh={class:"times my-2 flex space-between"},Zh={key:0,class:"text-center"},Kh={key:1,id:"klineChart",style:{height:"300px"}},qh={__name:"KlineChart",props:["symbol"],setup(s){const t=Hi(),e=s,i=q([{text:"1M",value:"1min",time:1},{text:"5M",value:"5min",time:5},{text:"15M",value:"15min",time:15},{text:"30M",value:"30min",time:30},{text:"1H",value:"60min",time:60},{text:"1D",value:"1day",time:360},{text:"1W",value:"1week",time:1800},{text:"1 Month",value:"1mon",time:1800}]);let n=null;const r=q({text:"1M",value:"1min",time:1}),o=q("1M"),a=q(["1M"]),l=q(!1),h=q(!1),u=({selectedValues:f,selectedOptions:v})=>{l.value=!1,r.value.value!==f[0]&&(r.value=i.value.find(p=>p.value===f[0]),a.value=f,o.value=v[0].text)};Yn(()=>{t.on("kline",f=>{const{symbol:v,period:p,floating:g=0}=f;f.timestamp=f.time*1e3,v===e.symbol&&p===r.value.value&&n&&(f.open-=g,f.close-=g,f.high-=g,f.low-=g,n.updateData(f))})}),Wi(()=>{t.off("kline")});function c(){const f=r.value,v={from:Date.parse(new Date)/1e3-f.time*24*60*60,to:Date.parse(new Date)/1e3,symbol:e.symbol,period:f.value};h.value=!0,co(v).then(p=>{if((p==null?void 0:p.type)==="ok"){const g=p.data.map(m=>(m.timestamp=m.time,m))||[];setTimeout(()=>{d();const m=[...new Map(g.map(w=>[w.id,w])).values()],_=m[0];(_==null?void 0:_.open)<10?n.setPriceVolumePrecision(4,4):n.setPriceVolumePrecision(2,2),n.applyNewData(m)},300)}}).finally(()=>{h.value=!1})}Jt(()=>e.symbol,f=>{if(f&&n){if(o.value===i.value[0].text)return;r.value=i.value[0],o.value=i.value[0].text,a.value=[i.value[0].value]}}),Ir(()=>{c()});function d(){const f=document.getElementById("klineChart");n&&Qh(n),n=Hh(f,{styles:{grid:{show:!1},candle:{bar:{upColor:"#85bd00",downColor:"#f6543e"},tooltip:{custom:[{title:"high",value:"{high}"},{title:"open",value:"{open}"},{title:"low",value:"{low}"}],text:{size:11,marginTop:2,marginBottom:2}}},xAxis:{axisLine:{show:!1},tickText:{marginEnd:1,marginStart:1}},yAxis:{axisLine:{show:!1}}}}),n.setZoomEnabled(!0),n.setOffsetRightDistance(10)}return(f,v)=>{const p=Xn,g=$i,m=Gn,_=di,w=Yi;return Q(),it(Ot,null,[z("div",Jh,[B(g,{onClick:v[0]||(v[0]=y=>l.value=!0),size:"medium",plain:"",type:"primary"},{default:ot(()=>[oe(rt(A(o))+" ",1),B(p,{name:"arrow-down"})]),_:1}),B(_,{show:A(l),"onUpdate:show":v[3]||(v[3]=y=>we(l)?l.value=y:null),position:"bottom",round:"","safe-area-inset-bottom":!0},{default:ot(()=>[B(m,{columns:A(i),modelValue:A(a),"onUpdate:modelValue":v[1]||(v[1]=y=>we(a)?a.value=y:null),onConfirm:u,onCancel:v[2]||(v[2]=y=>l.value=!1)},null,8,["columns","modelValue"])]),_:1},8,["show"])]),A(h)?(Q(),it("div",Zh,[B(w,{size:"24"})])):(Q(),it("div",Kh))],64)}}},tu=Qe(qh,[["__scopeId","data-v-3af0f1dc"]]);function K(s){var t=s.width,e=s.height;if(t<0)throw new Error("Negative width is not allowed for Size");if(e<0)throw new Error("Negative height is not allowed for Size");return{width:t,height:e}}function ye(s,t){return s.width===t.width&&s.height===t.height}var eu=function(){function s(t){var e=this;this._resolutionListener=function(){return e._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return s.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(s.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),s.prototype.subscribe=function(t){var e=this,i={next:t};return this._observers.push(i),{unsubscribe:function(){e._observers=e._observers.filter(function(n){return n!==i})}}},s.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},s.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},s.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},s.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach(function(e){return e.next(t._window.devicePixelRatio)}),this._reinstallResolutionListener()},s}();function iu(s){return new eu(s)}var nu=function(){function s(t,e,i){var n;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=K({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=e??function(r){return r},this._allowResizeObserver=(n=i==null?void 0:i.allowResizeObserver)!==null&&n!==void 0?n:!0,this._chooseAndInitObserver()}return s.prototype.dispose=function(){var t,e;if(this._canvasElement===null)throw new Error("Object is disposed");(t=this._canvasElementResizeObserver)===null||t===void 0||t.disconnect(),this._canvasElementResizeObserver=null,(e=this._devicePixelRatioObservable)===null||e===void 0||e.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(s.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"bitmapSize",{get:function(){return K({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),s.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=K(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},s.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},s.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(e){return e!==t})},Object.defineProperty(s.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),s.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},s.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(e){return e!==t})},s.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},s.prototype._resizeBitmap=function(t){var e=this.bitmapSize;ye(e,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(e,t))},s.prototype._emitBitmapSizeChanged=function(t,e){var i=this;this._bitmapSizeChangedListeners.forEach(function(n){return n.call(i,t,e)})},s.prototype._suggestNewBitmapSize=function(t){var e=this._suggestedBitmapSize,i=K(this._transformBitmapSize(t,this._canvasElementClientSize)),n=ye(this.bitmapSize,i)?null:i;e===null&&n===null||e!==null&&n!==null&&ye(e,n)||(this._suggestedBitmapSize=n,this._emitSuggestedBitmapSizeChanged(e,n))},s.prototype._emitSuggestedBitmapSizeChanged=function(t,e){var i=this;this._suggestedBitmapSizeChangedListeners.forEach(function(n){return n.call(i,t,e)})},s.prototype._chooseAndInitObserver=function(){var t=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}ru().then(function(e){return e?t._initResizeObserver():t._initDevicePixelRatioObservable()})},s.prototype._initDevicePixelRatioObservable=function(){var t=this;if(this._canvasElement!==null){var e=Rs(this._canvasElement);if(e===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=iu(e),this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()}),this._invalidateBitmapSize()}},s.prototype._invalidateBitmapSize=function(){var t,e;if(this._canvasElement!==null){var i=Rs(this._canvasElement);if(i!==null){var n=(e=(t=this._devicePixelRatioObservable)===null||t===void 0?void 0:t.value)!==null&&e!==void 0?e:i.devicePixelRatio,r=this._canvasElement.getClientRects(),o=r[0]!==void 0?ou(r[0],n):K({width:this._canvasElementClientSize.width*n,height:this._canvasElementClientSize.height*n});this._suggestNewBitmapSize(o)}}},s.prototype._initResizeObserver=function(){var t=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(e){var i=e.find(function(o){return o.target===t._canvasElement});if(!(!i||!i.devicePixelContentBoxSize||!i.devicePixelContentBoxSize[0])){var n=i.devicePixelContentBoxSize[0],r=K({width:n.inlineSize,height:n.blockSize});t._suggestNewBitmapSize(r)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},s}();function su(s,t){return new nu(s,t.transform,t.options)}function Rs(s){return s.ownerDocument.defaultView}function ru(){return new Promise(function(s){var t=new ResizeObserver(function(e){s(e.every(function(i){return"devicePixelContentBoxSize"in i})),t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function ou(s,t){return K({width:Math.round(s.left*t+s.width*t)-Math.round(s.left*t),height:Math.round(s.top*t+s.height*t)-Math.round(s.top*t)})}var au=function(){function s(t,e,i){if(e.width===0||e.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=e,i.width===0||i.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=i,this._context=t}return s.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},s.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(s.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),s}();function xe(s,t){var e=s.canvasElementClientSize;if(e.width===0||e.height===0)return null;var i=s.bitmapSize;if(i.width===0||i.height===0)return null;var n=s.canvasElement.getContext("2d",t);return n===null?null:new au(n,e,i)}/*!
 * @license
 * TradingView Lightweight Charts™ v5.0.5
 * Copyright (c) 2025 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const fo={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var Fs,Bs;function Ye(s,t){const e={0:[],1:[s.lineWidth,s.lineWidth],2:[2*s.lineWidth,2*s.lineWidth],3:[6*s.lineWidth,6*s.lineWidth],4:[s.lineWidth,4*s.lineWidth]}[t];s.setLineDash(e)}function vo(s,t,e,i){s.beginPath();const n=s.lineWidth%2?.5:0;s.moveTo(e,t+n),s.lineTo(i,t+n),s.stroke()}function _t(s,t){if(!s)throw new Error("Assertion failed"+(t?": "+t:""))}function bt(s){if(s===void 0)throw new Error("Value is undefined");return s}function D(s){if(s===null)throw new Error("Value is null");return s}function ge(s){return D(bt(s))}(function(s){s[s.Simple=0]="Simple",s[s.WithSteps=1]="WithSteps",s[s.Curved=2]="Curved"})(Fs||(Fs={})),function(s){s[s.Solid=0]="Solid",s[s.Dotted=1]="Dotted",s[s.Dashed=2]="Dashed",s[s.LargeDashed=3]="LargeDashed",s[s.SparseDotted=4]="SparseDotted"}(Bs||(Bs={}));class lt{constructor(){this.t=[]}i(t,e,i){const n={h:t,l:e,o:i===!0};this.t.push(n)}_(t){const e=this.t.findIndex(i=>t===i.h);e>-1&&this.t.splice(e,1)}u(t){this.t=this.t.filter(e=>e.l!==t)}p(t,e,i){const n=[...this.t];this.t=this.t.filter(r=>!r.o),n.forEach(r=>r.h(t,e,i))}v(){return this.t.length>0}m(){this.t=[]}}function xt(s,...t){for(const e of t)for(const i in e)e[i]!==void 0&&Object.prototype.hasOwnProperty.call(e,i)&&!["__proto__","constructor","prototype"].includes(i)&&(typeof e[i]!="object"||s[i]===void 0||Array.isArray(e[i])?s[i]=e[i]:xt(s[i],e[i]));return s}function Xe(s){return typeof s=="number"&&isFinite(s)}function ui(s){return typeof s=="number"&&s%1==0}function fi(s){return typeof s=="string"}function bi(s){return typeof s=="boolean"}function Gt(s){const t=s;if(!t||typeof t!="object")return t;let e,i,n;for(i in e=Array.isArray(t)?[]:{},t)t.hasOwnProperty(i)&&(n=t[i],e[i]=n&&typeof n=="object"?Gt(n):n);return e}function lu(s){return s!==null}function ci(s){return s===null?void 0:s}const po="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function Vi(s,t,e){return t===void 0&&(t=po),`${e=e!==void 0?`${e} `:""}${s}px ${t}`}class hu{constructor(t){this.M={S:1,C:5,P:NaN,k:"",T:"",R:"",D:"",V:0,I:0,B:0,A:0,L:0},this.O=t}N(){const t=this.M,e=this.W(),i=this.F();return t.P===e&&t.T===i||(t.P=e,t.T=i,t.k=Vi(e,i),t.A=2.5/12*e,t.V=t.A,t.I=e/12*t.C,t.B=e/12*t.C,t.L=0),t.R=this.H(),t.D=this.U(),this.M}H(){return this.O.N().layout.textColor}U(){return this.O.$()}W(){return this.O.N().layout.fontSize}F(){return this.O.N().layout.fontFamily}}function fn(s){return s<0?0:s>255?255:Math.round(s)||0}function Vs(s){return .199*s[0]+.687*s[1]+.114*s[2]}class uu{constructor(t,e){this.q=new Map,this.Y=t,e&&(this.q=e)}j(t,e){if(t==="transparent")return t;const i=this.Z(t),n=i[3];return`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${e*n})`}K(t){const e=this.Z(t);return{X:`rgb(${e[0]}, ${e[1]}, ${e[2]})`,G:Vs(e)>160?"black":"white"}}J(t){return Vs(this.Z(t))}tt(t,e,i){const[n,r,o,a]=this.Z(t),[l,h,u,c]=this.Z(e),d=[fn(n+i*(l-n)),fn(r+i*(h-r)),fn(o+i*(u-o)),(f=a+i*(c-a),f<=0||f>1?Math.min(Math.max(f,0),1):Math.round(1e4*f)/1e4)];var f;return`rgba(${d[0]}, ${d[1]}, ${d[2]}, ${d[3]})`}Z(t){const e=this.q.get(t);if(e)return e;const i=function(o){const a=document.createElement("div");a.style.display="none",document.body.appendChild(a),a.style.color=o;const l=window.getComputedStyle(a).color;return document.body.removeChild(a),l}(t),n=i.match(/^rgba?\s*\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d+))?\)$/);if(!n){if(this.Y.length)for(const o of this.Y){const a=o(t);if(a)return this.q.set(t,a),a}throw new Error(`Failed to parse color: ${t}`)}const r=[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),n[4]?parseFloat(n[4]):1];return this.q.set(t,r),r}}class cu{constructor(){this.it=[]}st(t){this.it=t}nt(t,e,i){this.it.forEach(n=>{n.nt(t,e,i)})}}class Pe{nt(t,e,i){t.useBitmapCoordinateSpace(n=>this.et(n,e,i))}}class du extends Pe{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){if(this.rt===null||this.rt.lt===null)return;const n=this.rt.lt,r=this.rt,o=Math.max(1,Math.floor(e))%2/2,a=l=>{t.beginPath();for(let h=n.to-1;h>=n.from;--h){const u=r.ot[h],c=Math.round(u._t*e)+o,d=u.ut*i,f=l*i+o;t.moveTo(c,d),t.arc(c,d,f,0,2*Math.PI)}t.fill()};r.ct>0&&(t.fillStyle=r.dt,a(r.ft+r.ct)),t.fillStyle=r.vt,a(r.ft)}}function fu(){return{ot:[{_t:0,ut:0,wt:0,gt:0}],vt:"",dt:"",ft:0,ct:0,lt:null}}const vu={from:0,to:1};class pu{constructor(t,e,i){this.Mt=new cu,this.bt=[],this.xt=[],this.St=!0,this.O=t,this.Ct=e,this.yt=i,this.Mt.st(this.bt)}Pt(t){this.kt(),this.St=!0}Tt(){return this.St&&(this.Rt(),this.St=!1),this.Mt}kt(){const t=this.yt.Dt();t.length!==this.bt.length&&(this.xt=t.map(fu),this.bt=this.xt.map(e=>{const i=new du;return i.ht(e),i}),this.Mt.st(this.bt))}Rt(){const t=this.Ct.N().mode===2||!this.Ct.Vt(),e=this.yt.It(),i=this.Ct.Bt(),n=this.O.At();this.kt(),e.forEach((r,o)=>{const a=this.xt[o],l=r.Et(i),h=r.zt();!t&&l!==null&&r.Vt()&&h!==null?(a.vt=l.Lt,a.ft=l.ft,a.ct=l.Ot,a.ot[0].gt=l.gt,a.ot[0].ut=r.Wt().Nt(l.gt,h.Ft),a.dt=l.Ht??this.O.Ut(a.ot[0].ut/r.Wt().$t()),a.ot[0].wt=i,a.ot[0]._t=n.qt(i),a.lt=vu):a.lt=null})}}class gu extends Pe{constructor(t){super(),this.Yt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:n}){if(this.Yt===null)return;const r=this.Yt.jt.Vt,o=this.Yt.Zt.Vt;if(!r&&!o)return;const a=Math.round(this.Yt._t*i),l=Math.round(this.Yt.ut*n);t.lineCap="butt",r&&a>=0&&(t.lineWidth=Math.floor(this.Yt.jt.ct*i),t.strokeStyle=this.Yt.jt.R,t.fillStyle=this.Yt.jt.R,Ye(t,this.Yt.jt.Kt),function(h,u,c,d){h.beginPath();const f=h.lineWidth%2?.5:0;h.moveTo(u+f,c),h.lineTo(u+f,d),h.stroke()}(t,a,0,e.height)),o&&l>=0&&(t.lineWidth=Math.floor(this.Yt.Zt.ct*n),t.strokeStyle=this.Yt.Zt.R,t.fillStyle=this.Yt.Zt.R,Ye(t,this.Yt.Zt.Kt),vo(t,l,0,e.width))}}class mu{constructor(t,e){this.St=!0,this.Xt={jt:{ct:1,Kt:0,R:"",Vt:!1},Zt:{ct:1,Kt:0,R:"",Vt:!1},_t:0,ut:0},this.Gt=new gu(this.Xt),this.Jt=t,this.yt=e}Pt(){this.St=!0}Tt(t){return this.St&&(this.Rt(),this.St=!1),this.Gt}Rt(){const t=this.Jt.Vt(),e=this.yt.Qt().N().crosshair,i=this.Xt;if(e.mode===2)return i.Zt.Vt=!1,void(i.jt.Vt=!1);i.Zt.Vt=t&&this.Jt.ti(this.yt),i.jt.Vt=t&&this.Jt.ii(),i.Zt.ct=e.horzLine.width,i.Zt.Kt=e.horzLine.style,i.Zt.R=e.horzLine.color,i.jt.ct=e.vertLine.width,i.jt.Kt=e.vertLine.style,i.jt.R=e.vertLine.color,i._t=this.Jt.si(),i.ut=this.Jt.ni()}}function _u(s,t,e,i,n,r){s.fillRect(t+r,e,i-2*r,r),s.fillRect(t+r,e+n-r,i-2*r,r),s.fillRect(t,e,r,n),s.fillRect(t+i-r,e,r,n)}function ji(s,t,e,i,n,r){s.save(),s.globalCompositeOperation="copy",s.fillStyle=r,s.fillRect(t,e,i,n),s.restore()}function Ls(s,t,e,i,n,r){s.beginPath(),s.roundRect?s.roundRect(t,e,i,n,r):(s.lineTo(t+i-r[1],e),r[1]!==0&&s.arcTo(t+i,e,t+i,e+r[1],r[1]),s.lineTo(t+i,e+n-r[2]),r[2]!==0&&s.arcTo(t+i,e+n,t+i-r[2],e+n,r[2]),s.lineTo(t+r[3],e+n),r[3]!==0&&s.arcTo(t,e+n,t,e+n-r[3],r[3]),s.lineTo(t,e+r[0]),r[0]!==0&&s.arcTo(t,e,t+r[0],e,r[0]))}function Ns(s,t,e,i,n,r,o=0,a=[0,0,0,0],l=""){if(s.save(),!o||!l||l===r)return Ls(s,t,e,i,n,a),s.fillStyle=r,s.fill(),void s.restore();const h=o/2;var u;Ls(s,t+h,e+h,i-o,n-o,(u=-h,a.map(c=>c===0?c:c+u))),r!=="transparent"&&(s.fillStyle=r,s.fill()),l!=="transparent"&&(s.lineWidth=o,s.strokeStyle=l,s.closePath(),s.stroke()),s.restore()}function go(s,t,e,i,n,r,o){s.save(),s.globalCompositeOperation="copy";const a=s.createLinearGradient(0,0,0,n);a.addColorStop(0,r),a.addColorStop(1,o),s.fillStyle=a,s.fillRect(t,e,i,n),s.restore()}class zs{constructor(t,e){this.ht(t,e)}ht(t,e){this.Yt=t,this.ei=e}$t(t,e){return this.Yt.Vt?t.P+t.A+t.V:0}nt(t,e,i,n){if(!this.Yt.Vt||this.Yt.ri.length===0)return;const r=this.Yt.R,o=this.ei.X,a=t.useBitmapCoordinateSpace(l=>{const h=l.context;h.font=e.k;const u=this.hi(l,e,i,n),c=u.ai;return u.li?Ns(h,c.oi,c._i,c.ui,c.ci,o,c.di,[c.ft,0,0,c.ft],o):Ns(h,c.fi,c._i,c.ui,c.ci,o,c.di,[0,c.ft,c.ft,0],o),this.Yt.pi&&(h.fillStyle=r,h.fillRect(c.fi,c.mi,c.wi-c.fi,c.gi)),this.Yt.Mi&&(h.fillStyle=e.D,h.fillRect(u.li?c.bi-c.di:0,c._i,c.di,c.xi-c._i)),u});t.useMediaCoordinateSpace(({context:l})=>{const h=a.Si;l.font=e.k,l.textAlign=a.li?"right":"left",l.textBaseline="middle",l.fillStyle=r,l.fillText(this.Yt.ri,h.Ci,(h._i+h.xi)/2+h.yi)})}hi(t,e,i,n){const{context:r,bitmapSize:o,mediaSize:a,horizontalPixelRatio:l,verticalPixelRatio:h}=t,u=this.Yt.pi||!this.Yt.Pi?e.C:0,c=this.Yt.ki?e.S:0,d=e.A+this.ei.Ti,f=e.V+this.ei.Ri,v=e.I,p=e.B,g=this.Yt.ri,m=e.P,_=i.Di(r,g),w=Math.ceil(i.Vi(r,g)),y=m+d+f,x=e.S+v+p+w+u,M=Math.max(1,Math.floor(h));let b=Math.round(y*h);b%2!=M%2&&(b+=1);const S=c>0?Math.max(1,Math.floor(c*l)):0,C=Math.round(x*l),E=Math.round(u*l),I=this.ei.Ii??this.ei.Bi,P=Math.round(I*h)-Math.floor(.5*h),T=Math.floor(P+M/2-b/2),R=T+b,L=n==="right",F=L?a.width-c:c,X=L?o.width-S:S;let W,et,nt;return L?(W=X-C,et=X-E,nt=F-u-v-c):(W=X+C,et=X+E,nt=F+u+v),{li:L,ai:{_i:T,mi:P,xi:R,ui:C,ci:b,ft:2*l,di:S,oi:W,fi:X,wi:et,gi:M,bi:o.width},Si:{_i:T/h,xi:R/h,Ci:nt,yi:_}}}}class Gi{constructor(t){this.Ai={Bi:0,X:"#000",Ri:0,Ti:0},this.Ei={ri:"",Vt:!1,pi:!0,Pi:!1,Ht:"",R:"#FFF",Mi:!1,ki:!1},this.zi={ri:"",Vt:!1,pi:!1,Pi:!0,Ht:"",R:"#FFF",Mi:!0,ki:!0},this.St=!0,this.Li=new(t||zs)(this.Ei,this.Ai),this.Oi=new(t||zs)(this.zi,this.Ai)}ri(){return this.Ni(),this.Ei.ri}Bi(){return this.Ni(),this.Ai.Bi}Pt(){this.St=!0}$t(t,e=!1){return Math.max(this.Li.$t(t,e),this.Oi.$t(t,e))}Wi(){return this.Ai.Ii||0}Fi(t){this.Ai.Ii=t}Hi(){return this.Ni(),this.Ei.Vt||this.zi.Vt}Ui(){return this.Ni(),this.Ei.Vt}Tt(t){return this.Ni(),this.Ei.pi=this.Ei.pi&&t.N().ticksVisible,this.zi.pi=this.zi.pi&&t.N().ticksVisible,this.Li.ht(this.Ei,this.Ai),this.Oi.ht(this.zi,this.Ai),this.Li}$i(){return this.Ni(),this.Li.ht(this.Ei,this.Ai),this.Oi.ht(this.zi,this.Ai),this.Oi}Ni(){this.St&&(this.Ei.pi=!0,this.zi.pi=!1,this.qi(this.Ei,this.zi,this.Ai))}}class yu extends Gi{constructor(t,e,i){super(),this.Jt=t,this.Yi=e,this.ji=i}qi(t,e,i){if(t.Vt=!1,this.Jt.N().mode===2)return;const n=this.Jt.N().horzLine;if(!n.labelVisible)return;const r=this.Yi.zt();if(!this.Jt.Vt()||this.Yi.Zi()||r===null)return;const o=this.Yi.Ki().K(n.labelBackgroundColor);i.X=o.X,t.R=o.G;const a=2/12*this.Yi.P();i.Ti=a,i.Ri=a;const l=this.ji(this.Yi);i.Bi=l.Bi,t.ri=this.Yi.Xi(l.gt,r),t.Vt=!0}}const wu=/[1-9]/g;class mo{constructor(){this.Yt=null}ht(t){this.Yt=t}nt(t,e){if(this.Yt===null||this.Yt.Vt===!1||this.Yt.ri.length===0)return;const i=t.useMediaCoordinateSpace(({context:d})=>(d.font=e.k,Math.round(e.Gi.Vi(d,D(this.Yt).ri,wu))));if(i<=0)return;const n=e.Ji,r=i+2*n,o=r/2,a=this.Yt.Qi;let l=this.Yt.Bi,h=Math.floor(l-o)+.5;h<0?(l+=Math.abs(0-h),h=Math.floor(l-o)+.5):h+r>a&&(l-=Math.abs(a-(h+r)),h=Math.floor(l-o)+.5);const u=h+r,c=Math.ceil(0+e.S+e.C+e.A+e.P+e.V);t.useBitmapCoordinateSpace(({context:d,horizontalPixelRatio:f,verticalPixelRatio:v})=>{const p=D(this.Yt);d.fillStyle=p.X;const g=Math.round(h*f),m=Math.round(0*v),_=Math.round(u*f),w=Math.round(c*v),y=Math.round(2*f);if(d.beginPath(),d.moveTo(g,m),d.lineTo(g,w-y),d.arcTo(g,w,g+y,w,y),d.lineTo(_-y,w),d.arcTo(_,w,_,w-y,y),d.lineTo(_,m),d.fill(),p.pi){const x=Math.round(p.Bi*f),M=m,b=Math.round((M+e.C)*v);d.fillStyle=p.R;const S=Math.max(1,Math.floor(f)),C=Math.floor(.5*f);d.fillRect(x-C,M,S,b-M)}}),t.useMediaCoordinateSpace(({context:d})=>{const f=D(this.Yt),v=0+e.S+e.C+e.A+e.P/2;d.font=e.k,d.textAlign="left",d.textBaseline="middle",d.fillStyle=f.R;const p=e.Gi.Di(d,"Apr0");d.translate(h+n,v+p),d.fillText(f.ri,0,0)})}}class bu{constructor(t,e,i){this.St=!0,this.Gt=new mo,this.Xt={Vt:!1,X:"#4c525e",R:"white",ri:"",Qi:0,Bi:NaN,pi:!0},this.Ct=t,this.ts=e,this.ji=i}Pt(){this.St=!0}Tt(){return this.St&&(this.Rt(),this.St=!1),this.Gt.ht(this.Xt),this.Gt}Rt(){const t=this.Xt;if(t.Vt=!1,this.Ct.N().mode===2)return;const e=this.Ct.N().vertLine;if(!e.labelVisible)return;const i=this.ts.At();if(i.Zi())return;t.Qi=i.Qi();const n=this.ji();if(n===null)return;t.Bi=n.Bi;const r=i.ss(this.Ct.Bt());t.ri=i.ns(D(r)),t.Vt=!0;const o=this.ts.Ki().K(e.labelBackgroundColor);t.X=o.X,t.R=o.G,t.pi=i.N().ticksVisible}}class _o{constructor(){this.es=null,this.rs=0}hs(){return this.rs}ls(t){this.rs=t}Wt(){return this.es}_s(t){this.es=t}us(t){return[]}cs(){return[]}Vt(){return!0}}var Vn;(function(s){s[s.Normal=0]="Normal",s[s.Magnet=1]="Magnet",s[s.Hidden=2]="Hidden",s[s.MagnetOHLC=3]="MagnetOHLC"})(Vn||(Vn={}));class Su extends _o{constructor(t,e){super(),this.yt=null,this.ds=NaN,this.fs=0,this.ps=!1,this.vs=new Map,this.ws=!1,this.gs=new WeakMap,this.Ms=new WeakMap,this.bs=NaN,this.xs=NaN,this.Ss=NaN,this.Cs=NaN,this.ts=t,this.ys=e,this.Ps=((n,r)=>o=>{const a=r(),l=n();if(o===D(this.yt).ks())return{gt:l,Bi:a};{const h=D(o.zt());return{gt:o.Ts(a,h),Bi:a}}})(()=>this.ds,()=>this.xs);const i=((n,r)=>()=>{const o=this.ts.At().Rs(n()),a=r();return o&&Number.isFinite(a)?{wt:o,Bi:a}:null})(()=>this.fs,()=>this.si());this.Ds=new bu(this,t,i)}N(){return this.ys}Vs(t,e){this.Ss=t,this.Cs=e}Is(){this.Ss=NaN,this.Cs=NaN}Bs(){return this.Ss}As(){return this.Cs}Es(t,e,i){this.ws||(this.ws=!0),this.ps=!0,this.zs(t,e,i)}Bt(){return this.fs}si(){return this.bs}ni(){return this.xs}Vt(){return this.ps}Ls(){this.ps=!1,this.Os(),this.ds=NaN,this.bs=NaN,this.xs=NaN,this.yt=null,this.Is(),this.Ns()}Ws(t){let e=this.gs.get(t);e||(e=new mu(this,t),this.gs.set(t,e));let i=this.Ms.get(t);return i||(i=new pu(this.ts,this,t),this.Ms.set(t,i)),[e,i]}ti(t){return t===this.yt&&this.ys.horzLine.visible}ii(){return this.ys.vertLine.visible}Fs(t,e){this.ps&&this.yt===t||this.vs.clear();const i=[];return this.yt===t&&i.push(this.Hs(this.vs,e,this.Ps)),i}cs(){return this.ps?[this.Ds]:[]}Us(){return this.yt}Ns(){this.ts.$s().forEach(t=>{var e,i;(e=this.gs.get(t))==null||e.Pt(),(i=this.Ms.get(t))==null||i.Pt()}),this.vs.forEach(t=>t.Pt()),this.Ds.Pt()}qs(t){return t&&!t.ks().Zi()?t.ks():null}zs(t,e,i){this.Ys(t,e,i)&&this.Ns()}Ys(t,e,i){const n=this.bs,r=this.xs,o=this.ds,a=this.fs,l=this.yt,h=this.qs(i);this.fs=t,this.bs=isNaN(t)?NaN:this.ts.At().qt(t),this.yt=i;const u=h!==null?h.zt():null;return h!==null&&u!==null?(this.ds=e,this.xs=h.Nt(e,u)):(this.ds=NaN,this.xs=NaN),n!==this.bs||r!==this.xs||a!==this.fs||o!==this.ds||l!==this.yt}Os(){const t=this.ts.js().map(i=>i.Ks().Zs()).filter(lu),e=t.length===0?null:Math.max(...t);this.fs=e!==null?e:NaN}Hs(t,e,i){let n=t.get(e);return n===void 0&&(n=new yu(this,e,i),t.set(e,n)),n}}function Ui(s){return s==="left"||s==="right"}class pt{constructor(t){this.Xs=new Map,this.Gs=[],this.Js=t}Qs(t,e){const i=function(n,r){return n===void 0?r:{tn:Math.max(n.tn,r.tn),sn:n.sn||r.sn}}(this.Xs.get(t),e);this.Xs.set(t,i)}nn(){return this.Js}en(t){const e=this.Xs.get(t);return e===void 0?{tn:this.Js}:{tn:Math.max(this.Js,e.tn),sn:e.sn}}rn(){this.hn(),this.Gs=[{an:0}]}ln(t){this.hn(),this.Gs=[{an:1,Ft:t}]}_n(t){this.un(),this.Gs.push({an:5,Ft:t})}hn(){this.un(),this.Gs.push({an:6})}cn(){this.hn(),this.Gs=[{an:4}]}dn(t){this.hn(),this.Gs.push({an:2,Ft:t})}fn(t){this.hn(),this.Gs.push({an:3,Ft:t})}pn(){return this.Gs}vn(t){for(const e of t.Gs)this.mn(e);this.Js=Math.max(this.Js,t.Js),t.Xs.forEach((e,i)=>{this.Qs(i,e)})}static wn(){return new pt(2)}static gn(){return new pt(3)}mn(t){switch(t.an){case 0:this.rn();break;case 1:this.ln(t.Ft);break;case 2:this.dn(t.Ft);break;case 3:this.fn(t.Ft);break;case 4:this.cn();break;case 5:this._n(t.Ft);break;case 6:this.un()}}un(){const t=this.Gs.findIndex(e=>e.an===5);t!==-1&&this.Gs.splice(t,1)}}const Os=".";function Ut(s,t){if(!Xe(s))return"n/a";if(!ui(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return t===0?s.toString():("0000000000000000"+s.toString()).slice(-t)}class Ji{constructor(t,e){if(e||(e=1),Xe(t)&&ui(t)||(t=100),t<0)throw new TypeError("invalid base");this.Yi=t,this.Mn=e,this.bn()}format(t){const e=t<0?"−":"";return t=Math.abs(t),e+this.xn(t)}bn(){if(this.Sn=0,this.Yi>0&&this.Mn>0){let t=this.Yi;for(;t>1;)t/=10,this.Sn++}}xn(t){const e=this.Yi/this.Mn;let i=Math.floor(t),n="";const r=this.Sn!==void 0?this.Sn:NaN;if(e>1){let o=+(Math.round(t*e)-i*e).toFixed(this.Sn);o>=e&&(o-=e,i+=1),n=Os+Ut(+o.toFixed(this.Sn)*this.Mn,r)}else i=Math.round(i*e)/e,r>0&&(n=Os+Ut(0,r));return i.toFixed(0)+n}}class yo extends Ji{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class xu{constructor(t){this.Cn=t}format(t){let e="";return t<0&&(e="-",t=-t),t<995?e+this.yn(t):t<999995?e+this.yn(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this.yn(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.yn(t/1e9)+"B")}yn(t){let e;const i=Math.pow(10,this.Cn);return e=(t=Math.round(t*i)/i)>=1e-15&&t<1?t.toFixed(this.Cn).replace(/\.?0+$/,""):String(t),e.replace(/(\.[1-9]*)0+$/,(n,r)=>r)}}const Cu=/[2-9]/g;class Li{constructor(t=50){this.Pn=0,this.kn=1,this.Tn=1,this.Rn={},this.Dn=new Map,this.Vn=t}In(){this.Pn=0,this.Dn.clear(),this.kn=1,this.Tn=1,this.Rn={}}Vi(t,e,i){return this.Bn(t,e,i).width}Di(t,e,i){const n=this.Bn(t,e,i);return((n.actualBoundingBoxAscent||0)-(n.actualBoundingBoxDescent||0))/2}Bn(t,e,i){const n=i||Cu,r=String(e).replace(n,"0");if(this.Dn.has(r))return bt(this.Dn.get(r)).An;if(this.Pn===this.Vn){const a=this.Rn[this.Tn];delete this.Rn[this.Tn],this.Dn.delete(a),this.Tn++,this.Pn--}t.save(),t.textBaseline="middle";const o=t.measureText(r);return t.restore(),o.width===0&&e.length||(this.Dn.set(r,{An:o,En:this.kn}),this.Rn[this.kn]=r,this.Pn++,this.kn++),o}}class Mu{constructor(t){this.zn=null,this.M=null,this.Ln="right",this.On=t}Nn(t,e,i){this.zn=t,this.M=e,this.Ln=i}nt(t){this.M!==null&&this.zn!==null&&this.zn.nt(t,this.M,this.On,this.Ln)}}class wo{constructor(t,e,i){this.Wn=t,this.On=new Li(50),this.Fn=e,this.O=i,this.W=-1,this.Gt=new Mu(this.On)}Tt(){const t=this.O.Hn(this.Fn);if(t===null)return null;const e=t.Un(this.Fn)?t.$n():this.Fn.Wt();if(e===null)return null;const i=t.qn(e);if(i==="overlay")return null;const n=this.O.Yn();return n.P!==this.W&&(this.W=n.P,this.On.In()),this.Gt.Nn(this.Wn.$i(),n,i),this.Gt}}class Eu extends Pe{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}jn(t,e){var o;if(!((o=this.Yt)!=null&&o.Vt))return null;const{ut:i,ct:n,Zn:r}=this.Yt;return e>=i-n-7&&e<=i+n+7?{Kn:this.Yt,Zn:r}:null}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:n}){if(this.Yt===null||this.Yt.Vt===!1)return;const r=Math.round(this.Yt.ut*n);r<0||r>e.height||(t.lineCap="butt",t.strokeStyle=this.Yt.R,t.lineWidth=Math.floor(this.Yt.ct*i),Ye(t,this.Yt.Kt),vo(t,r,0,e.width))}}class ts{constructor(t){this.Xn={ut:0,R:"rgba(0, 0, 0, 0)",ct:1,Kt:0,Vt:!1},this.Gn=new Eu,this.St=!0,this.Jn=t,this.Qn=t.Qt(),this.Gn.ht(this.Xn)}Pt(){this.St=!0}Tt(){return this.Jn.Vt()?(this.St&&(this.te(),this.St=!1),this.Gn):null}}class Pu extends ts{constructor(t){super(t)}te(){this.Xn.Vt=!1;const t=this.Jn.Wt(),e=t.ie().ie;if(e!==2&&e!==3)return;const i=this.Jn.N();if(!i.baseLineVisible||!this.Jn.Vt())return;const n=this.Jn.zt();n!==null&&(this.Xn.Vt=!0,this.Xn.ut=t.Nt(n.Ft,n.Ft),this.Xn.R=i.baseLineColor,this.Xn.ct=i.baseLineWidth,this.Xn.Kt=i.baseLineStyle)}}class Iu extends Pe{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}se(){return this.Yt}et({context:t,horizontalPixelRatio:e,verticalPixelRatio:i}){const n=this.Yt;if(n===null)return;const r=Math.max(1,Math.floor(e)),o=r%2/2,a=Math.round(n.ne.x*e)+o,l=n.ne.y*i;t.fillStyle=n.ee,t.beginPath();const h=Math.max(2,1.5*n.re)*e;t.arc(a,l,h,0,2*Math.PI,!1),t.fill(),t.fillStyle=n.he,t.beginPath(),t.arc(a,l,n.ft*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=r,t.strokeStyle=n.ae,t.beginPath(),t.arc(a,l,n.ft*e+r/2,0,2*Math.PI,!1),t.stroke()}}const Tu=[{le:0,oe:.25,_e:4,ue:10,ce:.25,de:0,fe:.4,pe:.8},{le:.25,oe:.525,_e:10,ue:14,ce:0,de:0,fe:.8,pe:0},{le:.525,oe:1,_e:14,ue:14,ce:0,de:0,fe:0,pe:0}];class ku{constructor(t){this.Gt=new Iu,this.St=!0,this.ve=!0,this.me=performance.now(),this.we=this.me-1,this.ge=t}Me(){this.we=this.me-1,this.Pt()}be(){if(this.Pt(),this.ge.N().lastPriceAnimation===2){const t=performance.now(),e=this.we-t;if(e>0)return void(e<650&&(this.we+=2600));this.me=t,this.we=t+2600}}Pt(){this.St=!0}xe(){this.ve=!0}Vt(){return this.ge.N().lastPriceAnimation!==0}Se(){switch(this.ge.N().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.we}}Tt(){return this.St?(this.Rt(),this.St=!1,this.ve=!1):this.ve&&(this.Ce(),this.ve=!1),this.Gt}Rt(){this.Gt.ht(null);const t=this.ge.Qt().At(),e=t.ye(),i=this.ge.zt();if(e===null||i===null)return;const n=this.ge.Pe(!0);if(n.ke||!e.Te(n.Re))return;const r={x:t.qt(n.Re),y:this.ge.Wt().Nt(n.gt,i.Ft)},o=n.R,a=this.ge.N().lineWidth,l=this.De(this.Ve(),o);this.Gt.ht({ee:o,re:a,he:l.he,ae:l.ae,ft:l.ft,ne:r})}Ce(){const t=this.Gt.se();if(t!==null){const e=this.De(this.Ve(),t.ee);t.he=e.he,t.ae=e.ae,t.ft=e.ft}}Ve(){return this.Se()?performance.now()-this.me:2599}Ie(t,e,i,n){const r=i+(n-i)*e;return this.ge.Qt().Ki().j(t,r)}De(t,e){const i=t%2600/2600;let n;for(const h of Tu)if(i>=h.le&&i<=h.oe){n=h;break}_t(n!==void 0,"Last price animation internal logic error");const r=(i-n.le)/(n.oe-n.le);return{he:this.Ie(e,r,n.ce,n.de),ae:this.Ie(e,r,n.fe,n.pe),ft:(o=r,a=n._e,l=n.ue,a+(l-a)*o)};var o,a,l}}class Du extends ts{constructor(t){super(t)}te(){const t=this.Xn;t.Vt=!1;const e=this.Jn.N();if(!e.priceLineVisible||!this.Jn.Vt())return;const i=this.Jn.Pe(e.priceLineSource===0);i.ke||(t.Vt=!0,t.ut=i.Bi,t.R=this.Jn.Be(i.R),t.ct=e.priceLineWidth,t.Kt=e.priceLineStyle)}}class Au extends Gi{constructor(t){super(),this.Jt=t}qi(t,e,i){t.Vt=!1,e.Vt=!1;const n=this.Jt;if(!n.Vt())return;const r=n.N(),o=r.lastValueVisible,a=n.Ae()!=="",l=r.seriesLastValueMode===0,h=n.Pe(!1);if(h.ke)return;o&&(t.ri=this.Ee(h,o,l),t.Vt=t.ri.length!==0),(a||l)&&(e.ri=this.ze(h,o,a,l),e.Vt=e.ri.length>0);const u=n.Be(h.R),c=this.Jt.Qt().Ki().K(u);i.X=c.X,i.Bi=h.Bi,e.Ht=n.Qt().Ut(h.Bi/n.Wt().$t()),t.Ht=u,t.R=c.G,e.R=c.G}ze(t,e,i,n){let r="";const o=this.Jt.Ae();return i&&o.length!==0&&(r+=`${o} `),e&&n&&(r+=this.Jt.Wt().Le()?t.Oe:t.Ne),r.trim()}Ee(t,e,i){return e?i?this.Jt.Wt().Le()?t.Ne:t.Oe:t.ri:""}}function Ws(s,t,e,i){const n=Number.isFinite(t),r=Number.isFinite(e);return n&&r?s(t,e):n||r?n?t:e:i}class wt{constructor(t,e){this.We=t,this.Fe=e}He(t){return t!==null&&this.We===t.We&&this.Fe===t.Fe}Ue(){return new wt(this.We,this.Fe)}$e(){return this.We}qe(){return this.Fe}Ye(){return this.Fe-this.We}Zi(){return this.Fe===this.We||Number.isNaN(this.Fe)||Number.isNaN(this.We)}vn(t){return t===null?this:new wt(Ws(Math.min,this.$e(),t.$e(),-1/0),Ws(Math.max,this.qe(),t.qe(),1/0))}je(t){if(!Xe(t)||this.Fe-this.We===0)return;const e=.5*(this.Fe+this.We);let i=this.Fe-e,n=this.We-e;i*=t,n*=t,this.Fe=e+i,this.We=e+n}Ze(t){Xe(t)&&(this.Fe+=t,this.We+=t)}Ke(){return{minValue:this.We,maxValue:this.Fe}}static Xe(t){return t===null?null:new wt(t.minValue,t.maxValue)}}class Ni{constructor(t,e){this.Ge=t,this.Je=e||null}Qe(){return this.Ge}tr(){return this.Je}Ke(){return{priceRange:this.Ge===null?null:this.Ge.Ke(),margins:this.Je||void 0}}static Xe(t){return t===null?null:new Ni(wt.Xe(t.priceRange),t.margins)}}class Ru extends ts{constructor(t,e){super(t),this.ir=e}te(){const t=this.Xn;t.Vt=!1;const e=this.ir.N();if(!this.Jn.Vt()||!e.lineVisible)return;const i=this.ir.sr();i!==null&&(t.Vt=!0,t.ut=i,t.R=e.color,t.ct=e.lineWidth,t.Kt=e.lineStyle,t.Zn=this.ir.N().id)}}class Fu extends Gi{constructor(t,e){super(),this.ge=t,this.ir=e}qi(t,e,i){t.Vt=!1,e.Vt=!1;const n=this.ir.N(),r=n.axisLabelVisible,o=n.title!=="",a=this.ge;if(!r||!a.Vt())return;const l=this.ir.sr();if(l===null)return;o&&(e.ri=n.title,e.Vt=!0),e.Ht=a.Qt().Ut(l/a.Wt().$t()),t.ri=this.nr(n.price),t.Vt=!0;const h=this.ge.Qt().Ki().K(n.axisLabelColor||n.color);i.X=h.X;const u=n.axisLabelTextColor||h.G;t.R=u,e.R=u,i.Bi=l}nr(t){const e=this.ge.zt();return e===null?"":this.ge.Wt().Xi(t,e.Ft)}}class Bu{constructor(t,e){this.ge=t,this.ys=e,this.er=new Ru(t,this),this.Wn=new Fu(t,this),this.rr=new wo(this.Wn,t,t.Qt())}hr(t){xt(this.ys,t),this.Pt(),this.ge.Qt().ar()}N(){return this.ys}lr(){return this.er}_r(){return this.rr}ur(){return this.Wn}Pt(){this.er.Pt(),this.Wn.Pt()}sr(){const t=this.ge,e=t.Wt();if(t.Qt().At().Zi()||e.Zi())return null;const i=t.zt();return i===null?null:e.Nt(this.ys.price,i.Ft)}}class Vu extends _o{constructor(t){super(),this.ts=t}Qt(){return this.ts}}const Lu={Bar:(s,t,e,i)=>{const n=t.upColor,r=t.downColor,o=D(s(e,i)),a=ge(o.Ft[0])<=ge(o.Ft[3]);return{cr:o.R??(a?n:r)}},Candlestick:(s,t,e,i)=>{const n=t.upColor,r=t.downColor,o=t.borderUpColor,a=t.borderDownColor,l=t.wickUpColor,h=t.wickDownColor,u=D(s(e,i)),c=ge(u.Ft[0])<=ge(u.Ft[3]);return{cr:u.R??(c?n:r),dr:u.Ht??(c?o:a),pr:u.vr??(c?l:h)}},Custom:(s,t,e,i)=>({cr:D(s(e,i)).R??t.color}),Area:(s,t,e,i)=>{const n=D(s(e,i));return{cr:n.vt??t.lineColor,vt:n.vt??t.lineColor,mr:n.mr??t.topColor,wr:n.wr??t.bottomColor}},Baseline:(s,t,e,i)=>{const n=D(s(e,i));return{cr:n.Ft[3]>=t.baseValue.price?t.topLineColor:t.bottomLineColor,gr:n.gr??t.topLineColor,Mr:n.Mr??t.bottomLineColor,br:n.br??t.topFillColor1,Sr:n.Sr??t.topFillColor2,Cr:n.Cr??t.bottomFillColor1,yr:n.yr??t.bottomFillColor2}},Line:(s,t,e,i)=>{const n=D(s(e,i));return{cr:n.R??t.color,vt:n.R??t.color}},Histogram:(s,t,e,i)=>({cr:D(s(e,i)).R??t.color})};class Nu{constructor(t){this.Pr=(e,i)=>i!==void 0?i.Ft:this.ge.Ks().kr(e),this.ge=t,this.Tr=Lu[t.Rr()]}Dr(t,e){return this.Tr(this.Pr,this.ge.N(),t,e)}}function bo(s,t,e,i,n=0,r=t.length){let o=r-n;for(;0<o;){const a=o>>1,l=n+a;i(t[l],e)===s?(n=l+1,o-=a+1):o=a}return n}const $e=bo.bind(null,!0),So=bo.bind(null,!1);var Ys;(function(s){s[s.NearestLeft=-1]="NearestLeft",s[s.None=0]="None",s[s.NearestRight=1]="NearestRight"})(Ys||(Ys={}));const re=30;class zu{constructor(){this.Vr=[],this.Ir=new Map,this.Br=new Map,this.Ar=[]}Er(){return this.zr()>0?this.Vr[this.Vr.length-1]:null}Lr(){return this.zr()>0?this.Or(0):null}Zs(){return this.zr()>0?this.Or(this.Vr.length-1):null}zr(){return this.Vr.length}Zi(){return this.zr()===0}Te(t){return this.Nr(t,0)!==null}kr(t){return this.Wr(t)}Wr(t,e=0){const i=this.Nr(t,e);return i===null?null:{...this.Fr(i),Re:this.Or(i)}}Hr(){return this.Vr}Ur(t,e,i){if(this.Zi())return null;let n=null;for(const r of i)n=Si(n,this.$r(t,e,r));return n}ht(t){this.Br.clear(),this.Ir.clear(),this.Vr=t,this.Ar=t.map(e=>e.Re)}qr(){return this.Ar}Or(t){return this.Vr[t].Re}Fr(t){return this.Vr[t]}Nr(t,e){const i=this.Yr(t);if(i===null&&e!==0)switch(e){case-1:return this.jr(t);case 1:return this.Zr(t);default:throw new TypeError("Unknown search mode")}return i}jr(t){let e=this.Kr(t);return e>0&&(e-=1),e!==this.Vr.length&&this.Or(e)<t?e:null}Zr(t){const e=this.Xr(t);return e!==this.Vr.length&&t<this.Or(e)?e:null}Yr(t){const e=this.Kr(t);return e===this.Vr.length||t<this.Vr[e].Re?null:e}Kr(t){return $e(this.Vr,t,(e,i)=>e.Re<i)}Xr(t){return So(this.Vr,t,(e,i)=>e.Re>i)}Gr(t,e,i){let n=null;for(let r=t;r<e;r++){const o=this.Vr[r].Ft[i];Number.isNaN(o)||(n===null?n={Jr:o,Qr:o}:(o<n.Jr&&(n.Jr=o),o>n.Qr&&(n.Qr=o)))}return n}$r(t,e,i){if(this.Zi())return null;let n=null;const r=D(this.Lr()),o=D(this.Zs()),a=Math.max(t,r),l=Math.min(e,o),h=Math.ceil(a/re)*re,u=Math.max(h,Math.floor(l/re)*re);{const d=this.Kr(a),f=this.Xr(Math.min(l,h,e));n=Si(n,this.Gr(d,f,i))}let c=this.Ir.get(i);c===void 0&&(c=new Map,this.Ir.set(i,c));for(let d=Math.max(h+1,a);d<u;d+=re){const f=Math.floor(d/re);let v=c.get(f);if(v===void 0){const p=this.Kr(f*re),g=this.Xr((f+1)*re-1);v=this.Gr(p,g,i),c.set(f,v)}n=Si(n,v)}{const d=this.Kr(u),f=this.Xr(l);n=Si(n,this.Gr(d,f,i))}return n}}function Si(s,t){return s===null?t:t===null?s:{Jr:Math.min(s.Jr,t.Jr),Qr:Math.max(s.Qr,t.Qr)}}class Ou{constructor(t){this.th=t}nt(t,e,i){this.th.draw(t)}ih(t,e,i){var n,r;(r=(n=this.th).drawBackground)==null||r.call(n,t)}}class Wu{constructor(t){this.Dn=null,this.sh=t}Tt(){var i;const t=this.sh.renderer();if(t===null)return null;if(((i=this.Dn)==null?void 0:i.nh)===t)return this.Dn.eh;const e=new Ou(t);return this.Dn={nh:t,eh:e},e}rh(){var t,e;return((e=(t=this.sh).zOrder)==null?void 0:e.call(t))??"normal"}}class xo{constructor(t){this.hh=null,this.ah=t}oh(){return this.ah}Ns(){var t,e;(e=(t=this.ah).updateAllViews)==null||e.call(t)}Ws(){var i,n,r;const t=((n=(i=this.ah).paneViews)==null?void 0:n.call(i))??[];if(((r=this.hh)==null?void 0:r.nh)===t)return this.hh.eh;const e=t.map(o=>new Wu(o));return this.hh={nh:t,eh:e},e}jn(t,e){var i,n;return((n=(i=this.ah).hitTest)==null?void 0:n.call(i,t,e))??null}}let Yu=class extends xo{us(){return[]}};class Xu{constructor(t){this.th=t}nt(t,e,i){this.th.draw(t)}ih(t,e,i){var n,r;(r=(n=this.th).drawBackground)==null||r.call(n,t)}}class Xs{constructor(t){this.Dn=null,this.sh=t}Tt(){var i;const t=this.sh.renderer();if(t===null)return null;if(((i=this.Dn)==null?void 0:i.nh)===t)return this.Dn.eh;const e=new Xu(t);return this.Dn={nh:t,eh:e},e}rh(){var t,e;return((e=(t=this.sh).zOrder)==null?void 0:e.call(t))??"normal"}}function Co(s){var t,e,i;return{ri:s.text(),Bi:s.coordinate(),Ii:(t=s.fixedCoordinate)==null?void 0:t.call(s),R:s.textColor(),X:s.backColor(),Vt:((e=s.visible)==null?void 0:e.call(s))??!0,pi:((i=s.tickVisible)==null?void 0:i.call(s))??!0}}class $u{constructor(t,e){this.Gt=new mo,this._h=t,this.uh=e}Tt(){return this.Gt.ht({Qi:this.uh.Qi(),...Co(this._h)}),this.Gt}}class Hu extends Gi{constructor(t,e){super(),this._h=t,this.Yi=e}qi(t,e,i){const n=Co(this._h);i.X=n.X,t.R=n.R;const r=2/12*this.Yi.P();i.Ti=r,i.Ri=r,i.Bi=n.Bi,i.Ii=n.Ii,t.ri=n.ri,t.Vt=n.Vt,t.pi=n.pi}}class Qu extends xo{constructor(t,e){super(t),this.dh=null,this.fh=null,this.ph=null,this.mh=null,this.ge=e}cs(){var n,r,o;const t=((r=(n=this.ah).timeAxisViews)==null?void 0:r.call(n))??[];if(((o=this.dh)==null?void 0:o.nh)===t)return this.dh.eh;const e=this.ge.Qt().At(),i=t.map(a=>new $u(a,e));return this.dh={nh:t,eh:i},i}Fs(){var n,r,o;const t=((r=(n=this.ah).priceAxisViews)==null?void 0:r.call(n))??[];if(((o=this.fh)==null?void 0:o.nh)===t)return this.fh.eh;const e=this.ge.Wt(),i=t.map(a=>new Hu(a,e));return this.fh={nh:t,eh:i},i}wh(){var i,n,r;const t=((n=(i=this.ah).priceAxisPaneViews)==null?void 0:n.call(i))??[];if(((r=this.ph)==null?void 0:r.nh)===t)return this.ph.eh;const e=t.map(o=>new Xs(o));return this.ph={nh:t,eh:e},e}gh(){var i,n,r;const t=((n=(i=this.ah).timeAxisPaneViews)==null?void 0:n.call(i))??[];if(((r=this.mh)==null?void 0:r.nh)===t)return this.mh.eh;const e=t.map(o=>new Xs(o));return this.mh={nh:t,eh:e},e}Mh(t,e){var i,n;return((n=(i=this.ah).autoscaleInfo)==null?void 0:n.call(i,t,e))??null}}function vn(s,t,e,i){s.forEach(n=>{t(n).forEach(r=>{r.rh()===e&&i.push(r)})})}function pn(s){return s.Ws()}function ju(s){return s.wh()}function Gu(s){return s.gh()}const Uu=["Area","Line","Baseline"];class Zi extends Vu{constructor(t,e,i,n,r){super(t),this.Yt=new zu,this.er=new Du(this),this.bh=[],this.xh=new Pu(this),this.Sh=null,this.Ch=null,this.yh=null,this.Ph=[],this.ys=i,this.kh=e;const o=new Au(this);this.vs=[o],this.rr=new wo(o,this,t),Uu.includes(this.kh)&&(this.Sh=new ku(this)),this.Th(),this.sh=n(this,this.Qt(),r)}m(){this.yh!==null&&clearTimeout(this.yh)}Be(t){return this.ys.priceLineColor||t}Pe(t){const e={ke:!0},i=this.Wt();if(this.Qt().At().Zi()||i.Zi()||this.Yt.Zi())return e;const n=this.Qt().At().ye(),r=this.zt();if(n===null||r===null)return e;let o,a;if(t){const c=this.Yt.Er();if(c===null)return e;o=c,a=c.Re}else{const c=this.Yt.Wr(n.bi(),-1);if(c===null||(o=this.Yt.kr(c.Re),o===null))return e;a=c.Re}const l=o.Ft[3],h=this.Rh().Dr(a,{Ft:o}),u=i.Nt(l,r.Ft);return{ke:!1,gt:l,ri:i.Xi(l,r.Ft),Oe:i.Dh(l),Ne:i.Vh(l,r.Ft),R:h.cr,Bi:u,Re:a}}Rh(){return this.Ch!==null||(this.Ch=new Nu(this)),this.Ch}N(){return this.ys}hr(t){const e=t.priceScaleId;e!==void 0&&e!==this.ys.priceScaleId&&this.Qt().Ih(this,e),xt(this.ys,t),t.priceFormat!==void 0&&(this.Th(),this.Qt().Bh()),this.Qt().Ah(this),this.Qt().Eh(),this.sh.Pt("options")}ht(t,e){this.Yt.ht(t),this.sh.Pt("data"),this.Sh!==null&&(e&&e.zh?this.Sh.be():t.length===0&&this.Sh.Me());const i=this.Qt().Hn(this);this.Qt().Lh(i),this.Qt().Ah(this),this.Qt().Eh(),this.Qt().ar()}Oh(t){const e=new Bu(this,t);return this.bh.push(e),this.Qt().Ah(this),e}Nh(t){const e=this.bh.indexOf(t);e!==-1&&this.bh.splice(e,1),this.Qt().Ah(this)}Wh(){return this.bh}Rr(){return this.kh}zt(){const t=this.Fh();return t===null?null:{Ft:t.Ft[3],Hh:t.wt}}Fh(){const t=this.Qt().At().ye();if(t===null)return null;const e=t.Uh();return this.Yt.Wr(e,1)}Ks(){return this.Yt}$h(t){const e=this.Yt.kr(t);return e===null?null:this.kh==="Bar"||this.kh==="Candlestick"||this.kh==="Custom"?{qh:e.Ft[0],Yh:e.Ft[1],jh:e.Ft[2],Zh:e.Ft[3]}:e.Ft[3]}Kh(t){const e=[];vn(this.Ph,pn,"top",e);const i=this.Sh;return i!==null&&i.Vt()&&(this.yh===null&&i.Se()&&(this.yh=setTimeout(()=>{this.yh=null,this.Qt().Xh()},0)),i.xe(),e.unshift(i)),e}Ws(){const t=[];this.Gh()||t.push(this.xh),t.push(this.sh,this.er);const e=this.bh.map(i=>i.lr());return t.push(...e),vn(this.Ph,pn,"normal",t),t}Jh(){return this.Qh(pn,"bottom")}ta(t){return this.Qh(ju,t)}ia(t){return this.Qh(Gu,t)}sa(t,e){return this.Ph.map(i=>i.jn(t,e)).filter(i=>i!==null)}us(){return[this.rr,...this.bh.map(t=>t._r())]}Fs(t,e){if(e!==this.es&&!this.Gh())return[];const i=[...this.vs];for(const n of this.bh)i.push(n.ur());return this.Ph.forEach(n=>{i.push(...n.Fs())}),i}cs(){const t=[];return this.Ph.forEach(e=>{t.push(...e.cs())}),t}Mh(t,e){if(this.ys.autoscaleInfoProvider!==void 0){const i=this.ys.autoscaleInfoProvider(()=>{const n=this.na(t,e);return n===null?null:n.Ke()});return Ni.Xe(i)}return this.na(t,e)}ea(){return this.ys.priceFormat.minMove}ra(){return this.ha}Ns(){var t;this.sh.Pt();for(const e of this.vs)e.Pt();for(const e of this.bh)e.Pt();this.er.Pt(),this.xh.Pt(),(t=this.Sh)==null||t.Pt(),this.Ph.forEach(e=>e.Ns())}Wt(){return D(super.Wt())}Et(t){if(!((this.kh==="Line"||this.kh==="Area"||this.kh==="Baseline")&&this.ys.crosshairMarkerVisible))return null;const e=this.Yt.kr(t);return e===null?null:{gt:e.Ft[3],ft:this.aa(),Ht:this.la(),Ot:this.oa(),Lt:this._a(t)}}Ae(){return this.ys.title}Vt(){return this.ys.visible}ua(t){this.Ph.push(new Qu(t,this))}ca(t){this.Ph=this.Ph.filter(e=>e.oh()!==t)}da(){if(this.kh==="Custom")return t=>this.sh.fa(t)}pa(){if(this.kh==="Custom")return t=>this.sh.va(t)}ma(){return this.Yt.qr()}Gh(){return!Ui(this.Wt().wa())}na(t,e){if(!ui(t)||!ui(e)||this.Yt.Zi())return null;const i=this.kh==="Line"||this.kh==="Area"||this.kh==="Baseline"||this.kh==="Histogram"?[3]:[2,1],n=this.Yt.Ur(t,e,i);let r=n!==null?new wt(n.Jr,n.Qr):null,o=null;if(this.Rr()==="Histogram"){const a=this.ys.base,l=new wt(a,a);r=r!==null?r.vn(l):l}return this.Ph.forEach(a=>{const l=a.Mh(t,e);if(l!=null&&l.priceRange){const h=new wt(l.priceRange.minValue,l.priceRange.maxValue);r=r!==null?r.vn(h):h}l!=null&&l.margins&&(o=l.margins)}),new Ni(r,o)}aa(){switch(this.kh){case"Line":case"Area":case"Baseline":return this.ys.crosshairMarkerRadius}return 0}la(){switch(this.kh){case"Line":case"Area":case"Baseline":{const t=this.ys.crosshairMarkerBorderColor;if(t.length!==0)return t}}return null}oa(){switch(this.kh){case"Line":case"Area":case"Baseline":return this.ys.crosshairMarkerBorderWidth}return 0}_a(t){switch(this.kh){case"Line":case"Area":case"Baseline":{const e=this.ys.crosshairMarkerBackgroundColor;if(e.length!==0)return e}}return this.Rh().Dr(t).cr}Th(){switch(this.ys.priceFormat.type){case"custom":this.ha={format:this.ys.priceFormat.formatter};break;case"volume":this.ha=new xu(this.ys.priceFormat.precision);break;case"percent":this.ha=new yo(this.ys.priceFormat.precision);break;default:{const t=Math.pow(10,this.ys.priceFormat.precision);this.ha=new Ji(t,this.ys.priceFormat.minMove*t)}}this.es!==null&&this.es.ga()}Qh(t,e){const i=[];return vn(this.Ph,t,e,i),i}}const Ju=[3],Zu=[0,1,2,3];class Ku{constructor(t){this.ys=t}Ma(t,e,i){let n=t;if(this.ys.mode===0)return n;const r=i.ks(),o=r.zt();if(o===null)return n;const a=r.Nt(t,o),l=i.ba().filter(u=>u instanceof Zi).reduce((u,c)=>{if(i.Un(c)||!c.Vt())return u;const d=c.Wt(),f=c.Ks();if(d.Zi()||!f.Te(e))return u;const v=f.kr(e);if(v===null)return u;const p=ge(c.zt()),g=this.ys.mode===3?Zu:Ju;return u.concat(g.map(m=>d.Nt(v.Ft[m],p.Ft)))},[]);if(l.length===0)return n;l.sort((u,c)=>Math.abs(u-a)-Math.abs(c-a));const h=l[0];return n=r.Ts(h,o),n}}class qu extends Pe{constructor(){super(...arguments),this.Yt=null}ht(t){this.Yt=t}et({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:n}){if(this.Yt===null)return;const r=Math.max(1,Math.floor(i));t.lineWidth=r,function(o,a){o.save(),o.lineWidth%2&&o.translate(.5,.5),a(),o.restore()}(t,()=>{const o=D(this.Yt);if(o.xa){t.strokeStyle=o.Sa,Ye(t,o.Ca),t.beginPath();for(const a of o.ya){const l=Math.round(a.Pa*i);t.moveTo(l,-r),t.lineTo(l,e.height+r)}t.stroke()}if(o.ka){t.strokeStyle=o.Ta,Ye(t,o.Ra),t.beginPath();for(const a of o.Da){const l=Math.round(a.Pa*n);t.moveTo(-r,l),t.lineTo(e.width+r,l)}t.stroke()}})}}class tc{constructor(t){this.Gt=new qu,this.St=!0,this.yt=t}Pt(){this.St=!0}Tt(){if(this.St){const t=this.yt.Qt().N().grid,e={ka:t.horzLines.visible,xa:t.vertLines.visible,Ta:t.horzLines.color,Sa:t.vertLines.color,Ra:t.horzLines.style,Ca:t.vertLines.style,Da:this.yt.ks().Va(),ya:(this.yt.Qt().At().Va()||[]).map(i=>({Pa:i.coord}))};this.Gt.ht(e),this.St=!1}return this.Gt}}class ec{constructor(t){this.sh=new tc(t)}lr(){return this.sh}}const gn={Ia:4,Ba:1e-4};function Fe(s,t){const e=100*(s-t)/t;return t<0?-e:e}function ic(s,t){const e=Fe(s.$e(),t),i=Fe(s.qe(),t);return new wt(e,i)}function ri(s,t){const e=100*(s-t)/t+100;return t<0?-e:e}function nc(s,t){const e=ri(s.$e(),t),i=ri(s.qe(),t);return new wt(e,i)}function zi(s,t){const e=Math.abs(s);if(e<1e-15)return 0;const i=Math.log10(e+t.Ba)+t.Ia;return s<0?-i:i}function oi(s,t){const e=Math.abs(s);if(e<1e-15)return 0;const i=Math.pow(10,e-t.Ia)-t.Ba;return s<0?-i:i}function ti(s,t){if(s===null)return null;const e=zi(s.$e(),t),i=zi(s.qe(),t);return new wt(e,i)}function xi(s,t){if(s===null)return null;const e=oi(s.$e(),t),i=oi(s.qe(),t);return new wt(e,i)}function mn(s){if(s===null)return gn;const t=Math.abs(s.qe()-s.$e());if(t>=1||t<1e-15)return gn;const e=Math.ceil(Math.abs(Math.log10(t))),i=gn.Ia+e;return{Ia:i,Ba:1/Math.pow(10,i)}}function Ti(s,t,e){return Math.min(Math.max(s,t),e)}function Ci(s,t,e){return t-s<=e}class _n{constructor(t,e){if(this.Aa=t,this.Ea=e,function(i){if(i<0)return!1;for(let n=i;n>1;n/=10)if(n%10!=0)return!1;return!0}(this.Aa))this.za=[2,2.5,2];else{this.za=[];for(let i=this.Aa;i!==1;){if(i%2==0)this.za.push(2),i/=2;else{if(i%5!=0)throw new Error("unexpected base");this.za.push(2,2.5),i/=5}if(this.za.length>100)throw new Error("something wrong with base")}}}La(t,e,i){const n=this.Aa===0?0:1/this.Aa;let r=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-e)))),o=0,a=this.Ea[0];for(;;){const c=Ci(r,n,1e-14)&&r>n+1e-14,d=Ci(r,i*a,1e-14),f=Ci(r,1,1e-14);if(!(c&&d&&f))break;r/=a,a=this.Ea[++o%this.Ea.length]}if(r<=n+1e-14&&(r=n),r=Math.max(1,r),this.za.length>0&&(l=r,h=1,u=1e-14,Math.abs(l-h)<u))for(o=0,a=this.za[0];Ci(r,i*a,1e-14)&&r>n+1e-14;)r/=a,a=this.za[++o%this.za.length];var l,h,u;return r}}class $s{constructor(t,e,i,n){this.Oa=[],this.Yi=t,this.Aa=e,this.Na=i,this.Wa=n}La(t,e){if(t<e)throw new Error("high < low");const i=this.Yi.$t(),n=(t-e)*this.Fa()/i,r=new _n(this.Aa,[2,2.5,2]),o=new _n(this.Aa,[2,2,2.5]),a=new _n(this.Aa,[2.5,2,2]),l=[];return l.push(r.La(t,e,n),o.La(t,e,n),a.La(t,e,n)),function(h){if(h.length<1)throw Error("array is empty");let u=h[0];for(let c=1;c<h.length;++c)h[c]<u&&(u=h[c]);return u}(l)}Ha(){const t=this.Yi,e=t.zt();if(e===null)return void(this.Oa=[]);const i=t.$t(),n=this.Na(i-1,e),r=this.Na(0,e),o=this.Yi.N().entireTextOnly?this.Ua()/2:0,a=o,l=i-1-o,h=Math.max(n,r),u=Math.min(n,r);if(h===u)return void(this.Oa=[]);let c=this.La(h,u),d=h%c;d+=d<0?c:0;const f=h>=u?1:-1;let v=null,p=0;for(let g=h-d;g>u;g-=c){const m=this.Wa(g,e,!0);v!==null&&Math.abs(m-v)<this.Fa()||m<a||m>l||(p<this.Oa.length?(this.Oa[p].Pa=m,this.Oa[p].$a=t.qa(g)):this.Oa.push({Pa:m,$a:t.qa(g)}),p++,v=m,t.Ya()&&(c=this.La(g*f,u)))}this.Oa.length=p}Va(){return this.Oa}Ua(){return this.Yi.P()}Fa(){return Math.ceil(2.5*this.Ua())}}function Mo(s){return s.slice().sort((t,e)=>D(t.hs())-D(e.hs()))}var Hs;(function(s){s[s.Normal=0]="Normal",s[s.Logarithmic=1]="Logarithmic",s[s.Percentage=2]="Percentage",s[s.IndexedTo100=3]="IndexedTo100"})(Hs||(Hs={}));const Qs=new yo,js=new Ji(100,1);class sc{constructor(t,e,i,n,r){this.ja=0,this.Za=null,this.Ge=null,this.Ka=null,this.Xa={Ga:!1,Ja:null},this.Qa=0,this.tl=0,this.il=new lt,this.sl=new lt,this.nl=[],this.el=null,this.rl=null,this.hl=null,this.al=null,this.ha=js,this.ll=mn(null),this.ol=t,this.ys=e,this._l=i,this.ul=n,this.cl=r,this.dl=new $s(this,100,this.fl.bind(this),this.pl.bind(this))}wa(){return this.ol}N(){return this.ys}hr(t){if(xt(this.ys,t),this.ga(),t.mode!==void 0&&this.vl({ie:t.mode}),t.scaleMargins!==void 0){const e=bt(t.scaleMargins.top),i=bt(t.scaleMargins.bottom);if(e<0||e>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${e}`);if(i<0||i>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${i}`);if(e+i>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${e+i}`);this.ml(),this.rl=null}}wl(){return this.ys.autoScale}Ya(){return this.ys.mode===1}Le(){return this.ys.mode===2}gl(){return this.ys.mode===3}ie(){return{sn:this.ys.autoScale,Ml:this.ys.invertScale,ie:this.ys.mode}}vl(t){const e=this.ie();let i=null;t.sn!==void 0&&(this.ys.autoScale=t.sn),t.ie!==void 0&&(this.ys.mode=t.ie,t.ie!==2&&t.ie!==3||(this.ys.autoScale=!0),this.Xa.Ga=!1),e.ie===1&&t.ie!==e.ie&&(function(r,o){if(r===null)return!1;const a=oi(r.$e(),o),l=oi(r.qe(),o);return isFinite(a)&&isFinite(l)}(this.Ge,this.ll)?(i=xi(this.Ge,this.ll),i!==null&&this.bl(i)):this.ys.autoScale=!0),t.ie===1&&t.ie!==e.ie&&(i=ti(this.Ge,this.ll),i!==null&&this.bl(i));const n=e.ie!==this.ys.mode;n&&(e.ie===2||this.Le())&&this.ga(),n&&(e.ie===3||this.gl())&&this.ga(),t.Ml!==void 0&&e.Ml!==t.Ml&&(this.ys.invertScale=t.Ml,this.xl()),this.sl.p(e,this.ie())}Sl(){return this.sl}P(){return this._l.fontSize}$t(){return this.ja}Cl(t){this.ja!==t&&(this.ja=t,this.ml(),this.rl=null)}yl(){if(this.Za)return this.Za;const t=this.$t()-this.Pl()-this.kl();return this.Za=t,t}Qe(){return this.Tl(),this.Ge}bl(t,e){const i=this.Ge;(e||i===null&&t!==null||i!==null&&!i.He(t))&&(this.rl=null,this.Ge=t)}Zi(){return this.Tl(),this.ja===0||!this.Ge||this.Ge.Zi()}Rl(t){return this.Ml()?t:this.$t()-1-t}Nt(t,e){return this.Le()?t=Fe(t,e):this.gl()&&(t=ri(t,e)),this.pl(t,e)}Dl(t,e,i){this.Tl();const n=this.kl(),r=D(this.Qe()),o=r.$e(),a=r.qe(),l=this.yl()-1,h=this.Ml(),u=l/(a-o),c=i===void 0?0:i.from,d=i===void 0?t.length:i.to,f=this.Vl();for(let v=c;v<d;v++){const p=t[v],g=p.gt;if(isNaN(g))continue;let m=g;f!==null&&(m=f(p.gt,e));const _=n+u*(m-o),w=h?_:this.ja-1-_;p.ut=w}}Il(t,e,i){this.Tl();const n=this.kl(),r=D(this.Qe()),o=r.$e(),a=r.qe(),l=this.yl()-1,h=this.Ml(),u=l/(a-o),c=i===void 0?0:i.from,d=i===void 0?t.length:i.to,f=this.Vl();for(let v=c;v<d;v++){const p=t[v];let g=p.qh,m=p.Yh,_=p.jh,w=p.Zh;f!==null&&(g=f(p.qh,e),m=f(p.Yh,e),_=f(p.jh,e),w=f(p.Zh,e));let y=n+u*(g-o),x=h?y:this.ja-1-y;p.Bl=x,y=n+u*(m-o),x=h?y:this.ja-1-y,p.Al=x,y=n+u*(_-o),x=h?y:this.ja-1-y,p.El=x,y=n+u*(w-o),x=h?y:this.ja-1-y,p.zl=x}}Ts(t,e){const i=this.fl(t,e);return this.Ll(i,e)}Ll(t,e){let i=t;return this.Le()?i=function(n,r){return r<0&&(n=-n),n/100*r+r}(i,e):this.gl()&&(i=function(n,r){return n-=100,r<0&&(n=-n),n/100*r+r}(i,e)),i}ba(){return this.nl}Dt(){if(this.el)return this.el;let t=[];for(let e=0;e<this.nl.length;e++){const i=this.nl[e];i.hs()===null&&i.ls(e+1),t.push(i)}return t=Mo(t),this.el=t,this.el}Ol(t){this.nl.indexOf(t)===-1&&(this.nl.push(t),this.ga(),this.Nl())}Wl(t){const e=this.nl.indexOf(t);if(e===-1)throw new Error("source is not attached to scale");this.nl.splice(e,1),this.nl.length===0&&(this.vl({sn:!0}),this.bl(null)),this.ga(),this.Nl()}zt(){let t=null;for(const e of this.nl){const i=e.zt();i!==null&&(t===null||i.Hh<t.Hh)&&(t=i)}return t===null?null:t.Ft}Ml(){return this.ys.invertScale}Va(){const t=this.zt()===null;if(this.rl!==null&&(t||this.rl.Fl===t))return this.rl.Va;this.dl.Ha();const e=this.dl.Va();return this.rl={Va:e,Fl:t},this.il.p(),e}Hl(){return this.il}Ul(t){this.Le()||this.gl()||this.hl===null&&this.Ka===null&&(this.Zi()||(this.hl=this.ja-t,this.Ka=D(this.Qe()).Ue()))}$l(t){if(this.Le()||this.gl()||this.hl===null)return;this.vl({sn:!1}),(t=this.ja-t)<0&&(t=0);let e=(this.hl+.2*(this.ja-1))/(t+.2*(this.ja-1));const i=D(this.Ka).Ue();e=Math.max(e,.1),i.je(e),this.bl(i)}ql(){this.Le()||this.gl()||(this.hl=null,this.Ka=null)}Yl(t){this.wl()||this.al===null&&this.Ka===null&&(this.Zi()||(this.al=t,this.Ka=D(this.Qe()).Ue()))}jl(t){if(this.wl()||this.al===null)return;const e=D(this.Qe()).Ye()/(this.yl()-1);let i=t-this.al;this.Ml()&&(i*=-1);const n=i*e,r=D(this.Ka).Ue();r.Ze(n),this.bl(r,!0),this.rl=null}Zl(){this.wl()||this.al!==null&&(this.al=null,this.Ka=null)}ra(){return this.ha||this.ga(),this.ha}Xi(t,e){switch(this.ys.mode){case 2:return this.Kl(Fe(t,e));case 3:return this.ra().format(ri(t,e));default:return this.nr(t)}}qa(t){switch(this.ys.mode){case 2:return this.Kl(t);case 3:return this.ra().format(t);default:return this.nr(t)}}Dh(t){return this.nr(t,D(this.Xl()).ra())}Vh(t,e){return t=Fe(t,e),this.Kl(t,Qs)}Gl(){return this.nl}Jl(t){this.Xa={Ja:t,Ga:!1}}Ns(){this.nl.forEach(t=>t.Ns())}ga(){this.rl=null;const t=this.Xl();let e=100;t!==null&&(e=Math.round(1/t.ea())),this.ha=js,this.Le()?(this.ha=Qs,e=100):this.gl()?(this.ha=new Ji(100,1),e=100):t!==null&&(this.ha=t.ra()),this.dl=new $s(this,e,this.fl.bind(this),this.pl.bind(this)),this.dl.Ha()}Nl(){this.el=null}Ki(){return this.cl}Xl(){return this.nl[0]||null}Pl(){return this.Ml()?this.ys.scaleMargins.bottom*this.$t()+this.tl:this.ys.scaleMargins.top*this.$t()+this.Qa}kl(){return this.Ml()?this.ys.scaleMargins.top*this.$t()+this.Qa:this.ys.scaleMargins.bottom*this.$t()+this.tl}Tl(){this.Xa.Ga||(this.Xa.Ga=!0,this.Ql())}ml(){this.Za=null}pl(t,e){if(this.Tl(),this.Zi())return 0;t=this.Ya()&&t?zi(t,this.ll):t;const i=D(this.Qe()),n=this.kl()+(this.yl()-1)*(t-i.$e())/i.Ye();return this.Rl(n)}fl(t,e){if(this.Tl(),this.Zi())return 0;const i=this.Rl(t),n=D(this.Qe()),r=n.$e()+n.Ye()*((i-this.kl())/(this.yl()-1));return this.Ya()?oi(r,this.ll):r}xl(){this.rl=null,this.dl.Ha()}Ql(){const t=this.Xa.Ja;if(t===null)return;let e=null;const i=this.Gl();let n=0,r=0;for(const l of i){if(!l.Vt())continue;const h=l.zt();if(h===null)continue;const u=l.Mh(t.Uh(),t.bi());let c=u&&u.Qe();if(c!==null){switch(this.ys.mode){case 1:c=ti(c,this.ll);break;case 2:c=ic(c,h.Ft);break;case 3:c=nc(c,h.Ft)}if(e=e===null?c:e.vn(D(c)),u!==null){const d=u.tr();d!==null&&(n=Math.max(n,d.above),r=Math.max(r,d.below))}}}if(n===this.Qa&&r===this.tl||(this.Qa=n,this.tl=r,this.rl=null,this.ml()),e!==null){if(e.$e()===e.qe()){const l=this.Xl(),h=5*(l===null||this.Le()||this.gl()?1:l.ea());this.Ya()&&(e=xi(e,this.ll)),e=new wt(e.$e()-h,e.qe()+h),this.Ya()&&(e=ti(e,this.ll))}if(this.Ya()){const l=xi(e,this.ll),h=mn(l);if(o=h,a=this.ll,o.Ia!==a.Ia||o.Ba!==a.Ba){const u=this.Ka!==null?xi(this.Ka,this.ll):null;this.ll=h,e=ti(l,h),u!==null&&(this.Ka=ti(u,h))}}this.bl(e)}else this.Ge===null&&(this.bl(new wt(-.5,.5)),this.ll=mn(null));var o,a;this.Xa.Ga=!0}Vl(){return this.Le()?Fe:this.gl()?ri:this.Ya()?t=>zi(t,this.ll):null}io(t,e,i){return e===void 0?(i===void 0&&(i=this.ra()),i.format(t)):e(t)}nr(t,e){return this.io(t,this.ul.priceFormatter,e)}Kl(t,e){return this.io(t,this.ul.percentageFormatter,e)}}function Gs(s){return s instanceof Zi}class Us{constructor(t,e){this.nl=[],this.so=new Map,this.ja=0,this.no=0,this.eo=1e3,this.el=null,this.ro=new lt,this.Ph=[],this.uh=t,this.ts=e,this.ho=new ec(this);const i=e.N();this.ao=this.lo("left",i.leftPriceScale),this.oo=this.lo("right",i.rightPriceScale),this.ao.Sl().i(this._o.bind(this,this.ao),this),this.oo.Sl().i(this._o.bind(this,this.oo),this),this.uo(i)}uo(t){if(t.leftPriceScale&&this.ao.hr(t.leftPriceScale),t.rightPriceScale&&this.oo.hr(t.rightPriceScale),t.localization&&(this.ao.ga(),this.oo.ga()),t.overlayPriceScales){const e=Array.from(this.so.values());for(const i of e){const n=D(i[0].Wt());n.hr(t.overlayPriceScales),t.localization&&n.ga()}}}co(t){switch(t){case"left":return this.ao;case"right":return this.oo}return this.so.has(t)?bt(this.so.get(t))[0].Wt():null}m(){this.Qt().do().u(this),this.ao.Sl().u(this),this.oo.Sl().u(this),this.nl.forEach(t=>{t.m&&t.m()}),this.Ph=this.Ph.filter(t=>{const e=t.oh();return e.detached&&e.detached(),!1}),this.ro.p()}fo(){return this.eo}po(t){this.eo=t}Qt(){return this.ts}Qi(){return this.no}$t(){return this.ja}vo(t){this.no=t,this.mo()}Cl(t){this.ja=t,this.ao.Cl(t),this.oo.Cl(t),this.nl.forEach(e=>{if(this.Un(e)){const i=e.Wt();i!==null&&i.Cl(t)}}),this.mo()}wo(){return this.nl.filter(Gs)}ba(){return this.nl}Un(t){const e=t.Wt();return e===null||this.ao!==e&&this.oo!==e}Ol(t,e,i){const n=i!==void 0?i:this.bo().Mo+1;this.xo(t,e,n)}Wl(t){const e=this.nl.indexOf(t);_t(e!==-1,"removeDataSource: invalid data source"),this.nl.splice(e,1);const i=D(t.Wt()).wa();if(this.so.has(i)){const r=bt(this.so.get(i)),o=r.indexOf(t);o!==-1&&(r.splice(o,1),r.length===0&&this.so.delete(i))}const n=t.Wt();n&&n.ba().indexOf(t)>=0&&n.Wl(t),n!==null&&(n.Nl(),this.So(n)),this.el=null}qn(t){return t===this.ao?"left":t===this.oo?"right":"overlay"}Co(){return this.ao}yo(){return this.oo}Po(t,e){t.Ul(e)}ko(t,e){t.$l(e),this.mo()}To(t){t.ql()}Ro(t,e){t.Yl(e)}Do(t,e){t.jl(e),this.mo()}Vo(t){t.Zl()}mo(){this.nl.forEach(t=>{t.Ns()})}ks(){let t=null;return this.ts.N().rightPriceScale.visible&&this.oo.ba().length!==0?t=this.oo:this.ts.N().leftPriceScale.visible&&this.ao.ba().length!==0?t=this.ao:this.nl.length!==0&&(t=this.nl[0].Wt()),t===null&&(t=this.oo),t}$n(){let t=null;return this.ts.N().rightPriceScale.visible?t=this.oo:this.ts.N().leftPriceScale.visible&&(t=this.ao),t}So(t){t!==null&&t.wl()&&this.Io(t)}Bo(t){const e=this.uh.ye();t.vl({sn:!0}),e!==null&&t.Jl(e),this.mo()}Ao(){this.Io(this.ao),this.Io(this.oo)}Eo(){this.So(this.ao),this.So(this.oo),this.nl.forEach(t=>{this.Un(t)&&this.So(t.Wt())}),this.mo(),this.ts.ar()}Dt(){return this.el===null&&(this.el=Mo(this.nl)),this.el}It(){return this.Dt().filter(Gs)}zo(){return this.ro}Lo(){return this.ho}ua(t){this.Ph.push(new Yu(t))}ca(t){this.Ph=this.Ph.filter(e=>e.oh()!==t),t.detached&&t.detached(),this.ts.ar()}Oo(){return this.Ph}sa(t,e){return this.Ph.map(i=>i.jn(t,e)).filter(i=>i!==null)}Io(t){const e=t.Gl();if(e&&e.length>0&&!this.uh.Zi()){const i=this.uh.ye();i!==null&&t.Jl(i)}t.Ns()}bo(){const t=this.Dt();if(t.length===0)return{No:0,Mo:0};let e=0,i=0;for(let n=0;n<t.length;n++){const r=t[n].hs();r!==null&&(r<e&&(e=r),r>i&&(i=r))}return{No:e,Mo:i}}xo(t,e,i){let n=this.co(e);if(n===null&&(n=this.lo(e,this.ts.N().overlayPriceScales)),this.nl.push(t),!Ui(e)){const r=this.so.get(e)||[];r.push(t),this.so.set(e,r)}n.Ol(t),t._s(n),t.ls(i),this.So(n),this.el=null}_o(t,e,i){e.ie!==i.ie&&this.Io(t)}lo(t,e){const i={visible:!0,autoScale:!0,...Gt(e)},n=new sc(t,i,this.ts.N().layout,this.ts.N().localization,this.ts.Ki());return n.Cl(this.$t()),n}}function Mi(s){return{Wo:s.Wo,Fo:{Zn:s.Ho.externalId},Uo:s.Ho.cursorStyle}}function rc(s,t,e,i){for(const n of s){const r=n.Tt(i);if(r!==null&&r.jn){const o=r.jn(t,e);if(o!==null)return{$o:n,Fo:o}}}return null}function oc(s){return s.Ws!==void 0}function Eo(s,t,e){const i=[s,...s.Dt()],n=function(r,o,a){var d;let l,h;for(const f of r){const v=((d=f.sa)==null?void 0:d.call(f,o,a))??[];for(const p of v)u=p.zOrder,c=l==null?void 0:l.zOrder,(!c||u==="top"&&c!=="top"||u==="normal"&&c==="bottom")&&(l=p,h=f)}var u,c;return l&&h?{Ho:l,Wo:h}:null}(i,t,e);if((n==null?void 0:n.Ho.zOrder)==="top")return Mi(n);for(const r of i){if(n&&n.Wo===r&&n.Ho.zOrder!=="bottom"&&!n.Ho.isBackground)return Mi(n);if(oc(r)){const o=rc(r.Ws(s),t,e,s);if(o!==null)return{Wo:r,$o:o.$o,Fo:o.Fo}}if(n&&n.Wo===r&&n.Ho.zOrder!=="bottom"&&n.Ho.isBackground)return Mi(n)}return n!=null&&n.Ho?Mi(n):null}class ac{constructor(t,e,i=50){this.Pn=0,this.kn=1,this.Tn=1,this.Dn=new Map,this.Rn=new Map,this.qo=t,this.Yo=e,this.Vn=i}jo(t){const e=t.time,i=this.Yo.cacheKey(e),n=this.Dn.get(i);if(n!==void 0)return n.Zo;if(this.Pn===this.Vn){const o=this.Rn.get(this.Tn);this.Rn.delete(this.Tn),this.Dn.delete(bt(o)),this.Tn++,this.Pn--}const r=this.qo(t);return this.Dn.set(i,{Zo:r,En:this.kn}),this.Rn.set(this.kn,i),this.Pn++,this.kn++,r}}class ai{constructor(t,e){_t(t<=e,"right should be >= left"),this.Ko=t,this.Xo=e}Uh(){return this.Ko}bi(){return this.Xo}Go(){return this.Xo-this.Ko+1}Te(t){return this.Ko<=t&&t<=this.Xo}He(t){return this.Ko===t.Uh()&&this.Xo===t.bi()}}function Js(s,t){return s===null||t===null?s===t:s.He(t)}class lc{constructor(){this.Jo=new Map,this.Dn=null,this.Qo=!1}t_(t){this.Qo=t,this.Dn=null}i_(t,e){this.s_(e),this.Dn=null;for(let i=e;i<t.length;++i){const n=t[i];let r=this.Jo.get(n.timeWeight);r===void 0&&(r=[],this.Jo.set(n.timeWeight,r)),r.push({index:i,time:n.time,weight:n.timeWeight,originalTime:n.originalTime})}}n_(t,e,i,n,r){const o=Math.ceil(e/t);return this.Dn!==null&&this.Dn.e_===o&&r===this.Dn.r_&&i===this.Dn.h_||(this.Dn={r_:r,h_:i,Va:this.a_(o,i,n),e_:o}),this.Dn.Va}s_(t){if(t===0)return void this.Jo.clear();const e=[];this.Jo.forEach((i,n)=>{t<=i[0].index?e.push(n):i.splice($e(i,t,r=>r.index<t),1/0)});for(const i of e)this.Jo.delete(i)}a_(t,e,i){let n=[];const r=o=>!e||i.has(o.index);for(const o of Array.from(this.Jo.keys()).sort((a,l)=>l-a)){if(!this.Jo.get(o))continue;const a=n;n=[];const l=a.length;let h=0;const u=bt(this.Jo.get(o)),c=u.length;let d=1/0,f=-1/0;for(let v=0;v<c;v++){const p=u[v],g=p.index;for(;h<l;){const m=a[h],_=m.index;if(!(_<g&&r(m))){d=_;break}h++,n.push(m),f=_,d=1/0}if(d-g>=t&&g-f>=t&&r(p))n.push(p),f=g;else if(this.Qo)return a}for(;h<l;h++)r(a[h])&&n.push(a[h])}return n}}class ze{constructor(t){this.l_=t}o_(){return this.l_===null?null:new ai(Math.floor(this.l_.Uh()),Math.ceil(this.l_.bi()))}__(){return this.l_}static u_(){return new ze(null)}}function hc(s,t){return s.weight>t.weight?s:t}class uc{constructor(t,e,i,n){this.no=0,this.c_=null,this.d_=[],this.al=null,this.hl=null,this.f_=new lc,this.p_=new Map,this.v_=ze.u_(),this.m_=!0,this.w_=new lt,this.g_=new lt,this.M_=new lt,this.b_=null,this.x_=null,this.S_=new Map,this.C_=-1,this.y_=[],this.ys=e,this.ul=i,this.P_=e.rightOffset,this.k_=e.barSpacing,this.ts=t,this.Yo=n,this.T_(),this.f_.t_(e.uniformDistribution),this.R_()}N(){return this.ys}D_(t){xt(this.ul,t),this.V_(),this.T_()}hr(t,e){xt(this.ys,t),this.ys.fixLeftEdge&&this.I_(),this.ys.fixRightEdge&&this.B_(),t.barSpacing!==void 0&&this.ts.dn(t.barSpacing),t.rightOffset!==void 0&&this.ts.fn(t.rightOffset),t.minBarSpacing===void 0&&t.maxBarSpacing===void 0||this.ts.dn(t.barSpacing??this.k_),t.ignoreWhitespaceIndices!==void 0&&t.ignoreWhitespaceIndices!==this.ys.ignoreWhitespaceIndices&&this.R_(),this.V_(),this.T_(),this.M_.p()}Rs(t){var e;return((e=this.d_[t])==null?void 0:e.time)??null}ss(t){return this.d_[t]??null}A_(t,e){if(this.d_.length<1)return null;if(this.Yo.key(t)>this.Yo.key(this.d_[this.d_.length-1].time))return e?this.d_.length-1:null;const i=$e(this.d_,this.Yo.key(t),(n,r)=>this.Yo.key(n.time)<r);return this.Yo.key(t)<this.Yo.key(this.d_[i].time)?e?i:null:i}Zi(){return this.no===0||this.d_.length===0||this.c_===null}E_(){return this.d_.length>0}ye(){return this.z_(),this.v_.o_()}L_(){return this.z_(),this.v_.__()}O_(){const t=this.ye();if(t===null)return null;const e={from:t.Uh(),to:t.bi()};return this.N_(e)}N_(t){const e=Math.round(t.from),i=Math.round(t.to),n=D(this.W_()),r=D(this.F_());return{from:D(this.ss(Math.max(n,e))),to:D(this.ss(Math.min(r,i)))}}H_(t){return{from:D(this.A_(t.from,!0)),to:D(this.A_(t.to,!0))}}Qi(){return this.no}vo(t){if(!isFinite(t)||t<=0||this.no===t)return;const e=this.L_(),i=this.no;if(this.no=t,this.m_=!0,this.ys.lockVisibleTimeRangeOnResize&&i!==0){const n=this.k_*t/i;this.k_=n}if(this.ys.fixLeftEdge&&e!==null&&e.Uh()<=0){const n=i-t;this.P_-=Math.round(n/this.k_)+1,this.m_=!0}this.U_(),this.q_()}qt(t){if(this.Zi()||!ui(t))return 0;const e=this.Y_()+this.P_-t;return this.no-(e+.5)*this.k_-1}j_(t,e){const i=this.Y_(),n=e===void 0?0:e.from,r=e===void 0?t.length:e.to;for(let o=n;o<r;o++){const a=t[o].wt,l=i+this.P_-a,h=this.no-(l+.5)*this.k_-1;t[o]._t=h}}Z_(t,e){const i=Math.ceil(this.K_(t));return e&&this.ys.ignoreWhitespaceIndices&&!this.X_(i)?this.G_(i):i}fn(t){this.m_=!0,this.P_=t,this.q_(),this.ts.J_(),this.ts.ar()}Q_(){return this.k_}dn(t){this.tu(t),this.q_(),this.ts.J_(),this.ts.ar()}iu(){return this.P_}Va(){if(this.Zi())return null;if(this.x_!==null)return this.x_;const t=this.k_,e=5*(this.ts.N().layout.fontSize+4)/8*(this.ys.tickMarkMaxCharacterLength||8),i=Math.round(e/t),n=D(this.ye()),r=Math.max(n.Uh(),n.Uh()-i),o=Math.max(n.bi(),n.bi()-i),a=this.f_.n_(t,e,this.ys.ignoreWhitespaceIndices,this.S_,this.C_),l=this.W_()+i,h=this.F_()-i,u=this.su(),c=this.ys.fixLeftEdge||u,d=this.ys.fixRightEdge||u;let f=0;for(const v of a){if(!(r<=v.index&&v.index<=o))continue;let p;f<this.y_.length?(p=this.y_[f],p.coord=this.qt(v.index),p.label=this.nu(v),p.weight=v.weight):(p={needAlignCoordinate:!1,coord:this.qt(v.index),label:this.nu(v),weight:v.weight},this.y_.push(p)),this.k_>e/2&&!u?p.needAlignCoordinate=!1:p.needAlignCoordinate=c&&v.index<=l||d&&v.index>=h,f++}return this.y_.length=f,this.x_=this.y_,this.y_}eu(){this.m_=!0,this.dn(this.ys.barSpacing),this.fn(this.ys.rightOffset)}ru(t){this.m_=!0,this.c_=t,this.q_(),this.I_()}hu(t,e){const i=this.K_(t),n=this.Q_(),r=n+e*(n/10);this.dn(r),this.ys.rightBarStaysOnScroll||this.fn(this.iu()+(i-this.K_(t)))}Ul(t){this.al&&this.Zl(),this.hl===null&&this.b_===null&&(this.Zi()||(this.hl=t,this.au()))}$l(t){if(this.b_===null)return;const e=Ti(this.no-t,0,this.no),i=Ti(this.no-D(this.hl),0,this.no);e!==0&&i!==0&&this.dn(this.b_.Q_*e/i)}ql(){this.hl!==null&&(this.hl=null,this.lu())}Yl(t){this.al===null&&this.b_===null&&(this.Zi()||(this.al=t,this.au()))}jl(t){if(this.al===null)return;const e=(this.al-t)/this.Q_();this.P_=D(this.b_).iu+e,this.m_=!0,this.q_()}Zl(){this.al!==null&&(this.al=null,this.lu())}ou(){this._u(this.ys.rightOffset)}_u(t,e=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const i=this.P_,n=performance.now();this.ts._n({uu:r=>(r-n)/e>=1,cu:r=>{const o=(r-n)/e;return o>=1?t:i+(t-i)*o}})}Pt(t,e){this.m_=!0,this.d_=t,this.f_.i_(t,e),this.q_()}du(){return this.w_}fu(){return this.g_}pu(){return this.M_}Y_(){return this.c_||0}vu(t){const e=t.Go();this.tu(this.no/e),this.P_=t.bi()-this.Y_(),this.q_(),this.m_=!0,this.ts.J_(),this.ts.ar()}mu(){const t=this.W_(),e=this.F_();t!==null&&e!==null&&this.vu(new ai(t,e+this.ys.rightOffset))}wu(t){const e=new ai(t.from,t.to);this.vu(e)}ns(t){return this.ul.timeFormatter!==void 0?this.ul.timeFormatter(t.originalTime):this.Yo.formatHorzItem(t.time)}R_(){if(!this.ys.ignoreWhitespaceIndices)return;this.S_.clear();const t=this.ts.js();for(const e of t)for(const i of e.ma())this.S_.set(i,!0);this.C_++}su(){const t=this.ts.N().handleScroll,e=this.ts.N().handleScale;return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||e.axisDoubleClickReset.time||e.axisPressedMouseMove.time||e.mouseWheel||e.pinch)}W_(){return this.d_.length===0?null:0}F_(){return this.d_.length===0?null:this.d_.length-1}gu(t){return(this.no-1-t)/this.k_}K_(t){const e=this.gu(t),i=this.Y_()+this.P_-e;return Math.round(1e6*i)/1e6}tu(t){const e=this.k_;this.k_=t,this.U_(),e!==this.k_&&(this.m_=!0,this.Mu())}z_(){if(!this.m_)return;if(this.m_=!1,this.Zi())return void this.bu(ze.u_());const t=this.Y_(),e=this.no/this.k_,i=this.P_+t,n=new ai(i-e+1,i);this.bu(new ze(n))}U_(){const t=Ti(this.k_,this.xu(),this.Su());this.k_!==t&&(this.k_=t,this.m_=!0)}Su(){return this.ys.maxBarSpacing>0?this.ys.maxBarSpacing:.5*this.no}xu(){return this.ys.fixLeftEdge&&this.ys.fixRightEdge&&this.d_.length!==0?this.no/this.d_.length:this.ys.minBarSpacing}q_(){const t=this.Cu();t!==null&&this.P_<t&&(this.P_=t,this.m_=!0);const e=this.yu();this.P_>e&&(this.P_=e,this.m_=!0)}Cu(){const t=this.W_(),e=this.c_;return t===null||e===null?null:t-e-1+(this.ys.fixLeftEdge?this.no/this.k_:Math.min(2,this.d_.length))}yu(){return this.ys.fixRightEdge?0:this.no/this.k_-Math.min(2,this.d_.length)}au(){this.b_={Q_:this.Q_(),iu:this.iu()}}lu(){this.b_=null}nu(t){let e=this.p_.get(t.weight);return e===void 0&&(e=new ac(i=>this.Pu(i),this.Yo),this.p_.set(t.weight,e)),e.jo(t)}Pu(t){return this.Yo.formatTickmark(t,this.ul)}bu(t){const e=this.v_;this.v_=t,Js(e.o_(),this.v_.o_())||this.w_.p(),Js(e.__(),this.v_.__())||this.g_.p(),this.Mu()}Mu(){this.x_=null}V_(){this.Mu(),this.p_.clear()}T_(){this.Yo.updateFormatter(this.ul)}I_(){if(!this.ys.fixLeftEdge)return;const t=this.W_();if(t===null)return;const e=this.ye();if(e===null)return;const i=e.Uh()-t;if(i<0){const n=this.P_-i-1;this.fn(n)}this.U_()}B_(){this.q_(),this.U_()}X_(t){return!this.ys.ignoreWhitespaceIndices||this.S_.get(t)||!1}G_(t){const e=function*(n){const r=Math.round(n),o=r<n;let a=1;for(;;)o?(yield r+a,yield r-a):(yield r-a,yield r+a),a++}(t),i=this.F_();for(;i;){const n=e.next().value;if(this.S_.get(n))return n;if(n<0||n>i)break}return t}}var Zs,Ks,qs,tr,er;(function(s){s[s.OnTouchEnd=0]="OnTouchEnd",s[s.OnNextTap=1]="OnNextTap"})(Zs||(Zs={}));class cc{constructor(t,e,i){this.ku=[],this.Tu=[],this.no=0,this.Ru=null,this.Du=new lt,this.Vu=new lt,this.Iu=null,this.Bu=t,this.ys=e,this.Yo=i,this.cl=new uu(this.ys.layout.colorParsers),this.Au=new hu(this),this.uh=new uc(this,e.timeScale,this.ys.localization,i),this.Ct=new Su(this,e.crosshair),this.Eu=new Ku(e.crosshair),this.zu(0),this.ku[0].po(2e3),this.Lu=this.Ou(0),this.Nu=this.Ou(1)}Bh(){this.Wu(pt.gn())}ar(){this.Wu(pt.wn())}Xh(){this.Wu(new pt(1))}Ah(t){const e=this.Fu(t);this.Wu(e)}Hu(){return this.Ru}Uu(t){var i,n,r,o;if(((i=this.Ru)==null?void 0:i.Wo)===(t==null?void 0:t.Wo)&&((r=(n=this.Ru)==null?void 0:n.Fo)==null?void 0:r.Zn)===((o=t==null?void 0:t.Fo)==null?void 0:o.Zn))return;const e=this.Ru;this.Ru=t,e!==null&&this.Ah(e.Wo),t!==null&&t.Wo!==(e==null?void 0:e.Wo)&&this.Ah(t.Wo)}N(){return this.ys}hr(t){xt(this.ys,t),this.ku.forEach(e=>e.uo(t)),t.timeScale!==void 0&&this.uh.hr(t.timeScale),t.localization!==void 0&&this.uh.D_(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.Du.p(),this.Lu=this.Ou(0),this.Nu=this.Ou(1),this.Bh()}$u(t,e,i=0){const n=this.ku[i];if(n===void 0)return;if(t==="left")return xt(this.ys,{leftPriceScale:e}),n.uo({leftPriceScale:e}),this.Du.p(),void this.Bh();if(t==="right")return xt(this.ys,{rightPriceScale:e}),n.uo({rightPriceScale:e}),this.Du.p(),void this.Bh();const r=this.qu(t,i);r!==null&&(r.Wt.hr(e),this.Du.p())}qu(t,e){const i=this.ku[e];if(i===void 0)return null;const n=i.co(t);return n!==null?{Us:i,Wt:n}:null}At(){return this.uh}$s(){return this.ku}Yu(){return this.Ct}ju(){return this.Vu}Zu(t,e){t.Cl(e),this.J_()}vo(t){this.no=t,this.uh.vo(this.no),this.ku.forEach(e=>e.vo(t)),this.J_()}Ku(t){this.ku.length!==1&&(_t(t>=0&&t<this.ku.length,"Invalid pane index"),this.ku.splice(t,1),this.Bh())}Xu(t,e){if(this.ku.length<2)return;_t(t>=0&&t<this.ku.length,"Invalid pane index");const i=this.ku[t],n=this.ku.reduce((c,d)=>c+d.fo(),0),r=this.ku.reduce((c,d)=>c+d.$t(),0),o=r-30*(this.ku.length-1);e=Math.min(o,Math.max(30,e));const a=n/r,l=i.$t();i.po(e*a);let h=e-l,u=this.ku.length-1;for(const c of this.ku)if(c!==i){const d=Math.min(o,Math.max(30,c.$t()-h/u));h-=c.$t()-d,u-=1;const f=d*a;c.po(f)}this.Bh()}Gu(t,e){_t(t>=0&&t<this.ku.length&&e>=0&&e<this.ku.length,"Invalid pane index");const i=this.ku[t],n=this.ku[e];this.ku[t]=n,this.ku[e]=i,this.Bh()}Po(t,e,i){t.Po(e,i)}ko(t,e,i){t.ko(e,i),this.Eh(),this.Wu(this.Ju(t,2))}To(t,e){t.To(e),this.Wu(this.Ju(t,2))}Ro(t,e,i){e.wl()||t.Ro(e,i)}Do(t,e,i){e.wl()||(t.Do(e,i),this.Eh(),this.Wu(this.Ju(t,2)))}Vo(t,e){e.wl()||(t.Vo(e),this.Wu(this.Ju(t,2)))}Bo(t,e){t.Bo(e),this.Wu(this.Ju(t,2))}Qu(t){this.uh.Ul(t)}tc(t,e){const i=this.At();if(i.Zi()||e===0)return;const n=i.Qi();t=Math.max(1,Math.min(t,n)),i.hu(t,e),this.J_()}sc(t){this.nc(0),this.ec(t),this.rc()}hc(t){this.uh.$l(t),this.J_()}ac(){this.uh.ql(),this.ar()}nc(t){this.uh.Yl(t)}ec(t){this.uh.jl(t),this.J_()}rc(){this.uh.Zl(),this.ar()}js(){return this.Tu}lc(t,e,i,n,r){this.Ct.Vs(t,e);let o=NaN,a=this.uh.Z_(t,!0);const l=this.uh.ye();l!==null&&(a=Math.min(Math.max(l.Uh(),a),l.bi()));const h=n.ks(),u=h.zt();if(u!==null&&(o=h.Ts(e,u)),o=this.Eu.Ma(o,a,n),this.Ct.Es(a,o,n),this.Xh(),!r){const c=Eo(n,t,e);this.Uu(c&&{Wo:c.Wo,Fo:c.Fo,Uo:c.Uo||null}),this.Vu.p(this.Ct.Bt(),{x:t,y:e},i)}}oc(t,e,i){const n=i.ks(),r=n.zt(),o=n.Nt(t,D(r)),a=this.uh.A_(e,!0),l=this.uh.qt(D(a));this.lc(l,o,null,i,!0)}_c(t){this.Yu().Ls(),this.Xh(),t||this.Vu.p(null,null,null)}Eh(){const t=this.Ct.Us();if(t!==null){const e=this.Ct.Bs(),i=this.Ct.As();this.lc(e,i,null,t)}this.Ct.Ns()}uc(t,e,i){const n=this.uh.Rs(0);e!==void 0&&i!==void 0&&this.uh.Pt(e,i);const r=this.uh.Rs(0),o=this.uh.Y_(),a=this.uh.ye();if(a!==null&&n!==null&&r!==null){const l=a.Te(o),h=this.Yo.key(n)>this.Yo.key(r),u=t!==null&&t>o&&!h,c=this.uh.N().allowShiftVisibleRangeOnWhitespaceReplacement,d=l&&(i!==void 0||c)&&this.uh.N().shiftVisibleRangeOnNewBar;if(u&&!d){const f=t-o;this.uh.fn(this.uh.iu()-f)}}this.uh.ru(t)}Lh(t){t!==null&&t.Eo()}Hn(t){if(function(i){return i instanceof Us}(t))return t;const e=this.ku.find(i=>i.Dt().includes(t));return e===void 0?null:e}J_(){this.ku.forEach(t=>t.Eo()),this.Eh()}m(){this.ku.forEach(t=>t.m()),this.ku.length=0,this.ys.localization.priceFormatter=void 0,this.ys.localization.percentageFormatter=void 0,this.ys.localization.timeFormatter=void 0}cc(){return this.Au}Yn(){return this.Au.N()}do(){return this.Du}dc(t,e){const i=this.zu(e);this.fc(t,i),this.Tu.push(t),this.Tu.length===1?this.Bh():this.ar()}vc(t){const e=this.Hn(t),i=this.Tu.indexOf(t);_t(i!==-1,"Series not found");const n=D(e);this.Tu.splice(i,1),n.Wl(t),t.m&&t.m(),this.uh.R_(),this.mc(n)}Ih(t,e){const i=D(this.Hn(t));i.Wl(t),i.Ol(t,e,D(t.hs()))}mu(){const t=pt.wn();t.rn(),this.Wu(t)}wc(t){const e=pt.wn();e.ln(t),this.Wu(e)}cn(){const t=pt.wn();t.cn(),this.Wu(t)}dn(t){const e=pt.wn();e.dn(t),this.Wu(e)}fn(t){const e=pt.wn();e.fn(t),this.Wu(e)}_n(t){const e=pt.wn();e._n(t),this.Wu(e)}hn(){const t=pt.wn();t.hn(),this.Wu(t)}gc(){return this.ys.rightPriceScale.visible?"right":"left"}Mc(t,e){if(_t(e>=0,"Index should be greater or equal to 0"),e===this.bc(t))return;const i=D(this.Hn(t));i.Wl(t);const n=this.zu(e);this.fc(t,n),i.ba().length===0&&this.mc(i)}xc(){return this.Nu}$(){return this.Lu}Ut(t){const e=this.Nu,i=this.Lu;if(e===i)return e;if(t=Math.max(0,Math.min(100,Math.round(100*t))),this.Iu===null||this.Iu.mr!==i||this.Iu.wr!==e)this.Iu={mr:i,wr:e,Sc:new Map};else{const r=this.Iu.Sc.get(t);if(r!==void 0)return r}const n=this.cl.tt(i,e,t/100);return this.Iu.Sc.set(t,n),n}Cc(t){return this.ku.indexOf(t)}Ki(){return this.cl}zu(t){if(_t(t>=0,"Index should be greater or equal to 0"),(t=Math.min(this.ku.length,t))<this.ku.length)return this.ku[t];const e=new Us(this.uh,this);this.ku.push(e);const i=pt.gn();return i.Qs(t,{tn:0,sn:!0}),this.Wu(i),e}bc(t){return this.ku.findIndex(e=>e.wo().includes(t))}Ju(t,e){const i=new pt(e);if(t!==null){const n=this.ku.indexOf(t);i.Qs(n,{tn:e})}return i}Fu(t,e){return e===void 0&&(e=2),this.Ju(this.Hn(t),e)}Wu(t){this.Bu&&this.Bu(t),this.ku.forEach(e=>e.Lo().lr().Pt())}fc(t,e){const i=t.N().priceScaleId,n=i!==void 0?i:this.gc();e.Ol(t,n),Ui(n)||t.hr(t.N())}Ou(t){const e=this.ys.layout;return e.background.type==="gradient"?t===0?e.background.topColor:e.background.bottomColor:e.background.color}mc(t){t.ba().length===0&&this.ku.length>1&&(this.ku.splice(this.Cc(t),1),this.Bh())}}function Ln(s){return!Xe(s)&&!fi(s)}function Po(s){return Xe(s)}(function(s){s[s.Disabled=0]="Disabled",s[s.Continuous=1]="Continuous",s[s.OnDataUpdate=2]="OnDataUpdate"})(Ks||(Ks={})),function(s){s[s.LastBar=0]="LastBar",s[s.LastVisible=1]="LastVisible"}(qs||(qs={})),function(s){s.Solid="solid",s.VerticalGradient="gradient"}(tr||(tr={})),function(s){s[s.Year=0]="Year",s[s.Month=1]="Month",s[s.DayOfMonth=2]="DayOfMonth",s[s.Time=3]="Time",s[s.TimeWithSeconds=4]="TimeWithSeconds"}(er||(er={}));const ir=s=>s.getUTCFullYear();function dc(s,t,e){return t.replace(/yyyy/g,(i=>Ut(ir(i),4))(s)).replace(/yy/g,(i=>Ut(ir(i)%100,2))(s)).replace(/MMMM/g,((i,n)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(n,{month:"long"}))(s,e)).replace(/MMM/g,((i,n)=>new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(n,{month:"short"}))(s,e)).replace(/MM/g,(i=>Ut((n=>n.getUTCMonth()+1)(i),2))(s)).replace(/dd/g,(i=>Ut((n=>n.getUTCDate())(i),2))(s))}class Io{constructor(t="yyyy-MM-dd",e="default"){this.yc=t,this.Pc=e}jo(t){return dc(t,this.yc,this.Pc)}}class fc{constructor(t){this.kc=t||"%h:%m:%s"}jo(t){return this.kc.replace("%h",Ut(t.getUTCHours(),2)).replace("%m",Ut(t.getUTCMinutes(),2)).replace("%s",Ut(t.getUTCSeconds(),2))}}const vc={Tc:"yyyy-MM-dd",Rc:"%h:%m:%s",Dc:" ",Vc:"default"};class pc{constructor(t={}){const e={...vc,...t};this.Ic=new Io(e.Tc,e.Vc),this.Bc=new fc(e.Rc),this.Ac=e.Dc}jo(t){return`${this.Ic.jo(t)}${this.Ac}${this.Bc.jo(t)}`}}function Ei(s){return 60*s*60*1e3}function yn(s){return 60*s*1e3}const Pi=[{Ec:(nr=1,1e3*nr),zc:10},{Ec:yn(1),zc:20},{Ec:yn(5),zc:21},{Ec:yn(30),zc:22},{Ec:Ei(1),zc:30},{Ec:Ei(3),zc:31},{Ec:Ei(6),zc:32},{Ec:Ei(12),zc:33}];var nr;function sr(s,t){if(s.getUTCFullYear()!==t.getUTCFullYear())return 70;if(s.getUTCMonth()!==t.getUTCMonth())return 60;if(s.getUTCDate()!==t.getUTCDate())return 50;for(let e=Pi.length-1;e>=0;--e)if(Math.floor(t.getTime()/Pi[e].Ec)!==Math.floor(s.getTime()/Pi[e].Ec))return Pi[e].zc;return 0}function wn(s){let t=s;if(fi(s)&&(t=es(s)),!Ln(t))throw new Error("time must be of type BusinessDay");const e=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{Lc:Math.round(e.getTime()/1e3),Oc:t}}function rr(s){if(!Po(s))throw new Error("time must be of type isUTCTimestamp");return{Lc:s}}function es(s){const t=new Date(s);if(isNaN(t.getTime()))throw new Error(`Invalid date string=${s}, expected format=yyyy-mm-dd`);return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function or(s){fi(s.time)&&(s.time=es(s.time))}class ar{options(){return this.ys}setOptions(t){this.ys=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?function(e){e.forEach(or)}(t):or(t)}createConverterToInternalObj(t){return D(function(e){return e.length===0?null:Ln(e[0].time)||fi(e[0].time)?wn:rr}(t))}key(t){return typeof t=="object"&&"Lc"in t?t.Lc:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){const e=t;return e.Oc===void 0?new Date(1e3*e.Lc).getTime():new Date(Date.UTC(e.Oc.year,e.Oc.month-1,e.Oc.day)).getTime()}convertHorzItemToInternal(t){return Po(e=t)?rr(e):Ln(e)?wn(e):wn(es(e));var e}updateFormatter(t){if(!this.ys)return;const e=t.dateFormat;this.ys.timeScale.timeVisible?this.Nc=new pc({Tc:e,Rc:this.ys.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",Dc:"   ",Vc:t.locale}):this.Nc=new Io(e,t.locale)}formatHorzItem(t){const e=t;return this.Nc.jo(new Date(1e3*e.Lc))}formatTickmark(t,e){const i=function(r,o,a){switch(r){case 0:case 10:return o?a?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return o?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.weight,this.ys.timeScale.timeVisible,this.ys.timeScale.secondsVisible),n=this.ys.timeScale;if(n.tickMarkFormatter!==void 0){const r=n.tickMarkFormatter(t.originalTime,i,e.locale);if(r!==null)return r}return function(r,o,a){const l={};switch(o){case 0:l.year="numeric";break;case 1:l.month="short";break;case 2:l.day="numeric";break;case 3:l.hour12=!1,l.hour="2-digit",l.minute="2-digit";break;case 4:l.hour12=!1,l.hour="2-digit",l.minute="2-digit",l.second="2-digit"}const h=r.Oc===void 0?new Date(1e3*r.Lc):new Date(Date.UTC(r.Oc.year,r.Oc.month-1,r.Oc.day));return new Date(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()).toLocaleString(a,l)}(t.time,i,e.locale)}maxTickMarkWeight(t){let e=t.reduce(hc,t[0]).weight;return e>30&&e<50&&(e=30),e}fillWeightsForPoints(t,e){(function(i,n=0){if(i.length===0)return;let r=n===0?null:i[n-1].time.Lc,o=r!==null?new Date(1e3*r):null,a=0;for(let l=n;l<i.length;++l){const h=i[l],u=new Date(1e3*h.time.Lc);o!==null&&(h.timeWeight=sr(u,o)),a+=h.time.Lc-(r||h.time.Lc),r=h.time.Lc,o=u}if(n===0&&i.length>1){const l=Math.ceil(a/(i.length-1)),h=new Date(1e3*(i[0].time.Lc-l));i[0].timeWeight=sr(new Date(1e3*i[0].time.Lc),h)}})(t,e)}static Wc(t){return xt({localization:{dateFormat:"dd MMM 'yy"}},t??{})}}const He=typeof window<"u";function lr(){return!!He&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function bn(){return!!He&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function Nn(s){return s+s%2}function gc(s){He&&window.chrome!==void 0&&s.addEventListener("mousedown",t=>{if(t.button===1)return t.preventDefault(),!1})}class Ki{constructor(t,e,i){this.Fc=0,this.Hc=null,this.Uc={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.$c=0,this.qc=null,this.Yc={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.jc=null,this.Zc=!1,this.Kc=null,this.Xc=null,this.Gc=!1,this.Jc=!1,this.Qc=!1,this.td=null,this.sd=null,this.nd=null,this.ed=null,this.rd=null,this.hd=null,this.ad=null,this.ld=0,this.od=!1,this._d=!1,this.ud=!1,this.dd=0,this.fd=null,this.pd=!bn(),this.vd=n=>{this.md(n)},this.wd=n=>{if(this.gd(n)){const r=this.Md(n);if(++this.$c,this.qc&&this.$c>1){const{bd:o}=this.xd(Lt(n),this.Yc);o<30&&!this.Qc&&this.Sd(r,this.yd.Cd),this.Pd()}}else{const r=this.Md(n);if(++this.Fc,this.Hc&&this.Fc>1){const{bd:o}=this.xd(Lt(n),this.Uc);o<5&&!this.Jc&&this.kd(r,this.yd.Td),this.Rd()}}},this.Dd=t,this.yd=e,this.ys=i,this.Vd()}m(){this.td!==null&&(this.td(),this.td=null),this.sd!==null&&(this.sd(),this.sd=null),this.ed!==null&&(this.ed(),this.ed=null),this.rd!==null&&(this.rd(),this.rd=null),this.hd!==null&&(this.hd(),this.hd=null),this.nd!==null&&(this.nd(),this.nd=null),this.Id(),this.Rd()}Bd(t){this.ed&&this.ed();const e=this.Ad.bind(this);if(this.ed=()=>{this.Dd.removeEventListener("mousemove",e)},this.Dd.addEventListener("mousemove",e),this.gd(t))return;const i=this.Md(t);this.kd(i,this.yd.Ed),this.pd=!0}Rd(){this.Hc!==null&&clearTimeout(this.Hc),this.Fc=0,this.Hc=null,this.Uc={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}Pd(){this.qc!==null&&clearTimeout(this.qc),this.$c=0,this.qc=null,this.Yc={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}Ad(t){if(this.ud||this.Xc!==null||this.gd(t))return;const e=this.Md(t);this.kd(e,this.yd.zd),this.pd=!0}Ld(t){const e=Sn(t.changedTouches,D(this.fd));if(e===null||(this.dd=Ii(t),this.ad!==null)||this._d)return;this.od=!0;const i=this.xd(Lt(e),D(this.Xc)),{Od:n,Nd:r,bd:o}=i;if(this.Gc||!(o<5)){if(!this.Gc){const a=.5*n,l=r>=a&&!this.ys.Wd(),h=a>r&&!this.ys.Fd();l||h||(this._d=!0),this.Gc=!0,this.Qc=!0,this.Id(),this.Pd()}if(!this._d){const a=this.Md(t,e);this.Sd(a,this.yd.Hd),Re(t)}}}Ud(t){if(t.button!==0)return;const e=this.xd(Lt(t),D(this.Kc)),{bd:i}=e;if(i>=5&&(this.Jc=!0,this.Rd()),this.Jc){const n=this.Md(t);this.kd(n,this.yd.$d)}}xd(t,e){const i=Math.abs(e._t-t._t),n=Math.abs(e.ut-t.ut);return{Od:i,Nd:n,bd:i+n}}qd(t){let e=Sn(t.changedTouches,D(this.fd));if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e===null)return;this.fd=null,this.dd=Ii(t),this.Id(),this.Xc=null,this.hd&&(this.hd(),this.hd=null);const i=this.Md(t,e);if(this.Sd(i,this.yd.Yd),++this.$c,this.qc&&this.$c>1){const{bd:n}=this.xd(Lt(e),this.Yc);n<30&&!this.Qc&&this.Sd(i,this.yd.Cd),this.Pd()}else this.Qc||(this.Sd(i,this.yd.jd),this.yd.jd&&Re(t));this.$c===0&&Re(t),t.touches.length===0&&this.Zc&&(this.Zc=!1,Re(t))}md(t){if(t.button!==0)return;const e=this.Md(t);if(this.Kc=null,this.ud=!1,this.rd&&(this.rd(),this.rd=null),lr()&&this.Dd.ownerDocument.documentElement.removeEventListener("mouseleave",this.vd),!this.gd(t))if(this.kd(e,this.yd.Zd),++this.Fc,this.Hc&&this.Fc>1){const{bd:i}=this.xd(Lt(t),this.Uc);i<5&&!this.Jc&&this.kd(e,this.yd.Td),this.Rd()}else this.Jc||this.kd(e,this.yd.Kd)}Id(){this.jc!==null&&(clearTimeout(this.jc),this.jc=null)}Xd(t){if(this.fd!==null)return;const e=t.changedTouches[0];this.fd=e.identifier,this.dd=Ii(t);const i=this.Dd.ownerDocument.documentElement;this.Qc=!1,this.Gc=!1,this._d=!1,this.Xc=Lt(e),this.hd&&(this.hd(),this.hd=null);{const r=this.Ld.bind(this),o=this.qd.bind(this);this.hd=()=>{i.removeEventListener("touchmove",r),i.removeEventListener("touchend",o)},i.addEventListener("touchmove",r,{passive:!1}),i.addEventListener("touchend",o,{passive:!1}),this.Id(),this.jc=setTimeout(this.Gd.bind(this,t),240)}const n=this.Md(t,e);this.Sd(n,this.yd.Jd),this.qc||(this.$c=0,this.qc=setTimeout(this.Pd.bind(this),500),this.Yc=Lt(e))}Qd(t){if(t.button!==0)return;const e=this.Dd.ownerDocument.documentElement;lr()&&e.addEventListener("mouseleave",this.vd),this.Jc=!1,this.Kc=Lt(t),this.rd&&(this.rd(),this.rd=null);{const n=this.Ud.bind(this),r=this.md.bind(this);this.rd=()=>{e.removeEventListener("mousemove",n),e.removeEventListener("mouseup",r)},e.addEventListener("mousemove",n),e.addEventListener("mouseup",r)}if(this.ud=!0,this.gd(t))return;const i=this.Md(t);this.kd(i,this.yd.tf),this.Hc||(this.Fc=0,this.Hc=setTimeout(this.Rd.bind(this),500),this.Uc=Lt(t))}Vd(){this.Dd.addEventListener("mouseenter",this.Bd.bind(this)),this.Dd.addEventListener("touchcancel",this.Id.bind(this));{const t=this.Dd.ownerDocument,e=i=>{this.yd.if&&(i.composed&&this.Dd.contains(i.composedPath()[0])||i.target&&this.Dd.contains(i.target)||this.yd.if())};this.sd=()=>{t.removeEventListener("touchstart",e)},this.td=()=>{t.removeEventListener("mousedown",e)},t.addEventListener("mousedown",e),t.addEventListener("touchstart",e,{passive:!0})}bn()&&(this.nd=()=>{this.Dd.removeEventListener("dblclick",this.wd)},this.Dd.addEventListener("dblclick",this.wd)),this.Dd.addEventListener("mouseleave",this.sf.bind(this)),this.Dd.addEventListener("touchstart",this.Xd.bind(this),{passive:!0}),gc(this.Dd),this.Dd.addEventListener("mousedown",this.Qd.bind(this)),this.nf(),this.Dd.addEventListener("touchmove",()=>{},{passive:!1})}nf(){this.yd.ef===void 0&&this.yd.rf===void 0&&this.yd.hf===void 0||(this.Dd.addEventListener("touchstart",t=>this.af(t.touches),{passive:!0}),this.Dd.addEventListener("touchmove",t=>{if(t.touches.length===2&&this.ad!==null&&this.yd.rf!==void 0){const e=hr(t.touches[0],t.touches[1])/this.ld;this.yd.rf(this.ad,e),Re(t)}},{passive:!1}),this.Dd.addEventListener("touchend",t=>{this.af(t.touches)}))}af(t){t.length===1&&(this.od=!1),t.length!==2||this.od||this.Zc?this.lf():this._f(t)}_f(t){const e=this.Dd.getBoundingClientRect()||{left:0,top:0};this.ad={_t:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,ut:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.ld=hr(t[0],t[1]),this.yd.ef!==void 0&&this.yd.ef(),this.Id()}lf(){this.ad!==null&&(this.ad=null,this.yd.hf!==void 0&&this.yd.hf())}sf(t){if(this.ed&&this.ed(),this.gd(t)||!this.pd)return;const e=this.Md(t);this.kd(e,this.yd.uf),this.pd=!bn()}Gd(t){const e=Sn(t.touches,D(this.fd));if(e===null)return;const i=this.Md(t,e);this.Sd(i,this.yd.cf),this.Qc=!0,this.Zc=!0}gd(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents!==void 0?t.sourceCapabilities.firesTouchEvents:Ii(t)<this.dd+500}Sd(t,e){e&&e.call(this.yd,t)}kd(t,e){e&&e.call(this.yd,t)}Md(t,e){const i=e||t,n=this.Dd.getBoundingClientRect()||{left:0,top:0};return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-n.left,localY:i.clientY-n.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,df:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",ff:t.type,pf:i.target,$o:t.view,vf:()=>{t.type!=="touchstart"&&Re(t)}}}}function hr(s,t){const e=s.clientX-t.clientX,i=s.clientY-t.clientY;return Math.sqrt(e*e+i*i)}function Re(s){s.cancelable&&s.preventDefault()}function Lt(s){return{_t:s.pageX,ut:s.pageY}}function Ii(s){return s.timeStamp||performance.now()}function Sn(s,t){for(let e=0;e<s.length;++e)if(s[e].identifier===t)return s[e];return null}class mc{constructor(t,e,i){this.mf=null,this.wf=null,this.gf=!0,this.Mf=null,this.bf=t,this.xf=t.Sf()[e],this.Cf=t.Sf()[i],this.yf=document.createElement("tr"),this.yf.style.height="1px",this.Pf=document.createElement("td"),this.Pf.style.position="relative",this.Pf.style.padding="0",this.Pf.style.margin="0",this.Pf.setAttribute("colspan","3"),this.kf(),this.yf.appendChild(this.Pf),this.gf=this.bf.N().layout.panes.enableResize,this.gf?this.Tf():(this.mf=null,this.wf=null)}m(){this.wf!==null&&this.wf.m()}Rf(){return this.yf}Df(){return K({width:this.xf.Df().width,height:1})}Vf(){return K({width:this.xf.Vf().width,height:1*window.devicePixelRatio})}If(t,e,i){const n=this.Vf();t.fillStyle=this.bf.N().layout.panes.separatorColor,t.fillRect(e,i,n.width,n.height)}Pt(){this.kf(),this.bf.N().layout.panes.enableResize!==this.gf&&(this.gf=this.bf.N().layout.panes.enableResize,this.gf?this.Tf():(this.mf!==null&&(this.Pf.removeChild(this.mf.Bf),this.Pf.removeChild(this.mf.Af),this.mf=null),this.wf!==null&&(this.wf.m(),this.wf=null)))}Tf(){const t=document.createElement("div"),e=t.style;e.position="fixed",e.display="none",e.zIndex="49",e.top="0",e.left="0",e.width="100%",e.height="100%",e.cursor="row-resize",this.Pf.appendChild(t);const i=document.createElement("div"),n=i.style;n.position="absolute",n.zIndex="50",n.top="-4px",n.height="9px",n.width="100%",n.backgroundColor="",n.cursor="row-resize",this.Pf.appendChild(i);const r={Ed:this.Ef.bind(this),uf:this.zf.bind(this),tf:this.Lf.bind(this),Jd:this.Lf.bind(this),$d:this.Of.bind(this),Hd:this.Of.bind(this),Zd:this.Nf.bind(this),Yd:this.Nf.bind(this)};this.wf=new Ki(i,r,{Wd:()=>!1,Fd:()=>!0}),this.mf={Af:i,Bf:t}}kf(){this.Pf.style.background=this.bf.N().layout.panes.separatorColor}Ef(t){this.mf!==null&&(this.mf.Af.style.backgroundColor=this.bf.N().layout.panes.separatorHoverColor)}zf(t){this.mf!==null&&this.Mf===null&&(this.mf.Af.style.backgroundColor="")}Lf(t){if(this.mf===null)return;const e=this.xf.Wf().fo()+this.Cf.Wf().fo(),i=e/(this.xf.Df().height+this.Cf.Df().height),n=30*i;e<=2*n||(this.Mf={Ff:t.pageY,Hf:this.xf.Wf().fo(),Uf:e-n,$f:e,qf:i,Yf:n},this.mf.Bf.style.display="block")}Of(t){const e=this.Mf;if(e===null)return;const i=(t.pageY-e.Ff)*e.qf,n=Ti(e.Hf+i,e.Yf,e.Uf);this.xf.Wf().po(n),this.Cf.Wf().po(e.$f-n),this.bf.Qt().Bh()}Nf(t){this.Mf!==null&&this.mf!==null&&(this.Mf=null,this.mf.Bf.style.display="none")}}function xn(s,t){return s.jf-t.jf}function Cn(s,t,e){const i=(s.jf-t.jf)/(s.wt-t.wt);return Math.sign(i)*Math.min(Math.abs(i),e)}class _c{constructor(t,e,i,n){this.Zf=null,this.Kf=null,this.Xf=null,this.Gf=null,this.Jf=null,this.Qf=0,this.tp=0,this.ip=t,this.sp=e,this.np=i,this.Mn=n}ep(t,e){if(this.Zf!==null){if(this.Zf.wt===e)return void(this.Zf.jf=t);if(Math.abs(this.Zf.jf-t)<this.Mn)return}this.Gf=this.Xf,this.Xf=this.Kf,this.Kf=this.Zf,this.Zf={wt:e,jf:t}}le(t,e){if(this.Zf===null||this.Kf===null||e-this.Zf.wt>50)return;let i=0;const n=Cn(this.Zf,this.Kf,this.sp),r=xn(this.Zf,this.Kf),o=[n],a=[r];if(i+=r,this.Xf!==null){const h=Cn(this.Kf,this.Xf,this.sp);if(Math.sign(h)===Math.sign(n)){const u=xn(this.Kf,this.Xf);if(o.push(h),a.push(u),i+=u,this.Gf!==null){const c=Cn(this.Xf,this.Gf,this.sp);if(Math.sign(c)===Math.sign(n)){const d=xn(this.Xf,this.Gf);o.push(c),a.push(d),i+=d}}}}let l=0;for(let h=0;h<o.length;++h)l+=a[h]/i*o[h];Math.abs(l)<this.ip||(this.Jf={jf:t,wt:e},this.tp=l,this.Qf=function(h,u){const c=Math.log(u);return Math.log(1*c/-h)/c}(Math.abs(l),this.np))}cu(t){const e=D(this.Jf),i=t-e.wt;return e.jf+this.tp*(Math.pow(this.np,i)-1)/Math.log(this.np)}uu(t){return this.Jf===null||this.rp(t)===this.Qf}rp(t){const e=t-D(this.Jf).wt;return Math.min(e,this.Qf)}}class yc{constructor(t,e){this.hp=void 0,this.ap=void 0,this.lp=void 0,this.ps=!1,this.op=t,this._p=e,this.up()}Pt(){this.up()}cp(){this.hp&&this.op.removeChild(this.hp),this.ap&&this.op.removeChild(this.ap),this.hp=void 0,this.ap=void 0}dp(){return this.ps!==this.fp()||this.lp!==this.pp()}pp(){return this._p.Qt().Ki().J(this._p.N().layout.textColor)>160?"dark":"light"}fp(){return this._p.N().layout.attributionLogo}vp(){const t=new URL(location.href);return t.hostname?"&utm_source="+t.hostname+t.pathname:""}up(){this.dp()&&(this.cp(),this.ps=this.fp(),this.ps&&(this.lp=this.pp(),this.ap=document.createElement("style"),this.ap.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.hp=document.createElement("a"),this.hp.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.vp()}`,this.hp.title="Charting by TradingView",this.hp.id="tv-attr-logo",this.hp.target="_blank",this.hp.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.hp.toggleAttribute("data-dark",this.lp==="dark"),this.op.appendChild(this.ap),this.op.appendChild(this.hp)))}}function Ce(s,t){const e=D(s.ownerDocument).createElement("canvas");s.appendChild(e);const i=su(e,{options:{allowResizeObserver:!0},transform:(n,r)=>({width:Math.max(n.width,r.width),height:Math.max(n.height,r.height)})});return i.resizeCanvasElement(t),i}function Me(s){var t;s.width=1,s.height=1,(t=s.getContext("2d"))==null||t.clearRect(0,0,1,1)}function zn(s,t,e,i){s.ih&&s.ih(t,e,i)}function ki(s,t,e,i){s.nt(t,e,i)}function On(s,t,e,i){const n=s(e,i);for(const r of n){const o=r.Tt(i);o!==null&&t(o)}}function Mn(s,t){return e=>{var i,n;return function(r){return r.Wt!==void 0}(e)?(((i=e.Wt())==null?void 0:i.wa())??"")!==t?[]:((n=e.ta)==null?void 0:n.call(e,s))??[]:[]}}function ur(s,t,e,i){if(!s.length)return;let n=0;const r=s[0].$t(i,!0);let o=t===1?e/2-(s[0].Wi()-r/2):s[0].Wi()-r/2-e/2;o=Math.max(0,o);for(let a=1;a<s.length;a++){const l=s[a],h=s[a-1],u=h.$t(i,!1),c=l.Wi(),d=h.Wi();if(t===1?c>d-u:c<d+u){const f=d-u*t;l.Fi(f);const v=f-t*u/2;if((t===1?v<0:v>e)&&o>0){const p=t===1?-1-v:v-e,g=Math.min(p,o);for(let m=n;m<s.length;m++)s[m].Fi(s[m].Wi()+t*g);o-=g}}else n=a,o=t===1?d-u-c:c-(d+u)}}class cr{constructor(t,e,i,n){this.Yi=null,this.mp=null,this.wp=!1,this.gp=new Li(200),this.Mp=null,this.bp=0,this.xp=!1,this.Sp=()=>{this.xp||this.yt.Cp().Qt().ar()},this.yp=()=>{this.xp||this.yt.Cp().Qt().ar()},this.yt=t,this.ys=e,this._l=e.layout,this.Au=i,this.Pp=n==="left",this.kp=Mn("normal",n),this.Tp=Mn("top",n),this.Rp=Mn("bottom",n),this.Pf=document.createElement("div"),this.Pf.style.height="100%",this.Pf.style.overflow="hidden",this.Pf.style.width="25px",this.Pf.style.left="0",this.Pf.style.position="relative",this.Dp=Ce(this.Pf,K({width:16,height:16})),this.Dp.subscribeSuggestedBitmapSizeChanged(this.Sp);const r=this.Dp.canvasElement;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Vp=Ce(this.Pf,K({width:16,height:16})),this.Vp.subscribeSuggestedBitmapSizeChanged(this.yp);const o=this.Vp.canvasElement;o.style.position="absolute",o.style.zIndex="2",o.style.left="0",o.style.top="0";const a={tf:this.Lf.bind(this),Jd:this.Lf.bind(this),$d:this.Of.bind(this),Hd:this.Of.bind(this),if:this.Ip.bind(this),Zd:this.Nf.bind(this),Yd:this.Nf.bind(this),Td:this.Bp.bind(this),Cd:this.Bp.bind(this),Ed:this.Ap.bind(this),uf:this.zf.bind(this)};this.wf=new Ki(this.Vp.canvasElement,a,{Wd:()=>!this.ys.handleScroll.vertTouchDrag,Fd:()=>!0})}m(){this.wf.m(),this.Vp.unsubscribeSuggestedBitmapSizeChanged(this.yp),Me(this.Vp.canvasElement),this.Vp.dispose(),this.Dp.unsubscribeSuggestedBitmapSizeChanged(this.Sp),Me(this.Dp.canvasElement),this.Dp.dispose(),this.Yi!==null&&this.Yi.Hl().u(this),this.Yi=null}Rf(){return this.Pf}P(){return this._l.fontSize}Ep(){const t=this.Au.N();return this.Mp!==t.k&&(this.gp.In(),this.Mp=t.k),t}zp(){if(this.Yi===null)return 0;let t=0;const e=this.Ep(),i=D(this.Dp.canvasElement.getContext("2d",{colorSpace:this.yt.Cp().N().layout.colorSpace}));i.save();const n=this.Yi.Va();i.font=this.Lp(),n.length>0&&(t=Math.max(this.gp.Vi(i,n[0].$a),this.gp.Vi(i,n[n.length-1].$a)));const r=this.Op();for(let h=r.length;h--;){const u=this.gp.Vi(i,r[h].ri());u>t&&(t=u)}const o=this.Yi.zt();if(o!==null&&this.mp!==null&&(a=this.ys.crosshair).mode!==2&&a.horzLine.visible&&a.horzLine.labelVisible){const h=this.Yi.Ts(1,o),u=this.Yi.Ts(this.mp.height-2,o);t=Math.max(t,this.gp.Vi(i,this.Yi.Xi(Math.floor(Math.min(h,u))+.11111111111111,o)),this.gp.Vi(i,this.Yi.Xi(Math.ceil(Math.max(h,u))-.11111111111111,o)))}var a;i.restore();const l=t||34;return Nn(Math.ceil(e.S+e.C+e.I+e.B+5+l))}Np(t){this.mp!==null&&ye(this.mp,t)||(this.mp=t,this.xp=!0,this.Dp.resizeCanvasElement(t),this.Vp.resizeCanvasElement(t),this.xp=!1,this.Pf.style.width=`${t.width}px`,this.Pf.style.height=`${t.height}px`)}Wp(){return D(this.mp).width}_s(t){this.Yi!==t&&(this.Yi!==null&&this.Yi.Hl().u(this),this.Yi=t,t.Hl().i(this.il.bind(this),this))}Wt(){return this.Yi}In(){const t=this.yt.Wf();this.yt.Cp().Qt().Bo(t,D(this.Wt()))}Fp(t){if(this.mp===null)return;const e={colorSpace:this.yt.Cp().N().layout.colorSpace};if(t!==1){this.Hp(),this.Dp.applySuggestedBitmapSize();const n=xe(this.Dp,e);n!==null&&(n.useBitmapCoordinateSpace(r=>{this.Up(r),this.$p(r)}),this.yt.qp(n,this.Rp),this.Yp(n),this.yt.qp(n,this.kp),this.jp(n))}this.Vp.applySuggestedBitmapSize();const i=xe(this.Vp,e);i!==null&&(i.useBitmapCoordinateSpace(({context:n,bitmapSize:r})=>{n.clearRect(0,0,r.width,r.height)}),this.Zp(i),this.yt.qp(i,this.Tp))}Vf(){return this.Dp.bitmapSize}If(t,e,i){const n=this.Vf();n.width>0&&n.height>0&&t.drawImage(this.Dp.canvasElement,e,i)}Pt(){var t;(t=this.Yi)==null||t.Va()}Lf(t){if(this.Yi===null||this.Yi.Zi()||!this.ys.handleScale.axisPressedMouseMove.price)return;const e=this.yt.Cp().Qt(),i=this.yt.Wf();this.wp=!0,e.Po(i,this.Yi,t.localY)}Of(t){if(this.Yi===null||!this.ys.handleScale.axisPressedMouseMove.price)return;const e=this.yt.Cp().Qt(),i=this.yt.Wf(),n=this.Yi;e.ko(i,n,t.localY)}Ip(){if(this.Yi===null||!this.ys.handleScale.axisPressedMouseMove.price)return;const t=this.yt.Cp().Qt(),e=this.yt.Wf(),i=this.Yi;this.wp&&(this.wp=!1,t.To(e,i))}Nf(t){if(this.Yi===null||!this.ys.handleScale.axisPressedMouseMove.price)return;const e=this.yt.Cp().Qt(),i=this.yt.Wf();this.wp=!1,e.To(i,this.Yi)}Bp(t){this.ys.handleScale.axisDoubleClickReset.price&&this.In()}Ap(t){this.Yi!==null&&(!this.yt.Cp().Qt().N().handleScale.axisPressedMouseMove.price||this.Yi.Le()||this.Yi.gl()||this.Kp(1))}zf(t){this.Kp(0)}Op(){const t=[],e=this.Yi===null?void 0:this.Yi;return(i=>{for(let n=0;n<i.length;++n){const r=i[n].Fs(this.yt.Wf(),e);for(let o=0;o<r.length;o++)t.push(r[o])}})(this.yt.Wf().Dt()),t}Up({context:t,bitmapSize:e}){const{width:i,height:n}=e,r=this.yt.Wf().Qt(),o=r.$(),a=r.xc();o===a?ji(t,0,0,i,n,o):go(t,0,0,i,n,o,a)}$p({context:t,bitmapSize:e,horizontalPixelRatio:i}){if(this.mp===null||this.Yi===null||!this.Yi.N().borderVisible)return;t.fillStyle=this.Yi.N().borderColor;const n=Math.max(1,Math.floor(this.Ep().S*i));let r;r=this.Pp?e.width-n:0,t.fillRect(r,0,n,e.height)}Yp(t){if(this.mp===null||this.Yi===null)return;const e=this.Yi.Va(),i=this.Yi.N(),n=this.Ep(),r=this.Pp?this.mp.width-n.C:0;i.borderVisible&&i.ticksVisible&&t.useBitmapCoordinateSpace(({context:o,horizontalPixelRatio:a,verticalPixelRatio:l})=>{o.fillStyle=i.borderColor;const h=Math.max(1,Math.floor(l)),u=Math.floor(.5*l),c=Math.round(n.C*a);o.beginPath();for(const d of e)o.rect(Math.floor(r*a),Math.round(d.Pa*l)-u,c,h);o.fill()}),t.useMediaCoordinateSpace(({context:o})=>{o.font=this.Lp(),o.fillStyle=i.textColor??this._l.textColor,o.textAlign=this.Pp?"right":"left",o.textBaseline="middle";const a=this.Pp?Math.round(r-n.I):Math.round(r+n.C+n.I),l=e.map(h=>this.gp.Di(o,h.$a));for(let h=e.length;h--;){const u=e[h];o.fillText(u.$a,a,u.Pa+l[h])}})}Hp(){if(this.mp===null||this.Yi===null)return;let t=this.mp.height/2;const e=[],i=this.Yi.Dt().slice(),n=this.yt.Wf(),r=this.Ep();this.Yi===n.$n()&&this.yt.Wf().Dt().forEach(l=>{n.Un(l)&&i.push(l)});const o=this.Yi.ba()[0],a=this.Yi;i.forEach(l=>{const h=l.Fs(n,a);h.forEach(u=>{u.Fi(null),u.Hi()&&e.push(u)}),o===l&&h.length>0&&(t=h[0].Bi())}),e.forEach(l=>l.Fi(l.Bi())),this.Yi.N().alignLabels&&this.Xp(e,r,t)}Xp(t,e,i){if(this.mp===null)return;const n=t.filter(o=>o.Bi()<=i),r=t.filter(o=>o.Bi()>i);n.sort((o,a)=>a.Bi()-o.Bi()),n.length&&r.length&&r.push(n[0]),r.sort((o,a)=>o.Bi()-a.Bi());for(const o of t){const a=Math.floor(o.$t(e)/2),l=o.Bi();l>-a&&l<a&&o.Fi(a),l>this.mp.height-a&&l<this.mp.height+a&&o.Fi(this.mp.height-a)}ur(n,1,this.mp.height,e),ur(r,-1,this.mp.height,e)}jp(t){if(this.mp===null)return;const e=this.Op(),i=this.Ep(),n=this.Pp?"right":"left";e.forEach(r=>{r.Ui()&&r.Tt(D(this.Yi)).nt(t,i,this.gp,n)})}Zp(t){if(this.mp===null||this.Yi===null)return;const e=this.yt.Cp().Qt(),i=[],n=this.yt.Wf(),r=e.Yu().Fs(n,this.Yi);r.length&&i.push(r);const o=this.Ep(),a=this.Pp?"right":"left";i.forEach(l=>{l.forEach(h=>{h.Tt(D(this.Yi)).nt(t,o,this.gp,a)})})}Kp(t){this.Pf.style.cursor=t===1?"ns-resize":"default"}il(){const t=this.zp();this.bp<t&&this.yt.Cp().Qt().Bh(),this.bp=t}Lp(){return Vi(this._l.fontSize,this._l.fontFamily)}}function wc(s,t){var e;return((e=s.Jh)==null?void 0:e.call(s,t))??[]}function dr(s,t){var e;return((e=s.Ws)==null?void 0:e.call(s,t))??[]}function fr(s,t){var e;return((e=s.us)==null?void 0:e.call(s,t))??[]}function bc(s,t){var e;return((e=s.Kh)==null?void 0:e.call(s,t))??[]}class is{constructor(t,e){this.mp=K({width:0,height:0}),this.Gp=null,this.Jp=null,this.Qp=null,this.tv=null,this.iv=!1,this.sv=new lt,this.nv=new lt,this.ev=0,this.rv=!1,this.hv=null,this.av=!1,this.lv=null,this.ov=null,this.xp=!1,this.Sp=()=>{this.xp||this._v===null||this.ts().ar()},this.yp=()=>{this.xp||this._v===null||this.ts().ar()},this._p=t,this._v=e,this._v.zo().i(this.uv.bind(this),this,!0),this.cv=document.createElement("td"),this.cv.style.padding="0",this.cv.style.position="relative";const i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.position="relative",i.style.overflow="hidden",this.dv=document.createElement("td"),this.dv.style.padding="0",this.fv=document.createElement("td"),this.fv.style.padding="0",this.cv.appendChild(i),this.Dp=Ce(i,K({width:16,height:16})),this.Dp.subscribeSuggestedBitmapSizeChanged(this.Sp);const n=this.Dp.canvasElement;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Vp=Ce(i,K({width:16,height:16})),this.Vp.subscribeSuggestedBitmapSizeChanged(this.yp);const r=this.Vp.canvasElement;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.yf=document.createElement("tr"),this.yf.appendChild(this.dv),this.yf.appendChild(this.cv),this.yf.appendChild(this.fv),this.pv(),this.wf=new Ki(this.Vp.canvasElement,this,{Wd:()=>this.hv===null&&!this._p.N().handleScroll.vertTouchDrag,Fd:()=>this.hv===null&&!this._p.N().handleScroll.horzTouchDrag})}m(){this.Gp!==null&&this.Gp.m(),this.Jp!==null&&this.Jp.m(),this.Qp=null,this.Vp.unsubscribeSuggestedBitmapSizeChanged(this.yp),Me(this.Vp.canvasElement),this.Vp.dispose(),this.Dp.unsubscribeSuggestedBitmapSizeChanged(this.Sp),Me(this.Dp.canvasElement),this.Dp.dispose(),this._v!==null&&(this._v.zo().u(this),this._v.m()),this.wf.m()}Wf(){return D(this._v)}vv(t){var e;this._v!==null&&this._v.zo().u(this),this._v=t,this._v!==null&&this._v.zo().i(is.prototype.uv.bind(this),this,!0),this.pv(),this._p.Sf().indexOf(this)===this._p.Sf().length-1?(this.Qp=this.Qp??new yc(this.cv,this._p),this.Qp.Pt()):((e=this.Qp)==null||e.cp(),this.Qp=null)}Cp(){return this._p}Rf(){return this.yf}pv(){if(this._v!==null&&(this.mv(),this.ts().js().length!==0)){if(this.Gp!==null){const t=this._v.Co();this.Gp._s(D(t))}if(this.Jp!==null){const t=this._v.yo();this.Jp._s(D(t))}}}wv(){this.Gp!==null&&this.Gp.Pt(),this.Jp!==null&&this.Jp.Pt()}fo(){return this._v!==null?this._v.fo():0}po(t){this._v&&this._v.po(t)}Ed(t){if(!this._v)return;this.gv();const e=t.localX,i=t.localY;this.Mv(e,i,t)}tf(t){this.gv(),this.bv(),this.Mv(t.localX,t.localY,t)}zd(t){if(!this._v)return;this.gv();const e=t.localX,i=t.localY;this.Mv(e,i,t)}Kd(t){this._v!==null&&(this.gv(),this.xv(t))}Td(t){this._v!==null&&this.Sv(this.nv,t)}Cd(t){this.Td(t)}$d(t){this.gv(),this.Cv(t),this.Mv(t.localX,t.localY,t)}Zd(t){this._v!==null&&(this.gv(),this.rv=!1,this.yv(t))}jd(t){this._v!==null&&this.xv(t)}cf(t){if(this.rv=!0,this.hv===null){const e={x:t.localX,y:t.localY};this.Pv(e,e,t)}}uf(t){this._v!==null&&(this.gv(),this._v.Qt().Uu(null),this.kv())}Tv(){return this.sv}Rv(){return this.nv}ef(){this.ev=1,this.ts().hn()}rf(t,e){if(!this._p.N().handleScale.pinch)return;const i=5*(e-this.ev);this.ev=e,this.ts().tc(t._t,i)}Jd(t){this.rv=!1,this.av=this.hv!==null,this.bv();const e=this.ts().Yu();this.hv!==null&&e.Vt()&&(this.lv={x:e.si(),y:e.ni()},this.hv={x:t.localX,y:t.localY})}Hd(t){if(this._v===null)return;const e=t.localX,i=t.localY;if(this.hv===null)this.Cv(t);else{this.av=!1;const n=D(this.lv),r=n.x+(e-this.hv.x),o=n.y+(i-this.hv.y);this.Mv(r,o,t)}}Yd(t){this.Cp().N().trackingMode.exitMode===0&&(this.av=!0),this.Dv(),this.yv(t)}jn(t,e){const i=this._v;return i===null?null:Eo(i,t,e)}Vv(t,e){D(e==="left"?this.Gp:this.Jp).Np(K({width:t,height:this.mp.height}))}Df(){return this.mp}Np(t){ye(this.mp,t)||(this.mp=t,this.xp=!0,this.Dp.resizeCanvasElement(t),this.Vp.resizeCanvasElement(t),this.xp=!1,this.cv.style.width=t.width+"px",this.cv.style.height=t.height+"px")}Iv(){const t=D(this._v);t.So(t.Co()),t.So(t.yo());for(const e of t.ba())if(t.Un(e)){const i=e.Wt();i!==null&&t.So(i),e.Ns()}for(const e of t.Oo())e.Ns()}Vf(){return this.Dp.bitmapSize}If(t,e,i){const n=this.Vf();n.width>0&&n.height>0&&t.drawImage(this.Dp.canvasElement,e,i)}Fp(t){if(t===0||this._v===null)return;t>1&&this.Iv(),this.Gp!==null&&this.Gp.Fp(t),this.Jp!==null&&this.Jp.Fp(t);const e={colorSpace:this._p.N().layout.colorSpace};if(t!==1){this.Dp.applySuggestedBitmapSize();const n=xe(this.Dp,e);n!==null&&(n.useBitmapCoordinateSpace(r=>{this.Up(r)}),this._v&&(this.Bv(n,wc),this.Av(n),this.Bv(n,dr),this.Bv(n,fr)))}this.Vp.applySuggestedBitmapSize();const i=xe(this.Vp,e);i!==null&&(i.useBitmapCoordinateSpace(({context:n,bitmapSize:r})=>{n.clearRect(0,0,r.width,r.height)}),this.Ev(i),this.Bv(i,bc),this.Bv(i,fr))}zv(){return this.Gp}Lv(){return this.Jp}qp(t,e){this.Bv(t,e)}uv(){this._v!==null&&this._v.zo().u(this),this._v=null}xv(t){this.Sv(this.sv,t)}Sv(t,e){const i=e.localX,n=e.localY;t.v()&&t.p(this.ts().At().Z_(i),{x:i,y:n},e)}Up({context:t,bitmapSize:e}){const{width:i,height:n}=e,r=this.ts(),o=r.$(),a=r.xc();o===a?ji(t,0,0,i,n,a):go(t,0,0,i,n,o,a)}Av(t){const e=D(this._v),i=e.Lo().lr().Tt(e);i!==null&&i.nt(t,!1)}Ev(t){this.Ov(t,dr,ki,this.ts().Yu())}Bv(t,e){const i=D(this._v),n=i.Dt(),r=i.Oo();for(const o of r)this.Ov(t,e,zn,o);for(const o of n)this.Ov(t,e,zn,o);for(const o of r)this.Ov(t,e,ki,o);for(const o of n)this.Ov(t,e,ki,o)}Ov(t,e,i,n){const r=D(this._v),o=r.Qt().Hu(),a=o!==null&&o.Wo===n,l=o!==null&&a&&o.Fo!==void 0?o.Fo.Kn:void 0;On(e,h=>i(h,t,a,l),n,r)}mv(){if(this._v===null)return;const t=this._p,e=this._v.Co().N().visible,i=this._v.yo().N().visible;e||this.Gp===null||(this.dv.removeChild(this.Gp.Rf()),this.Gp.m(),this.Gp=null),i||this.Jp===null||(this.fv.removeChild(this.Jp.Rf()),this.Jp.m(),this.Jp=null);const n=t.Qt().cc();e&&this.Gp===null&&(this.Gp=new cr(this,t.N(),n,"left"),this.dv.appendChild(this.Gp.Rf())),i&&this.Jp===null&&(this.Jp=new cr(this,t.N(),n,"right"),this.fv.appendChild(this.Jp.Rf()))}Nv(t){return t.df&&this.rv||this.hv!==null}Wv(t){return Math.max(0,Math.min(t,this.mp.width-1))}Fv(t){return Math.max(0,Math.min(t,this.mp.height-1))}Mv(t,e,i){this.ts().lc(this.Wv(t),this.Fv(e),i,D(this._v))}kv(){this.ts()._c()}Dv(){this.av&&(this.hv=null,this.kv())}Pv(t,e,i){this.hv=t,this.av=!1,this.Mv(e.x,e.y,i);const n=this.ts().Yu();this.lv={x:n.si(),y:n.ni()}}ts(){return this._p.Qt()}yv(t){if(!this.iv)return;const e=this.ts(),i=this.Wf();if(e.Vo(i,i.ks()),this.tv=null,this.iv=!1,e.rc(),this.ov!==null){const n=performance.now(),r=e.At();this.ov.le(r.iu(),n),this.ov.uu(n)||e._n(this.ov)}}gv(){this.hv=null}bv(){if(this._v){if(this.ts().hn(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)D(document.activeElement).blur();else{const t=document.getSelection();t!==null&&t.removeAllRanges()}!this._v.ks().Zi()&&this.ts().At().Zi()}}Cv(t){if(this._v===null)return;const e=this.ts(),i=e.At();if(i.Zi())return;const n=this._p.N(),r=n.handleScroll,o=n.kineticScroll;if((!r.pressedMouseMove||t.df)&&(!r.horzTouchDrag&&!r.vertTouchDrag||!t.df))return;const a=this._v.ks(),l=performance.now();if(this.tv!==null||this.Nv(t)||(this.tv={x:t.clientX,y:t.clientY,Lc:l,Hv:t.localX,Uv:t.localY}),this.tv!==null&&!this.iv&&(this.tv.x!==t.clientX||this.tv.y!==t.clientY)){if(t.df&&o.touch||!t.df&&o.mouse){const h=i.Q_();this.ov=new _c(.2/h,7/h,.997,15/h),this.ov.ep(i.iu(),this.tv.Lc)}else this.ov=null;a.Zi()||e.Ro(this._v,a,t.localY),e.nc(t.localX),this.iv=!0}this.iv&&(a.Zi()||e.Do(this._v,a,t.localY),e.ec(t.localX),this.ov!==null&&this.ov.ep(i.iu(),l))}}class vr{constructor(t,e,i,n,r){this.St=!0,this.mp=K({width:0,height:0}),this.Sp=()=>this.Fp(3),this.Pp=t==="left",this.Au=i.cc,this.ys=e,this.$v=n,this.qv=r,this.Pf=document.createElement("div"),this.Pf.style.width="25px",this.Pf.style.height="100%",this.Pf.style.overflow="hidden",this.Dp=Ce(this.Pf,K({width:16,height:16})),this.Dp.subscribeSuggestedBitmapSizeChanged(this.Sp)}m(){this.Dp.unsubscribeSuggestedBitmapSizeChanged(this.Sp),Me(this.Dp.canvasElement),this.Dp.dispose()}Rf(){return this.Pf}Df(){return this.mp}Np(t){ye(this.mp,t)||(this.mp=t,this.Dp.resizeCanvasElement(t),this.Pf.style.width=`${t.width}px`,this.Pf.style.height=`${t.height}px`,this.St=!0)}Fp(t){if(t<3&&!this.St||this.mp.width===0||this.mp.height===0)return;this.St=!1,this.Dp.applySuggestedBitmapSize();const e=xe(this.Dp,{colorSpace:this.ys.layout.colorSpace});e!==null&&e.useBitmapCoordinateSpace(i=>{this.Up(i),this.$p(i)})}Vf(){return this.Dp.bitmapSize}If(t,e,i){const n=this.Vf();n.width>0&&n.height>0&&t.drawImage(this.Dp.canvasElement,e,i)}$p({context:t,bitmapSize:e,horizontalPixelRatio:i,verticalPixelRatio:n}){if(!this.$v())return;t.fillStyle=this.ys.timeScale.borderColor;const r=Math.floor(this.Au.N().S*i),o=Math.floor(this.Au.N().S*n),a=this.Pp?e.width-r:0;t.fillRect(a,0,r,o)}Up({context:t,bitmapSize:e}){ji(t,0,0,e.width,e.height,this.qv())}}function ns(s){return t=>{var e;return((e=t.ia)==null?void 0:e.call(t,s))??[]}}const Sc=ns("normal"),xc=ns("top"),Cc=ns("bottom");class Mc{constructor(t,e){this.Yv=null,this.jv=null,this.M=null,this.Zv=!1,this.mp=K({width:0,height:0}),this.Kv=new lt,this.gp=new Li(5),this.xp=!1,this.Sp=()=>{this.xp||this._p.Qt().ar()},this.yp=()=>{this.xp||this._p.Qt().ar()},this._p=t,this.Yo=e,this.ys=t.N().layout,this.hp=document.createElement("tr"),this.Xv=document.createElement("td"),this.Xv.style.padding="0",this.Gv=document.createElement("td"),this.Gv.style.padding="0",this.Pf=document.createElement("td"),this.Pf.style.height="25px",this.Pf.style.padding="0",this.Jv=document.createElement("div"),this.Jv.style.width="100%",this.Jv.style.height="100%",this.Jv.style.position="relative",this.Jv.style.overflow="hidden",this.Pf.appendChild(this.Jv),this.Dp=Ce(this.Jv,K({width:16,height:16})),this.Dp.subscribeSuggestedBitmapSizeChanged(this.Sp);const i=this.Dp.canvasElement;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.Vp=Ce(this.Jv,K({width:16,height:16})),this.Vp.subscribeSuggestedBitmapSizeChanged(this.yp);const n=this.Vp.canvasElement;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0",this.hp.appendChild(this.Xv),this.hp.appendChild(this.Pf),this.hp.appendChild(this.Gv),this.Qv(),this._p.Qt().do().i(this.Qv.bind(this),this),this.wf=new Ki(this.Vp.canvasElement,this,{Wd:()=>!0,Fd:()=>!this._p.N().handleScroll.horzTouchDrag})}m(){this.wf.m(),this.Yv!==null&&this.Yv.m(),this.jv!==null&&this.jv.m(),this.Vp.unsubscribeSuggestedBitmapSizeChanged(this.yp),Me(this.Vp.canvasElement),this.Vp.dispose(),this.Dp.unsubscribeSuggestedBitmapSizeChanged(this.Sp),Me(this.Dp.canvasElement),this.Dp.dispose()}Rf(){return this.hp}tm(){return this.Yv}im(){return this.jv}tf(t){if(this.Zv)return;this.Zv=!0;const e=this._p.Qt();!e.At().Zi()&&this._p.N().handleScale.axisPressedMouseMove.time&&e.Qu(t.localX)}Jd(t){this.tf(t)}if(){const t=this._p.Qt();!t.At().Zi()&&this.Zv&&(this.Zv=!1,this._p.N().handleScale.axisPressedMouseMove.time&&t.ac())}$d(t){const e=this._p.Qt();!e.At().Zi()&&this._p.N().handleScale.axisPressedMouseMove.time&&e.hc(t.localX)}Hd(t){this.$d(t)}Zd(){this.Zv=!1;const t=this._p.Qt();t.At().Zi()&&!this._p.N().handleScale.axisPressedMouseMove.time||t.ac()}Yd(){this.Zd()}Td(){this._p.N().handleScale.axisDoubleClickReset.time&&this._p.Qt().cn()}Cd(){this.Td()}Ed(){this._p.Qt().N().handleScale.axisPressedMouseMove.time&&this.Kp(1)}uf(){this.Kp(0)}Df(){return this.mp}sm(){return this.Kv}nm(t,e,i){ye(this.mp,t)||(this.mp=t,this.xp=!0,this.Dp.resizeCanvasElement(t),this.Vp.resizeCanvasElement(t),this.xp=!1,this.Pf.style.width=`${t.width}px`,this.Pf.style.height=`${t.height}px`,this.Kv.p(t)),this.Yv!==null&&this.Yv.Np(K({width:e,height:t.height})),this.jv!==null&&this.jv.Np(K({width:i,height:t.height}))}rm(){const t=this.hm();return Math.ceil(t.S+t.C+t.P+t.A+t.V+t.am)}Pt(){this._p.Qt().At().Va()}Vf(){return this.Dp.bitmapSize}If(t,e,i){const n=this.Vf();n.width>0&&n.height>0&&t.drawImage(this.Dp.canvasElement,e,i)}Fp(t){if(t===0)return;const e={colorSpace:this.ys.colorSpace};if(t!==1){this.Dp.applySuggestedBitmapSize();const n=xe(this.Dp,e);n!==null&&(n.useBitmapCoordinateSpace(r=>{this.Up(r),this.$p(r),this.lm(n,Cc)}),this.Yp(n),this.lm(n,Sc)),this.Yv!==null&&this.Yv.Fp(t),this.jv!==null&&this.jv.Fp(t)}this.Vp.applySuggestedBitmapSize();const i=xe(this.Vp,e);i!==null&&(i.useBitmapCoordinateSpace(({context:n,bitmapSize:r})=>{n.clearRect(0,0,r.width,r.height)}),this.om([...this._p.Qt().js(),this._p.Qt().Yu()],i),this.lm(i,xc))}lm(t,e){const i=this._p.Qt().js();for(const n of i)On(e,r=>zn(r,t,!1,void 0),n,void 0);for(const n of i)On(e,r=>ki(r,t,!1,void 0),n,void 0)}Up({context:t,bitmapSize:e}){ji(t,0,0,e.width,e.height,this._p.Qt().xc())}$p({context:t,bitmapSize:e,verticalPixelRatio:i}){if(this._p.N().timeScale.borderVisible){t.fillStyle=this._m();const n=Math.max(1,Math.floor(this.hm().S*i));t.fillRect(0,0,e.width,n)}}Yp(t){const e=this._p.Qt().At(),i=e.Va();if(!i||i.length===0)return;const n=this.Yo.maxTickMarkWeight(i),r=this.hm(),o=e.N();o.borderVisible&&o.ticksVisible&&t.useBitmapCoordinateSpace(({context:a,horizontalPixelRatio:l,verticalPixelRatio:h})=>{a.strokeStyle=this._m(),a.fillStyle=this._m();const u=Math.max(1,Math.floor(l)),c=Math.floor(.5*l);a.beginPath();const d=Math.round(r.C*h);for(let f=i.length;f--;){const v=Math.round(i[f].coord*l);a.rect(v-c,0,u,d)}a.fill()}),t.useMediaCoordinateSpace(({context:a})=>{const l=r.S+r.C+r.A+r.P/2;a.textAlign="center",a.textBaseline="middle",a.fillStyle=this.H(),a.font=this.Lp();for(const h of i)if(h.weight<n){const u=h.needAlignCoordinate?this.um(a,h.coord,h.label):h.coord;a.fillText(h.label,u,l)}this._p.N().timeScale.allowBoldLabels&&(a.font=this.dm());for(const h of i)if(h.weight>=n){const u=h.needAlignCoordinate?this.um(a,h.coord,h.label):h.coord;a.fillText(h.label,u,l)}})}um(t,e,i){const n=this.gp.Vi(t,i),r=n/2,o=Math.floor(e-r)+.5;return o<0?e+=Math.abs(0-o):o+n>this.mp.width&&(e-=Math.abs(this.mp.width-(o+n))),e}om(t,e){const i=this.hm();for(const n of t)for(const r of n.cs())r.Tt().nt(e,i)}_m(){return this._p.N().timeScale.borderColor}H(){return this.ys.textColor}W(){return this.ys.fontSize}Lp(){return Vi(this.W(),this.ys.fontFamily)}dm(){return Vi(this.W(),this.ys.fontFamily,"bold")}hm(){this.M===null&&(this.M={S:1,L:NaN,A:NaN,V:NaN,Ji:NaN,C:5,P:NaN,k:"",Gi:new Li,am:0});const t=this.M,e=this.Lp();if(t.k!==e){const i=this.W();t.P=i,t.k=e,t.A=3*i/12,t.V=3*i/12,t.Ji=9*i/12,t.L=0,t.am=4*i/12,t.Gi.In()}return this.M}Kp(t){this.Pf.style.cursor=t===1?"ew-resize":"default"}Qv(){const t=this._p.Qt(),e=t.N();e.leftPriceScale.visible||this.Yv===null||(this.Xv.removeChild(this.Yv.Rf()),this.Yv.m(),this.Yv=null),e.rightPriceScale.visible||this.jv===null||(this.Gv.removeChild(this.jv.Rf()),this.jv.m(),this.jv=null);const i={cc:this._p.Qt().cc()},n=()=>e.leftPriceScale.borderVisible&&t.At().N().borderVisible,r=()=>t.xc();e.leftPriceScale.visible&&this.Yv===null&&(this.Yv=new vr("left",e,i,n,r),this.Xv.appendChild(this.Yv.Rf())),e.rightPriceScale.visible&&this.jv===null&&(this.jv=new vr("right",e,i,n,r),this.Gv.appendChild(this.jv.Rf()))}}var Pr;const Ec=!!He&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(s=>s.brand.includes("Chromium"))&&!!He&&((Pr=navigator==null?void 0:navigator.userAgentData)!=null&&Pr.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);class Pc{constructor(t,e,i){var n;this.fm=[],this.pm=[],this.vm=0,this.ja=0,this.no=0,this.wm=0,this.gm=0,this.Mm=null,this.bm=!1,this.sv=new lt,this.nv=new lt,this.Vu=new lt,this.xm=null,this.Sm=null,this.op=t,this.ys=e,this.Yo=i,this.hp=document.createElement("div"),this.hp.classList.add("tv-lightweight-charts"),this.hp.style.overflow="hidden",this.hp.style.direction="ltr",this.hp.style.width="100%",this.hp.style.height="100%",(n=this.hp).style.userSelect="none",n.style.webkitUserSelect="none",n.style.msUserSelect="none",n.style.MozUserSelect="none",n.style.webkitTapHighlightColor="transparent",this.Cm=document.createElement("table"),this.Cm.setAttribute("cellspacing","0"),this.hp.appendChild(this.Cm),this.ym=this.Pm.bind(this),En(this.ys)&&this.km(!0),this.ts=new cc(this.Bu.bind(this),this.ys,i),this.Qt().ju().i(this.Tm.bind(this),this),this.Rm=new Mc(this,this.Yo),this.Cm.appendChild(this.Rm.Rf());const r=e.autoSize&&this.Dm();let o=this.ys.width,a=this.ys.height;if(r||o===0||a===0){const l=t.getBoundingClientRect();o=o||l.width,a=a||l.height}this.Vm(o,a),this.Im(),t.appendChild(this.hp),this.Bm(),this.ts.At().pu().i(this.ts.Bh.bind(this.ts),this),this.ts.do().i(this.ts.Bh.bind(this.ts),this)}Qt(){return this.ts}N(){return this.ys}Sf(){return this.fm}Am(){return this.Rm}m(){this.km(!1),this.vm!==0&&window.cancelAnimationFrame(this.vm),this.ts.ju().u(this),this.ts.At().pu().u(this),this.ts.do().u(this),this.ts.m();for(const t of this.fm)this.Cm.removeChild(t.Rf()),t.Tv().u(this),t.Rv().u(this),t.m();this.fm=[];for(const t of this.pm)this.Em(t);this.pm=[],D(this.Rm).m(),this.hp.parentElement!==null&&this.hp.parentElement.removeChild(this.hp),this.Vu.m(),this.sv.m(),this.nv.m(),this.zm()}Vm(t,e,i=!1){if(this.ja===e&&this.no===t)return;const n=function(a){const l=Math.floor(a.width),h=Math.floor(a.height);return K({width:l-l%2,height:h-h%2})}(K({width:t,height:e}));this.ja=n.height,this.no=n.width;const r=this.ja+"px",o=this.no+"px";D(this.hp).style.height=r,D(this.hp).style.width=o,this.Cm.style.height=r,this.Cm.style.width=o,i?this.Lm(pt.gn(),performance.now()):this.ts.Bh()}Fp(t){t===void 0&&(t=pt.gn());for(let e=0;e<this.fm.length;e++)this.fm[e].Fp(t.en(e).tn);this.ys.timeScale.visible&&this.Rm.Fp(t.nn())}hr(t){var n;const e=En(this.ys);this.ts.hr(t);const i=En(this.ys);i!==e&&this.km(i),(n=t.layout)!=null&&n.panes&&this.Om(),this.Bm(),this.Nm(t)}Tv(){return this.sv}Rv(){return this.nv}ju(){return this.Vu}Wm(){this.Mm!==null&&(this.Lm(this.Mm,performance.now()),this.Mm=null);const t=this.Fm(null),e=document.createElement("canvas");e.width=t.width,e.height=t.height;const i=D(e.getContext("2d"));return this.Fm(i),e}Hm(t){return t==="left"&&!this.Um()||t==="right"&&!this.$m()||this.fm.length===0?0:D(t==="left"?this.fm[0].zv():this.fm[0].Lv()).Wp()}qm(){return this.ys.autoSize&&this.xm!==null}Af(){return this.hp}Ym(t){this.Sm=t,this.Sm?this.Af().style.setProperty("cursor",t):this.Af().style.removeProperty("cursor")}jm(){return this.Sm}Zm(t){return bt(this.fm[t]).Df()}Om(){this.pm.forEach(t=>{t.Pt()})}Nm(t){(t.autoSize!==void 0||!this.xm||t.width===void 0&&t.height===void 0)&&(t.autoSize&&!this.xm&&this.Dm(),t.autoSize===!1&&this.xm!==null&&this.zm(),t.autoSize||t.width===void 0&&t.height===void 0||this.Vm(t.width||this.no,t.height||this.ja))}Fm(t){let e=0,i=0;const n=this.fm[0],r=(a,l)=>{let h=0;for(let u=0;u<this.fm.length;u++){const c=this.fm[u],d=D(a==="left"?c.zv():c.Lv()),f=d.Vf();if(t!==null&&d.If(t,l,h),h+=f.height,u<this.fm.length-1){const v=this.pm[u],p=v.Vf();t!==null&&v.If(t,l,h),h+=p.height}}};this.Um()&&(r("left",0),e+=D(n.zv()).Vf().width);for(let a=0;a<this.fm.length;a++){const l=this.fm[a],h=l.Vf();if(t!==null&&l.If(t,e,i),i+=h.height,a<this.fm.length-1){const u=this.pm[a],c=u.Vf();t!==null&&u.If(t,e,i),i+=c.height}}e+=n.Vf().width,this.$m()&&(r("right",e),e+=D(n.Lv()).Vf().width);const o=(a,l,h)=>{D(a==="left"?this.Rm.tm():this.Rm.im()).If(D(t),l,h)};if(this.ys.timeScale.visible){const a=this.Rm.Vf();if(t!==null){let l=0;this.Um()&&(o("left",l,i),l=D(n.zv()).Vf().width),this.Rm.If(t,l,i),l+=a.width,this.$m()&&o("right",l,i)}i+=a.height}return K({width:e,height:i})}Km(){let t=0,e=0,i=0;for(const g of this.fm)this.Um()&&(e=Math.max(e,D(g.zv()).zp(),this.ys.leftPriceScale.minimumWidth)),this.$m()&&(i=Math.max(i,D(g.Lv()).zp(),this.ys.rightPriceScale.minimumWidth)),t+=g.fo();e=Nn(e),i=Nn(i);const n=this.no,r=this.ja,o=Math.max(n-e-i,0),a=1*this.pm.length,l=this.ys.timeScale.visible;let h=l?Math.max(this.Rm.rm(),this.ys.timeScale.minimumHeight):0;var u;h=(u=h)+u%2;const c=a+h,d=r<c?0:r-c,f=d/t;let v=0;const p=window.devicePixelRatio||1;for(let g=0;g<this.fm.length;++g){const m=this.fm[g];m.vv(this.ts.$s()[g]);let _=0,w=0;w=g===this.fm.length-1?Math.ceil((d-v)*p)/p:Math.round(m.fo()*f*p)/p,_=Math.max(w,2),v+=_,m.Np(K({width:o,height:_})),this.Um()&&m.Vv(e,"left"),this.$m()&&m.Vv(i,"right"),m.Wf()&&this.ts.Zu(m.Wf(),_)}this.Rm.nm(K({width:l?o:0,height:h}),l?e:0,l?i:0),this.ts.vo(o),this.wm!==e&&(this.wm=e),this.gm!==i&&(this.gm=i)}km(t){t?this.hp.addEventListener("wheel",this.ym,{passive:!1}):this.hp.removeEventListener("wheel",this.ym)}Xm(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return Ec?1/window.devicePixelRatio:1}Pm(t){if(!(t.deltaX!==0&&this.ys.handleScroll.mouseWheel||t.deltaY!==0&&this.ys.handleScale.mouseWheel))return;const e=this.Xm(t),i=e*t.deltaX/100,n=-e*t.deltaY/100;if(t.cancelable&&t.preventDefault(),n!==0&&this.ys.handleScale.mouseWheel){const r=Math.sign(n)*Math.min(1,Math.abs(n)),o=t.clientX-this.hp.getBoundingClientRect().left;this.Qt().tc(o,r)}i!==0&&this.ys.handleScroll.mouseWheel&&this.Qt().sc(-80*i)}Lm(t,e){var n;const i=t.nn();i===3&&this.Gm(),i!==3&&i!==2||(this.Jm(t),this.Qm(t,e),this.Rm.Pt(),this.fm.forEach(r=>{r.wv()}),((n=this.Mm)==null?void 0:n.nn())===3&&(this.Mm.vn(t),this.Gm(),this.Jm(this.Mm),this.Qm(this.Mm,e),t=this.Mm,this.Mm=null)),this.Fp(t)}Qm(t,e){for(const i of t.pn())this.mn(i,e)}Jm(t){const e=this.ts.$s();for(let i=0;i<e.length;i++)t.en(i).sn&&e[i].Ao()}mn(t,e){const i=this.ts.At();switch(t.an){case 0:i.mu();break;case 1:i.wu(t.Ft);break;case 2:i.dn(t.Ft);break;case 3:i.fn(t.Ft);break;case 4:i.eu();break;case 5:t.Ft.uu(e)||i.fn(t.Ft.cu(e))}}Bu(t){this.Mm!==null?this.Mm.vn(t):this.Mm=t,this.bm||(this.bm=!0,this.vm=window.requestAnimationFrame(e=>{if(this.bm=!1,this.vm=0,this.Mm!==null){const i=this.Mm;this.Mm=null,this.Lm(i,e);for(const n of i.pn())if(n.an===5&&!n.Ft.uu(e)){this.Qt()._n(n.Ft);break}}}))}Gm(){this.Im()}Em(t){this.Cm.removeChild(t.Rf()),t.m()}Im(){const t=this.ts.$s(),e=t.length,i=this.fm.length;for(let n=e;n<i;n++){const r=bt(this.fm.pop());this.Cm.removeChild(r.Rf()),r.Tv().u(this),r.Rv().u(this),r.m();const o=this.pm.pop();o!==void 0&&this.Em(o)}for(let n=i;n<e;n++){const r=new is(this,t[n]);if(r.Tv().i(this.tw.bind(this,r),this),r.Rv().i(this.iw.bind(this,r),this),this.fm.push(r),n>0){const o=new mc(this,n-1,n);this.pm.push(o),this.Cm.insertBefore(o.Rf(),this.Rm.Rf())}this.Cm.insertBefore(r.Rf(),this.Rm.Rf())}for(let n=0;n<e;n++){const r=t[n],o=this.fm[n];o.Wf()!==r?o.vv(r):o.pv()}this.Bm(),this.Km()}sw(t,e,i,n){var c;const r=new Map;t!==null&&this.ts.js().forEach(d=>{const f=d.Ks().Wr(t);f!==null&&r.set(d,f)});let o;if(t!==null){const d=(c=this.ts.At().ss(t))==null?void 0:c.originalTime;d!==void 0&&(o=d)}const a=this.Qt().Hu(),l=a!==null&&a.Wo instanceof Zi?a.Wo:void 0,h=a!==null&&a.Fo!==void 0?a.Fo.Zn:void 0,u=this.nw(n);return{ew:o,Re:t??void 0,rw:e??void 0,hw:u!==-1?u:void 0,aw:l,lw:r,ow:h,_w:i??void 0}}nw(t){let e=-1;if(t)e=this.fm.indexOf(t);else{const i=this.Qt().Yu().Us();i!==null&&(e=this.Qt().$s().indexOf(i))}return e}tw(t,e,i,n){this.sv.p(()=>this.sw(e,i,n,t))}iw(t,e,i,n){this.nv.p(()=>this.sw(e,i,n,t))}Tm(t,e,i){var n;this.Ym(((n=this.Qt().Hu())==null?void 0:n.Uo)??null),this.Vu.p(()=>this.sw(t,e,i))}Bm(){const t=this.ys.timeScale.visible?"":"none";this.Rm.Rf().style.display=t}Um(){return this.fm[0].Wf().Co().N().visible}$m(){return this.fm[0].Wf().yo().N().visible}Dm(){return"ResizeObserver"in window&&(this.xm=new ResizeObserver(t=>{const e=t[t.length-1];e&&this.Vm(e.contentRect.width,e.contentRect.height)}),this.xm.observe(this.op,{box:"border-box"}),!0)}zm(){this.xm!==null&&this.xm.disconnect(),this.xm=null}}function En(s){return!!(s.handleScroll.mouseWheel||s.handleScale.mouseWheel)}function Ic(s){return s.open===void 0&&s.value===void 0}function Tc(s){return function(t){return t.open!==void 0}(s)||function(t){return t.value!==void 0}(s)}function pr(s,t,e,i){const n=e.value,r={Re:t,wt:s,Ft:[n,n,n,n],ew:i};return e.color!==void 0&&(r.R=e.color),r}function kc(s,t,e,i){const n=e.value,r={Re:t,wt:s,Ft:[n,n,n,n],ew:i};return e.lineColor!==void 0&&(r.vt=e.lineColor),e.topColor!==void 0&&(r.mr=e.topColor),e.bottomColor!==void 0&&(r.wr=e.bottomColor),r}function Dc(s,t,e,i){const n=e.value,r={Re:t,wt:s,Ft:[n,n,n,n],ew:i};return e.topLineColor!==void 0&&(r.gr=e.topLineColor),e.bottomLineColor!==void 0&&(r.Mr=e.bottomLineColor),e.topFillColor1!==void 0&&(r.br=e.topFillColor1),e.topFillColor2!==void 0&&(r.Sr=e.topFillColor2),e.bottomFillColor1!==void 0&&(r.Cr=e.bottomFillColor1),e.bottomFillColor2!==void 0&&(r.yr=e.bottomFillColor2),r}function Ac(s,t,e,i){const n={Re:t,wt:s,Ft:[e.open,e.high,e.low,e.close],ew:i};return e.color!==void 0&&(n.R=e.color),n}function Rc(s,t,e,i){const n={Re:t,wt:s,Ft:[e.open,e.high,e.low,e.close],ew:i};return e.color!==void 0&&(n.R=e.color),e.borderColor!==void 0&&(n.Ht=e.borderColor),e.wickColor!==void 0&&(n.vr=e.wickColor),n}function Fc(s,t,e,i,n){const r=bt(n)(e),o=Math.max(...r),a=Math.min(...r),l=r[r.length-1],h=[l,o,a,l],{time:u,color:c,...d}=e;return{Re:t,wt:s,Ft:h,ew:i,se:d,R:c}}function ei(s){return s.Ft!==void 0}function gr(s,t){return t.customValues!==void 0&&(s.uw=t.customValues),s}function de(s){return(t,e,i,n,r,o)=>function(a,l){return l?l(a):Ic(a)}(i,o)?gr({wt:t,Re:e,ew:n},i):gr(s(t,e,i,n,r),i)}function mr(s){return{Candlestick:de(Rc),Bar:de(Ac),Area:de(kc),Baseline:de(Dc),Histogram:de(pr),Line:de(pr),Custom:de(Fc)}[s]}function _r(s){return{Re:0,cw:new Map,Hh:s}}function yr(s,t){if(s!==void 0&&s.length!==0)return{dw:t.key(s[0].wt),fw:t.key(s[s.length-1].wt)}}function wr(s){let t;return s.forEach(e=>{t===void 0&&(t=e.ew)}),bt(t)}class Bc{constructor(t){this.pw=new Map,this.mw=new Map,this.ww=new Map,this.gw=[],this.Yo=t}m(){this.pw.clear(),this.mw.clear(),this.ww.clear(),this.gw=[]}Mw(t,e){let i=this.pw.size!==0,n=!1;const r=this.mw.get(t);if(r!==void 0)if(this.mw.size===1)i=!1,n=!0,this.pw.clear();else for(const l of this.gw)l.pointData.cw.delete(t)&&(n=!0);let o=[];if(e.length!==0){const l=e.map(f=>f.time),h=this.Yo.createConverterToInternalObj(e),u=mr(t.Rr()),c=t.da(),d=t.pa();o=e.map((f,v)=>{const p=h(f.time),g=this.Yo.key(p);let m=this.pw.get(g);m===void 0&&(m=_r(p),this.pw.set(g,m),n=!0);const _=u(p,m.Re,f,l[v],c,d);return m.cw.set(t,_),_})}i&&this.bw(),this.xw(t,o);let a=-1;if(n){const l=[];this.pw.forEach(h=>{l.push({timeWeight:0,time:h.Hh,pointData:h,originalTime:wr(h.cw)})}),l.sort((h,u)=>this.Yo.key(h.time)-this.Yo.key(u.time)),a=this.Sw(l)}return this.Cw(t,a,function(l,h,u){const c=yr(l,u),d=yr(h,u);if(c!==void 0&&d!==void 0)return{yw:!1,zh:c.fw>=d.fw&&c.dw>=d.dw}}(this.mw.get(t),r,this.Yo))}vc(t){return this.Mw(t,[])}Pw(t,e,i){const n=e;(function(g){g.ew===void 0&&(g.ew=g.time)})(n),this.Yo.preprocessData(e);const r=this.Yo.createConverterToInternalObj([e])(e.time),o=this.ww.get(t);if(!i&&o!==void 0&&this.Yo.key(r)<this.Yo.key(o))throw new Error(`Cannot update oldest data, last time=${o}, new time=${r}`);let a=this.pw.get(this.Yo.key(r));if(i&&a===void 0)throw new Error("Cannot update non-existing data point when historicalUpdate is true");const l=a===void 0;a===void 0&&(a=_r(r),this.pw.set(this.Yo.key(r),a));const h=mr(t.Rr()),u=t.da(),c=t.pa(),d=h(r,a.Re,e,n.ew,u,c);a.cw.set(t,d),i?this.kw(t,d,a.Re):this.Tw(t,d);const f={zh:ei(d),yw:i};if(!l)return this.Cw(t,-1,f);const v={timeWeight:0,time:a.Hh,pointData:a,originalTime:wr(a.cw)},p=$e(this.gw,this.Yo.key(v.time),(g,m)=>this.Yo.key(g.time)<m);this.gw.splice(p,0,v);for(let g=p;g<this.gw.length;++g)Pn(this.gw[g].pointData,g);return this.Yo.fillWeightsForPoints(this.gw,p),this.Cw(t,p,f)}Tw(t,e){let i=this.mw.get(t);i===void 0&&(i=[],this.mw.set(t,i));const n=i.length!==0?i[i.length-1]:null;n===null||this.Yo.key(e.wt)>this.Yo.key(n.wt)?ei(e)&&i.push(e):ei(e)?i[i.length-1]=e:i.splice(-1,1),this.ww.set(t,e.wt)}kw(t,e,i){const n=this.mw.get(t);if(n===void 0)return;const r=$e(n,i,(o,a)=>o.Re<a);ei(e)?n[r]=e:n.splice(r,1)}xw(t,e){e.length!==0?(this.mw.set(t,e.filter(ei)),this.ww.set(t,e[e.length-1].wt)):(this.mw.delete(t),this.ww.delete(t))}bw(){for(const t of this.gw)t.pointData.cw.size===0&&this.pw.delete(this.Yo.key(t.time))}Sw(t){let e=-1;for(let i=0;i<this.gw.length&&i<t.length;++i){const n=this.gw[i],r=t[i];if(this.Yo.key(n.time)!==this.Yo.key(r.time)){e=i;break}r.timeWeight=n.timeWeight,Pn(r.pointData,i)}if(e===-1&&this.gw.length!==t.length&&(e=Math.min(this.gw.length,t.length)),e===-1)return-1;for(let i=e;i<t.length;++i)Pn(t[i].pointData,i);return this.Yo.fillWeightsForPoints(t,e),this.gw=t,e}Rw(){if(this.mw.size===0)return null;let t=0;return this.mw.forEach(e=>{e.length!==0&&(t=Math.max(t,e[e.length-1].Re))}),t}Cw(t,e,i){const n={wo:new Map,At:{Y_:this.Rw()}};if(e!==-1)this.mw.forEach((r,o)=>{n.wo.set(o,{se:r,Dw:o===t?i:void 0})}),this.mw.has(t)||n.wo.set(t,{se:[],Dw:i}),n.At.Vw=this.gw,n.At.Iw=e;else{const r=this.mw.get(t);n.wo.set(t,{se:r||[],Dw:i})}return n}}function Pn(s,t){s.Re=t,s.cw.forEach(e=>{e.Re=t})}function Vc(s,t){return s.wt<t}function Lc(s,t){return t<s.wt}function Nc(s,t,e){const i=t.Uh(),n=t.bi(),r=$e(s,i,Vc),o=So(s,n,Lc);if(!e)return{from:r,to:o};let a=r,l=o;return r>0&&r<s.length&&s[r].wt>=i&&(a=r-1),o>0&&o<s.length&&s[o-1].wt<=n&&(l=o+1),{from:a,to:l}}class ss{constructor(t,e,i){this.Bw=!0,this.Aw=!0,this.Ew=!0,this.zw=[],this.Lw=null,this.Jn=t,this.Qn=e,this.Ow=i}Pt(t){this.Bw=!0,t==="data"&&(this.Aw=!0),t==="options"&&(this.Ew=!0)}Tt(){return this.Jn.Vt()?(this.Nw(),this.Lw===null?null:this.Ww):null}Fw(){this.zw=this.zw.map(t=>({...t,...this.Jn.Rh().Dr(t.wt)}))}Hw(){this.Lw=null}Nw(){this.Aw&&(this.Uw(),this.Aw=!1),this.Ew&&(this.Fw(),this.Ew=!1),this.Bw&&(this.$w(),this.Bw=!1)}$w(){const t=this.Jn.Wt(),e=this.Qn.At();if(this.Hw(),e.Zi()||t.Zi())return;const i=e.ye();if(i===null||this.Jn.Ks().zr()===0)return;const n=this.Jn.zt();n!==null&&(this.Lw=Nc(this.zw,i,this.Ow),this.qw(t,e,n.Ft),this.Yw())}}class zc{constructor(t,e){this.jw=t,this.Yi=e}nt(t,e,i){this.jw.draw(t,this.Yi,e,i)}}class Oc extends ss{constructor(t,e,i){super(t,e,!1),this.sh=i,this.Ww=new zc(this.sh.renderer(),n=>{const r=t.zt();return r===null?null:t.Wt().Nt(n,r.Ft)})}fa(t){return this.sh.priceValueBuilder(t)}va(t){return this.sh.isWhitespace(t)}Uw(){const t=this.Jn.Rh();this.zw=this.Jn.Ks().Hr().map(e=>({wt:e.Re,_t:NaN,...t.Dr(e.Re),Zw:e.se}))}qw(t,e){e.j_(this.zw,ci(this.Lw))}Yw(){this.sh.update({bars:this.zw.map(Wc),barSpacing:this.Qn.At().Q_(),visibleRange:this.Lw},this.Jn.N())}}function Wc(s){return{x:s._t,time:s.wt,originalData:s.Zw,barColor:s.cr}}const Yc={color:"#2196f3"},Xc=(s,t,e)=>{const i=ge(e);return new Oc(s,t,i)};function rs(s){const t={value:s.Ft[3],time:s.ew};return s.uw!==void 0&&(t.customValues=s.uw),t}function br(s){const t=rs(s);return s.R!==void 0&&(t.color=s.R),t}function $c(s){const t=rs(s);return s.vt!==void 0&&(t.lineColor=s.vt),s.mr!==void 0&&(t.topColor=s.mr),s.wr!==void 0&&(t.bottomColor=s.wr),t}function Hc(s){const t=rs(s);return s.gr!==void 0&&(t.topLineColor=s.gr),s.Mr!==void 0&&(t.bottomLineColor=s.Mr),s.br!==void 0&&(t.topFillColor1=s.br),s.Sr!==void 0&&(t.topFillColor2=s.Sr),s.Cr!==void 0&&(t.bottomFillColor1=s.Cr),s.yr!==void 0&&(t.bottomFillColor2=s.yr),t}function To(s){const t={open:s.Ft[0],high:s.Ft[1],low:s.Ft[2],close:s.Ft[3],time:s.ew};return s.uw!==void 0&&(t.customValues=s.uw),t}function Qc(s){const t=To(s);return s.R!==void 0&&(t.color=s.R),t}function jc(s){const t=To(s),{R:e,Ht:i,vr:n}=s;return e!==void 0&&(t.color=e),i!==void 0&&(t.borderColor=i),n!==void 0&&(t.wickColor=n),t}function Wn(s){return{Area:$c,Line:br,Baseline:Hc,Histogram:br,Bar:Qc,Candlestick:jc,Custom:Gc}[s]}function Gc(s){const t=s.ew;return{...s.se,time:t}}const Uc={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},Jc={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},Zc={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:po,panes:{enableResize:!0,separatorColor:"#E0E3EB",separatorHoverColor:"rgba(178, 181, 189, 0.2)"},attributionLogo:!0,colorSpace:"srgb",colorParsers:[]},In={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0},Kc={rightOffset:0,barSpacing:6,minBarSpacing:.5,maxBarSpacing:0,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0,ignoreWhitespaceIndices:!1};function Sr(){return{width:0,height:0,autoSize:!1,layout:Zc,crosshair:Uc,grid:Jc,overlayPriceScales:{...In},leftPriceScale:{...In,visible:!1},rightPriceScale:{...In,visible:!0},timeScale:Kc,localization:{locale:He?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class ko{constructor(t,e,i){this.bf=t,this.Kw=e,this.Xw=i??0}applyOptions(t){this.bf.Qt().$u(this.Kw,t,this.Xw)}options(){return this.Yi().N()}width(){return Ui(this.Kw)?this.bf.Hm(this.Kw):0}Yi(){return D(this.bf.Qt().qu(this.Kw,this.Xw)).Wt}}class qc{constructor(t,e,i,n){this.bf=t,this.yt=i,this.Gw=e,this.Jw=n}getHeight(){return this.yt.$t()}setHeight(t){const e=this.bf.Qt(),i=e.Cc(this.yt);e.Xu(i,t)}paneIndex(){return this.bf.Qt().Cc(this.yt)}moveTo(t){const e=this.paneIndex();e!==t&&(_t(t>=0&&t<this.bf.Sf().length,"Invalid pane index"),this.bf.Qt().Gu(e,t))}getSeries(){return this.yt.wo().map(t=>this.Gw(t))??[]}getHTMLElement(){return this.bf.Sf()[this.paneIndex()].Rf()}attachPrimitive(t){this.yt.ua(t),t.attached&&t.attached({chart:this.Jw,requestUpdate:()=>this.yt.Qt().Bh()})}detachPrimitive(t){this.yt.ca(t)}priceScale(t){if(this.yt.co(t)===null)throw new Error(`Cannot find price scale with id: ${t}`);return new ko(this.bf,t,this.paneIndex())}}const td={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class xr{constructor(t){this.ir=t}applyOptions(t){this.ir.hr(t)}options(){return this.ir.N()}Qw(){return this.ir}}class ed{constructor(t,e,i,n,r,o){this.tg=new lt,this.Jn=t,this.ig=e,this.sg=i,this.Yo=r,this.Jw=n,this.ng=o}m(){this.tg.m()}priceFormatter(){return this.Jn.ra()}priceToCoordinate(t){const e=this.Jn.zt();return e===null?null:this.Jn.Wt().Nt(t,e.Ft)}coordinateToPrice(t){const e=this.Jn.zt();return e===null?null:this.Jn.Wt().Ts(t,e.Ft)}barsInLogicalRange(t){if(t===null)return null;const e=new ze(new ai(t.from,t.to)).o_(),i=this.Jn.Ks();if(i.Zi())return null;const n=i.Wr(e.Uh(),1),r=i.Wr(e.bi(),-1),o=D(i.Lr()),a=D(i.Zs());if(n!==null&&r!==null&&n.Re>r.Re)return{barsBefore:t.from-o,barsAfter:a-t.to};const l={barsBefore:n===null||n.Re===o?t.from-o:n.Re-o,barsAfter:r===null||r.Re===a?a-t.to:a-r.Re};return n!==null&&r!==null&&(l.from=n.ew,l.to=r.ew),l}setData(t){this.Yo,this.Jn.Rr(),this.ig.eg(this.Jn,t),this.rg("full")}update(t,e=!1){this.Jn.Rr(),this.ig.hg(this.Jn,t,e),this.rg("update")}dataByIndex(t,e){const i=this.Jn.Ks().Wr(t,e);return i===null?null:Wn(this.seriesType())(i)}data(){const t=Wn(this.seriesType());return this.Jn.Ks().Hr().map(e=>t(e))}subscribeDataChanged(t){this.tg.i(t)}unsubscribeDataChanged(t){this.tg._(t)}applyOptions(t){this.Jn.hr(t)}options(){return Gt(this.Jn.N())}priceScale(){return this.sg.priceScale(this.Jn.Wt().wa(),this.getPane().paneIndex())}createPriceLine(t){const e=xt(Gt(td),t),i=this.Jn.Oh(e);return new xr(i)}removePriceLine(t){this.Jn.Nh(t.Qw())}priceLines(){return this.Jn.Wh().map(t=>new xr(t))}seriesType(){return this.Jn.Rr()}attachPrimitive(t){this.Jn.ua(t),t.attached&&t.attached({chart:this.Jw,series:this,requestUpdate:()=>this.Jn.Qt().Bh(),horzScaleBehavior:this.Yo})}detachPrimitive(t){this.Jn.ca(t),t.detached&&t.detached(),this.Jn.Qt().Bh()}getPane(){const t=this.Jn,e=D(this.Jn.Qt().Hn(t));return this.ng(e)}moveToPane(t){this.Jn.Qt().Mc(this.Jn,t)}rg(t){this.tg.v()&&this.tg.p(t)}}class id{constructor(t,e,i){this.ag=new lt,this.g_=new lt,this.Kv=new lt,this.ts=t,this.uh=t.At(),this.Rm=e,this.uh.du().i(this.lg.bind(this)),this.uh.fu().i(this.og.bind(this)),this.Rm.sm().i(this._g.bind(this)),this.Yo=i}m(){this.uh.du().u(this),this.uh.fu().u(this),this.Rm.sm().u(this),this.ag.m(),this.g_.m(),this.Kv.m()}scrollPosition(){return this.uh.iu()}scrollToPosition(t,e){e?this.uh._u(t,1e3):this.ts.fn(t)}scrollToRealTime(){this.uh.ou()}getVisibleRange(){const t=this.uh.O_();return t===null?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){const e={from:this.Yo.convertHorzItemToInternal(t.from),to:this.Yo.convertHorzItemToInternal(t.to)},i=this.uh.H_(e);this.ts.wc(i)}getVisibleLogicalRange(){const t=this.uh.L_();return t===null?null:{from:t.Uh(),to:t.bi()}}setVisibleLogicalRange(t){_t(t.from<=t.to,"The from index cannot be after the to index."),this.ts.wc(t)}resetTimeScale(){this.ts.cn()}fitContent(){this.ts.mu()}logicalToCoordinate(t){const e=this.ts.At();return e.Zi()?null:e.qt(t)}coordinateToLogical(t){return this.uh.Zi()?null:this.uh.Z_(t)}timeToIndex(t,e){const i=this.Yo.convertHorzItemToInternal(t);return this.uh.A_(i,e)}timeToCoordinate(t){const e=this.timeToIndex(t,!1);return e===null?null:this.uh.qt(e)}coordinateToTime(t){const e=this.ts.At(),i=e.Z_(t),n=e.ss(i);return n===null?null:n.originalTime}width(){return this.Rm.Df().width}height(){return this.Rm.Df().height}subscribeVisibleTimeRangeChange(t){this.ag.i(t)}unsubscribeVisibleTimeRangeChange(t){this.ag._(t)}subscribeVisibleLogicalRangeChange(t){this.g_.i(t)}unsubscribeVisibleLogicalRangeChange(t){this.g_._(t)}subscribeSizeChange(t){this.Kv.i(t)}unsubscribeSizeChange(t){this.Kv._(t)}applyOptions(t){this.uh.hr(t)}options(){return{...Gt(this.uh.N()),barSpacing:this.uh.Q_()}}lg(){this.ag.v()&&this.ag.p(this.getVisibleRange())}og(){this.g_.v()&&this.g_.p(this.getVisibleLogicalRange())}_g(t){this.Kv.p(t.width,t.height)}}function nd(s){if(s===void 0||s.type==="custom")return;const t=s;t.minMove!==void 0&&t.precision===void 0&&(t.precision=function(e){if(e>=1)return 0;let i=0;for(;i<8;i++){const n=Math.round(e);if(Math.abs(n-e)<1e-8)return i;e*=10}return i}(t.minMove))}function Cr(s){return function(t){if(bi(t.handleScale)){const i=t.handleScale;t.handleScale={axisDoubleClickReset:{time:i,price:i},axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(t.handleScale!==void 0){const{axisPressedMouseMove:i,axisDoubleClickReset:n}=t.handleScale;bi(i)&&(t.handleScale.axisPressedMouseMove={time:i,price:i}),bi(n)&&(t.handleScale.axisDoubleClickReset={time:n,price:n})}const e=t.handleScroll;bi(e)&&(t.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e})}(s),s}class sd{constructor(t,e,i){this.ug=new Map,this.cg=new Map,this.dg=new lt,this.fg=new lt,this.pg=new lt,this.ku=new WeakMap,this.vg=new Bc(e);const n=i===void 0?Gt(Sr()):xt(Gt(Sr()),Cr(i));this.mg=e,this.bf=new Pc(t,n,e),this.bf.Tv().i(o=>{this.dg.v()&&this.dg.p(this.wg(o()))},this),this.bf.Rv().i(o=>{this.fg.v()&&this.fg.p(this.wg(o()))},this),this.bf.ju().i(o=>{this.pg.v()&&this.pg.p(this.wg(o()))},this);const r=this.bf.Qt();this.gg=new id(r,this.bf.Am(),this.mg)}remove(){this.bf.Tv().u(this),this.bf.Rv().u(this),this.bf.ju().u(this),this.gg.m(),this.bf.m(),this.ug.clear(),this.cg.clear(),this.dg.m(),this.fg.m(),this.pg.m(),this.vg.m()}resize(t,e,i){this.autoSizeActive()||this.bf.Vm(t,e,i)}addCustomSeries(t,e={},i=0){const n=(r=>({type:"Custom",isBuiltIn:!1,defaultOptions:{...Yc,...r.defaultOptions()},Mg:Xc,bg:r}))(ge(t));return this.xg(n,e,i)}addSeries(t,e={},i=0){return this.xg(t,e,i)}removeSeries(t){const e=bt(this.ug.get(t)),i=this.vg.vc(e);this.bf.Qt().vc(e),this.Sg(i),this.ug.delete(t),this.cg.delete(e)}eg(t,e){this.Sg(this.vg.Mw(t,e))}hg(t,e,i){this.Sg(this.vg.Pw(t,e,i))}subscribeClick(t){this.dg.i(t)}unsubscribeClick(t){this.dg._(t)}subscribeCrosshairMove(t){this.pg.i(t)}unsubscribeCrosshairMove(t){this.pg._(t)}subscribeDblClick(t){this.fg.i(t)}unsubscribeDblClick(t){this.fg._(t)}priceScale(t,e=0){return new ko(this.bf,t,e)}timeScale(){return this.gg}applyOptions(t){this.bf.hr(Cr(t))}options(){return this.bf.N()}takeScreenshot(){return this.bf.Wm()}removePane(t){this.bf.Qt().Ku(t)}swapPanes(t,e){this.bf.Qt().Gu(t,e)}autoSizeActive(){return this.bf.qm()}chartElement(){return this.bf.Af()}panes(){return this.bf.Qt().$s().map(t=>this.Cg(t))}paneSize(t=0){const e=this.bf.Zm(t);return{height:e.height,width:e.width}}setCrosshairPosition(t,e,i){const n=this.ug.get(i);if(n===void 0)return;const r=this.bf.Qt().Hn(n);r!==null&&this.bf.Qt().oc(t,e,r)}clearCrosshairPosition(){this.bf.Qt()._c(!0)}horzBehaviour(){return this.mg}xg(t,e={},i=0){_t(t.Mg!==void 0),nd(e.priceFormat),t.type==="Candlestick"&&function(l){l.borderColor!==void 0&&(l.borderUpColor=l.borderColor,l.borderDownColor=l.borderColor),l.wickColor!==void 0&&(l.wickUpColor=l.wickColor,l.wickDownColor=l.wickColor)}(e);const n=xt(Gt(fo),Gt(t.defaultOptions),e),r=t.Mg,o=new Zi(this.bf.Qt(),t.type,n,r,t.bg);this.bf.Qt().dc(o,i);const a=new ed(o,this,this,this,this.mg,l=>this.Cg(l));return this.ug.set(a,o),this.cg.set(o,a),a}Sg(t){const e=this.bf.Qt();e.uc(t.At.Y_,t.At.Vw,t.At.Iw),t.wo.forEach((i,n)=>n.ht(i.se,i.Dw)),e.At().R_(),e.J_()}yg(t){return bt(this.cg.get(t))}wg(t){const e=new Map;t.lw.forEach((n,r)=>{const o=r.Rr(),a=Wn(o)(n);if(o!=="Custom")_t(Tc(a));else{const l=r.pa();_t(!l||l(a)===!1)}e.set(this.yg(r),a)});const i=t.aw!==void 0&&this.cg.has(t.aw)?this.yg(t.aw):void 0;return{time:t.ew,logical:t.Re,point:t.rw,paneIndex:t.hw,hoveredSeries:i,hoveredObjectId:t.ow,seriesData:e,sourceEvent:t._w}}Cg(t){let e=this.ku.get(t);return e||(e=new qc(this.bf,i=>this.yg(i),t,this),this.ku.set(t,e)),e}}function rd(s){if(fi(s)){const t=document.getElementById(s);return _t(t!==null,`Cannot find element in DOM with id=${s}`),t}return s}function od(s,t,e){const i=rd(s),n=new sd(i,t,e);return t.setOptions(n.options()),n}function ad(s,t){return od(s,new ar,ar.Wc(t))}class ld extends ss{constructor(t,e){super(t,e,!0)}qw(t,e,i){e.j_(this.zw,ci(this.Lw)),t.Dl(this.zw,i,ci(this.Lw))}Pg(t,e){return{wt:t,gt:e,_t:NaN,ut:NaN}}Uw(){const t=this.Jn.Rh();this.zw=this.Jn.Ks().Hr().map(e=>{const i=e.Ft[3];return this.kg(e.Re,i,t)})}}function hd(s,t,e,i,n,r,o){if(t.length===0||i.from>=t.length||i.to<=0)return;const{context:a,horizontalPixelRatio:l,verticalPixelRatio:h}=s,u=t[i.from];let c=r(s,u),d=u;if(i.to-i.from<2){const f=n/2;a.beginPath();const v={_t:u._t-f,ut:u.ut},p={_t:u._t+f,ut:u.ut};a.moveTo(v._t*l,v.ut*h),a.lineTo(p._t*l,p.ut*h),o(s,c,v,p)}else{const f=(p,g)=>{o(s,c,d,g),a.beginPath(),c=p,d=g};let v=d;a.beginPath(),a.moveTo(u._t*l,u.ut*h);for(let p=i.from+1;p<i.to;++p){v=t[p];const g=r(s,v);switch(e){case 0:a.lineTo(v._t*l,v.ut*h);break;case 1:a.lineTo(v._t*l,t[p-1].ut*h),g!==c&&(f(g,v),a.lineTo(v._t*l,t[p-1].ut*h)),a.lineTo(v._t*l,v.ut*h);break;case 2:{const[m,_]=ud(t,p-1,p);a.bezierCurveTo(m._t*l,m.ut*h,_._t*l,_.ut*h,v._t*l,v.ut*h);break}}e!==1&&g!==c&&(f(g,v),a.moveTo(v._t*l,v.ut*h))}(d!==v||d===v&&e===1)&&o(s,c,d,v)}}const Mr=6;function Tn(s,t){return{_t:s._t-t._t,ut:s.ut-t.ut}}function Er(s,t){return{_t:s._t/t,ut:s.ut/t}}function ud(s,t,e){const i=Math.max(0,t-1),n=Math.min(s.length-1,e+1);var r,o;return[(r=s[t],o=Er(Tn(s[e],s[i]),Mr),{_t:r._t+o._t,ut:r.ut+o.ut}),Tn(s[e],Er(Tn(s[n],s[t]),Mr))]}function cd(s,t){const e=s.context;e.strokeStyle=t,e.stroke()}class dd extends Pe{constructor(){super(...arguments),this.rt=null}ht(t){this.rt=t}et(t){if(this.rt===null)return;const{ot:e,lt:i,Tg:n,Rg:r,ct:o,Kt:a,Dg:l}=this.rt;if(i===null)return;const h=t.context;h.lineCap="butt",h.lineWidth=o*t.verticalPixelRatio,Ye(h,a),h.lineJoin="round";const u=this.Vg.bind(this);r!==void 0&&hd(t,e,r,i,n,u,cd),l&&function(c,d,f,v,p){if(v.to-v.from<=0)return;const{horizontalPixelRatio:g,verticalPixelRatio:m,context:_}=c;let w=null;const y=Math.max(1,Math.floor(g))%2/2,x=f*m+y;for(let M=v.to-1;M>=v.from;--M){const b=d[M];if(b){const S=p(c,b);S!==w&&(_.beginPath(),w!==null&&_.fill(),_.fillStyle=S,w=S);const C=Math.round(b._t*g)+y,E=b.ut*m;_.moveTo(C,E),_.arc(C,E,x,0,2*Math.PI)}}_.fill()}(t,e,l,i,u)}}class fd extends dd{Vg(t,e){return e.vt}}class vd extends ld{constructor(){super(...arguments),this.Ww=new fd}kg(t,e,i){return{...this.Pg(t,e),...i.Dr(t)}}Yw(){const t=this.Jn.N(),e={ot:this.zw,Kt:t.lineStyle,Rg:t.lineVisible?t.lineType:void 0,ct:t.lineWidth,Dg:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0,lt:this.Lw,Tg:this.Qn.At().Q_()};this.Ww.ht(e)}}const pd={type:"Line",isBuiltIn:!0,defaultOptions:{color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Mg:(s,t)=>new vd(s,t)};class gd extends ss{constructor(t,e){super(t,e,!1)}qw(t,e,i){e.j_(this.zw,ci(this.Lw)),t.Il(this.zw,i,ci(this.Lw))}aM(t,e,i){return{wt:t,qh:e.Ft[0],Yh:e.Ft[1],jh:e.Ft[2],Zh:e.Ft[3],_t:NaN,Bl:NaN,Al:NaN,El:NaN,zl:NaN}}Uw(){const t=this.Jn.Rh();this.zw=this.Jn.Ks().Hr().map(e=>this.kg(e.Re,e,t))}}class md extends Pe{constructor(){super(...arguments),this.Yt=null,this.sM=0}ht(t){this.Yt=t}et(t){if(this.Yt===null||this.Yt.Ks.length===0||this.Yt.lt===null)return;const{horizontalPixelRatio:e}=t;this.sM=function(r,o){if(r>=2.5&&r<=4)return Math.floor(3*o);const a=1-.2*Math.atan(Math.max(4,r)-4)/(.5*Math.PI),l=Math.floor(r*a*o),h=Math.floor(r*o),u=Math.min(l,h);return Math.max(Math.floor(o),u)}(this.Yt.Q_,e),this.sM>=2&&Math.floor(e)%2!=this.sM%2&&this.sM--;const i=this.Yt.Ks;this.Yt.lM&&this.oM(t,i,this.Yt.lt),this.Yt.Mi&&this.$p(t,i,this.Yt.lt);const n=this._M(e);(!this.Yt.Mi||this.sM>2*n)&&this.uM(t,i,this.Yt.lt)}oM(t,e,i){if(this.Yt===null)return;const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let a="",l=Math.min(Math.floor(r),Math.floor(this.Yt.Q_*r));l=Math.max(Math.floor(r),Math.min(l,this.sM));const h=Math.floor(.5*l);let u=null;for(let c=i.from;c<i.to;c++){const d=e[c];d.pr!==a&&(n.fillStyle=d.pr,a=d.pr);const f=Math.round(Math.min(d.Bl,d.zl)*o),v=Math.round(Math.max(d.Bl,d.zl)*o),p=Math.round(d.Al*o),g=Math.round(d.El*o);let m=Math.round(r*d._t)-h;const _=m+l-1;u!==null&&(m=Math.max(u+1,m),m=Math.min(m,_));const w=_-m+1;n.fillRect(m,p,w,f-p),n.fillRect(m,v+1,w,g-v),u=_}}_M(t){let e=Math.floor(1*t);this.sM<=2*e&&(e=Math.floor(.5*(this.sM-1)));const i=Math.max(Math.floor(t),e);return this.sM<=2*i?Math.max(Math.floor(t),Math.floor(1*t)):i}$p(t,e,i){if(this.Yt===null)return;const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let a="";const l=this._M(r);let h=null;for(let u=i.from;u<i.to;u++){const c=e[u];c.dr!==a&&(n.fillStyle=c.dr,a=c.dr);let d=Math.round(c._t*r)-Math.floor(.5*this.sM);const f=d+this.sM-1,v=Math.round(Math.min(c.Bl,c.zl)*o),p=Math.round(Math.max(c.Bl,c.zl)*o);if(h!==null&&(d=Math.max(h+1,d),d=Math.min(d,f)),this.Yt.Q_*r>2*l)_u(n,d,v,f-d+1,p-v+1,l);else{const g=f-d+1;n.fillRect(d,v,g,p-v+1)}h=f}}uM(t,e,i){if(this.Yt===null)return;const{context:n,horizontalPixelRatio:r,verticalPixelRatio:o}=t;let a="";const l=this._M(r);for(let h=i.from;h<i.to;h++){const u=e[h];let c=Math.round(Math.min(u.Bl,u.zl)*o),d=Math.round(Math.max(u.Bl,u.zl)*o),f=Math.round(u._t*r)-Math.floor(.5*this.sM),v=f+this.sM-1;if(u.cr!==a){const p=u.cr;n.fillStyle=p,a=p}this.Yt.Mi&&(f+=l,c+=l,v-=l,d-=l),c>d||n.fillRect(f,c,v-f+1,d-c+1)}}}class _d extends gd{constructor(){super(...arguments),this.Ww=new md}kg(t,e,i){return{...this.aM(t,e,i),...i.Dr(t)}}Yw(){const t=this.Jn.N();this.Ww.ht({Ks:this.zw,Q_:this.Qn.At().Q_(),lM:t.wickVisible,Mi:t.borderVisible,lt:this.Lw})}}const yd={type:"Candlestick",isBuiltIn:!0,defaultOptions:{upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Mg:(s,t)=>new _d(s,t)};({...fo});var wd=20,bd=1,je=1e6,Sd=1e6,xd=-7,Cd=21,Md=!1,vi="[big.js] ",Ie=vi+"Invalid ",qi=Ie+"decimal places",Ed=Ie+"rounding mode",Do=vi+"Division by zero",U={},Yt=void 0,Pd=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function Ao(){function s(t){var e=this;if(!(e instanceof s))return t===Yt?Ao():new s(t);if(t instanceof s)e.s=t.s,e.e=t.e,e.c=t.c.slice();else{if(typeof t!="string"){if(s.strict===!0&&typeof t!="bigint")throw TypeError(Ie+"value");t=t===0&&1/t<0?"-0":String(t)}Id(e,t)}e.constructor=s}return s.prototype=U,s.DP=wd,s.RM=bd,s.NE=xd,s.PE=Cd,s.strict=Md,s.roundDown=0,s.roundHalfUp=1,s.roundHalfEven=2,s.roundUp=3,s}function Id(s,t){var e,i,n;if(!Pd.test(t))throw Error(Ie+"number");for(s.s=t.charAt(0)=="-"?(t=t.slice(1),-1):1,(e=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(e<0&&(e=i),e+=+t.slice(i+1),t=t.substring(0,i)):e<0&&(e=t.length),n=t.length,i=0;i<n&&t.charAt(i)=="0";)++i;if(i==n)s.c=[s.e=0];else{for(;n>0&&t.charAt(--n)=="0";);for(s.e=e-i-1,s.c=[],e=0;i<=n;)s.c[e++]=+t.charAt(i++)}return s}function Te(s,t,e,i){var n=s.c;if(e===Yt&&(e=s.constructor.RM),e!==0&&e!==1&&e!==2&&e!==3)throw Error(Ed);if(t<1)i=e===3&&(i||!!n[0])||t===0&&(e===1&&n[0]>=5||e===2&&(n[0]>5||n[0]===5&&(i||n[1]!==Yt))),n.length=1,i?(s.e=s.e-t+1,n[0]=1):n[0]=s.e=0;else if(t<n.length){if(i=e===1&&n[t]>=5||e===2&&(n[t]>5||n[t]===5&&(i||n[t+1]!==Yt||n[t-1]&1))||e===3&&(i||!!n[0]),n.length=t,i){for(;++n[--t]>9;)if(n[t]=0,t===0){++s.e,n.unshift(1);break}}for(t=n.length;!n[--t];)n.pop()}return s}function ke(s,t,e){var i=s.e,n=s.c.join(""),r=n.length;if(t)n=n.charAt(0)+(r>1?"."+n.slice(1):"")+(i<0?"e":"e+")+i;else if(i<0){for(;++i;)n="0"+n;n="0."+n}else if(i>0)if(++i>r)for(i-=r;i--;)n+="0";else i<r&&(n=n.slice(0,i)+"."+n.slice(i));else r>1&&(n=n.charAt(0)+"."+n.slice(1));return s.s<0&&e?"-"+n:n}U.abs=function(){var s=new this.constructor(this);return s.s=1,s};U.cmp=function(s){var t,e=this,i=e.c,n=(s=new e.constructor(s)).c,r=e.s,o=s.s,a=e.e,l=s.e;if(!i[0]||!n[0])return i[0]?r:n[0]?-o:0;if(r!=o)return r;if(t=r<0,a!=l)return a>l^t?1:-1;for(o=(a=i.length)<(l=n.length)?a:l,r=-1;++r<o;)if(i[r]!=n[r])return i[r]>n[r]^t?1:-1;return a==l?0:a>l^t?1:-1};U.div=function(s){var t=this,e=t.constructor,i=t.c,n=(s=new e(s)).c,r=t.s==s.s?1:-1,o=e.DP;if(o!==~~o||o<0||o>je)throw Error(qi);if(!n[0])throw Error(Do);if(!i[0])return s.s=r,s.c=[s.e=0],s;var a,l,h,u,c,d=n.slice(),f=a=n.length,v=i.length,p=i.slice(0,a),g=p.length,m=s,_=m.c=[],w=0,y=o+(m.e=t.e-s.e)+1;for(m.s=r,r=y<0?0:y,d.unshift(0);g++<a;)p.push(0);do{for(h=0;h<10;h++){if(a!=(g=p.length))u=a>g?1:-1;else for(c=-1,u=0;++c<a;)if(n[c]!=p[c]){u=n[c]>p[c]?1:-1;break}if(u<0){for(l=g==a?n:d;g;){if(p[--g]<l[g]){for(c=g;c&&!p[--c];)p[c]=9;--p[c],p[g]+=10}p[g]-=l[g]}for(;!p[0];)p.shift()}else break}_[w++]=u?h:++h,p[0]&&u?p[g]=i[f]||0:p=[i[f]]}while((f++<v||p[0]!==Yt)&&r--);return!_[0]&&w!=1&&(_.shift(),m.e--,y--),w>y&&Te(m,y,e.RM,p[0]!==Yt),m};U.eq=function(s){return this.cmp(s)===0};U.gt=function(s){return this.cmp(s)>0};U.gte=function(s){return this.cmp(s)>-1};U.lt=function(s){return this.cmp(s)<0};U.lte=function(s){return this.cmp(s)<1};U.minus=U.sub=function(s){var t,e,i,n,r=this,o=r.constructor,a=r.s,l=(s=new o(s)).s;if(a!=l)return s.s=-l,r.plus(s);var h=r.c.slice(),u=r.e,c=s.c,d=s.e;if(!h[0]||!c[0])return c[0]?s.s=-l:h[0]?s=new o(r):s.s=1,s;if(a=u-d){for((n=a<0)?(a=-a,i=h):(d=u,i=c),i.reverse(),l=a;l--;)i.push(0);i.reverse()}else for(e=((n=h.length<c.length)?h:c).length,a=l=0;l<e;l++)if(h[l]!=c[l]){n=h[l]<c[l];break}if(n&&(i=h,h=c,c=i,s.s=-s.s),(l=(e=c.length)-(t=h.length))>0)for(;l--;)h[t++]=0;for(l=t;e>a;){if(h[--e]<c[e]){for(t=e;t&&!h[--t];)h[t]=9;--h[t],h[e]+=10}h[e]-=c[e]}for(;h[--l]===0;)h.pop();for(;h[0]===0;)h.shift(),--d;return h[0]||(s.s=1,h=[d=0]),s.c=h,s.e=d,s};U.mod=function(s){var t,e=this,i=e.constructor,n=e.s,r=(s=new i(s)).s;if(!s.c[0])throw Error(Do);return e.s=s.s=1,t=s.cmp(e)==1,e.s=n,s.s=r,t?new i(e):(n=i.DP,r=i.RM,i.DP=i.RM=0,e=e.div(s),i.DP=n,i.RM=r,this.minus(e.times(s)))};U.neg=function(){var s=new this.constructor(this);return s.s=-s.s,s};U.plus=U.add=function(s){var t,e,i,n=this,r=n.constructor;if(s=new r(s),n.s!=s.s)return s.s=-s.s,n.minus(s);var o=n.e,a=n.c,l=s.e,h=s.c;if(!a[0]||!h[0])return h[0]||(a[0]?s=new r(n):s.s=n.s),s;if(a=a.slice(),t=o-l){for(t>0?(l=o,i=h):(t=-t,i=a),i.reverse();t--;)i.push(0);i.reverse()}for(a.length-h.length<0&&(i=h,h=a,a=i),t=h.length,e=0;t;a[t]%=10)e=(a[--t]=a[t]+h[t]+e)/10|0;for(e&&(a.unshift(e),++l),t=a.length;a[--t]===0;)a.pop();return s.c=a,s.e=l,s};U.pow=function(s){var t=this,e=new t.constructor("1"),i=e,n=s<0;if(s!==~~s||s<-1e6||s>Sd)throw Error(Ie+"exponent");for(n&&(s=-s);s&1&&(i=i.times(t)),s>>=1,!!s;)t=t.times(t);return n?e.div(i):i};U.prec=function(s,t){if(s!==~~s||s<1||s>je)throw Error(Ie+"precision");return Te(new this.constructor(this),s,t)};U.round=function(s,t){if(s===Yt)s=0;else if(s!==~~s||s<-1e6||s>je)throw Error(qi);return Te(new this.constructor(this),s+this.e+1,t)};U.sqrt=function(){var s,t,e,i=this,n=i.constructor,r=i.s,o=i.e,a=new n("0.5");if(!i.c[0])return new n(i);if(r<0)throw Error(vi+"No square root");r=Math.sqrt(+ke(i,!0,!0)),r===0||r===1/0?(t=i.c.join(""),t.length+o&1||(t+="0"),r=Math.sqrt(t),o=((o+1)/2|0)-(o<0||o&1),s=new n((r==1/0?"5e":(r=r.toExponential()).slice(0,r.indexOf("e")+1))+o)):s=new n(r+""),o=s.e+(n.DP+=4);do e=s,s=a.times(e.plus(i.div(e)));while(e.c.slice(0,o).join("")!==s.c.slice(0,o).join(""));return Te(s,(n.DP-=4)+s.e+1,n.RM)};U.times=U.mul=function(s){var t,e=this,i=e.constructor,n=e.c,r=(s=new i(s)).c,o=n.length,a=r.length,l=e.e,h=s.e;if(s.s=e.s==s.s?1:-1,!n[0]||!r[0])return s.c=[s.e=0],s;for(s.e=l+h,o<a&&(t=n,n=r,r=t,h=o,o=a,a=h),t=new Array(h=o+a);h--;)t[h]=0;for(l=a;l--;){for(a=0,h=o+l;h>l;)a=t[h]+r[l]*n[h-l-1]+a,t[h--]=a%10,a=a/10|0;t[h]=a}for(a?++s.e:t.shift(),l=t.length;!t[--l];)t.pop();return s.c=t,s};U.toExponential=function(s,t){var e=this,i=e.c[0];if(s!==Yt){if(s!==~~s||s<0||s>je)throw Error(qi);for(e=Te(new e.constructor(e),++s,t);e.c.length<s;)e.c.push(0)}return ke(e,!0,!!i)};U.toFixed=function(s,t){var e=this,i=e.c[0];if(s!==Yt){if(s!==~~s||s<0||s>je)throw Error(qi);for(e=Te(new e.constructor(e),s+e.e+1,t),s=s+e.e+1;e.c.length<s;)e.c.push(0)}return ke(e,!1,!!i)};U[Symbol.for("nodejs.util.inspect.custom")]=U.toJSON=U.toString=function(){var s=this,t=s.constructor;return ke(s,s.e<=t.NE||s.e>=t.PE,!!s.c[0])};U.toNumber=function(){var s=+ke(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(s.toString()))throw Error(vi+"Imprecise conversion");return s};U.toPrecision=function(s,t){var e=this,i=e.constructor,n=e.c[0];if(s!==Yt){if(s!==~~s||s<1||s>je)throw Error(Ie+"precision");for(e=Te(new i(e),s,t);e.c.length<s;)e.c.push(0)}return ke(e,s<=e.e||e.e<=i.NE||e.e>=i.PE,!!n)};U.valueOf=function(){var s=this,t=s.constructor;if(t.strict===!0)throw Error(vi+"valueOf disallowed");return ke(s,s.e<=t.NE||s.e>=t.PE,!0)};var Td=Ao(),Ro=class extends Error{constructor(s="Not enough data"){super(s),Object.setPrototypeOf(this,new.target.prototype),this.name="NotEnoughDataError"}},kd=class{constructor(){Qt(this,"result")}getResult(){try{return this.getResultOrThrow()}catch{return null}}getResultOrThrow(){if(this.result===void 0)throw new Ro;return this.result}get isStable(){return this.result!==void 0}add(s){return this.update(s,!1)}replace(s){return this.update(s,!0)}updates(s,t=!1){return s.map(e=>this.update(e,t))}},Dd=class extends kd{constructor(){super(...arguments);Qt(this,"previousHighest");Qt(this,"highest");Qt(this,"previousLowest");Qt(this,"lowest");Qt(this,"previousResult")}},Ad=class extends Dd{setResult(s,t){return t&&(this.highest=this.previousHighest,this.lowest=this.previousLowest,this.result=this.previousResult),this.highest===void 0?this.highest=s:s.gt(this.highest)?(this.previousHighest=this.highest,this.highest=s):this.previousHighest=this.highest,this.lowest===void 0?this.lowest=s:s.lt(this.lowest)?(this.previousLowest=this.lowest,this.lowest=s):this.previousLowest=this.lowest,this.previousResult=this.result,this.result=s}},Rd=class extends Ad{constructor(s){super(),this.interval=s}},Fd=class extends Rd{constructor(t){super(t);Qt(this,"pricesCounter",0);Qt(this,"weightFactor");this.interval=t,this.weightFactor=2/(this.interval+1)}update(t,e){e?e&&this.pricesCounter===0&&this.pricesCounter++:this.pricesCounter++;const i=new Td(t);return e&&this.previousResult?this.setResult(i.times(this.weightFactor).add(this.previousResult.times(1-this.weightFactor)),e):this.setResult(i.times(this.weightFactor).add((this.result??i).times(1-this.weightFactor)),e)}getResultOrThrow(){if(this.pricesCounter<this.interval)throw new Ro;return this.result}get isStable(){try{return this.getResultOrThrow(),!0}catch{return!1}}};function kn({chart:s,period:t,candleData:e=[],color:i="#1677ff",precision:n=6}){let r=null,o=null,a=null;return{init:()=>{var c;a=new Fd(t);const u=[];return e.forEach(d=>{a.add(d.close);const f=a.getResult();f&&u.push({time:d.time,value:f.toNumber()})}),u.length>0&&(r=s.addSeries(pd,{color:i,lineWidth:1,priceLineVisible:!1,lastValueVisible:!1}),r.setData(u),o=(c=u[u.length-1])==null?void 0:c.time),u.slice(-1)},update:(u,c)=>{if(!r||c===o)return;a.add(u);const d=a.getResult();let f=null;return d&&(f={time:c,value:d.toNumber()},r.update(f)),o=c,f}}}const Bd={class:"times my-2 flex space-between"},Vd={key:0,class:"text-center"},Ld={key:1,id:"klineChart",style:{height:"200px"}},Nd={key:0,class:"info"},zd={class:"price"},Od={class:"label"},Wd={class:"label"},Yd={class:"label"},Xd={class:"label"},$d={class:"ma"},Hd={class:"ma5"},Qd={class:"ma10"},jd={class:"ma30"},Gd={__name:"DwChart",props:["symbol","up"],setup(s){const t=$n(),e=Hi(),i=s,n=q([{text:"1M",value:"1min",time:1},{text:"5M",value:"5min",time:5},{text:"15M",value:"15min",time:15},{text:"30M",value:"30min",time:30},{text:"1H",value:"60min",time:60},{text:"1D",value:"1day",time:360},{text:"1W",value:"1week",time:1800},{text:"1 Month",value:"1mon",time:1800}]);let r=null,o=null;const a={},l=q({text:"15M",value:"15min",time:15}),h=q("15M"),u=q(["15M"]),c=q(!1),d=q(!1),f=q([]),v=({selectedValues:b,selectedOptions:S})=>{c.value=!1,l.value.value!==b[0]&&(l.value=n.value.find(C=>C.value===b[0]),u.value=b,h.value=S[0].text)};Yn(()=>{e.on("kline",b=>{const{symbol:S,period:C,floating:E=0}=b;if(S===i.symbol&&C===l.value.value&&(b.time=p(new Date(b.time*1e3)),o)){b.open-=E,b.close-=E,b.high-=E,b.low-=E,o.update(b),g.value[0]=b;const I=a.ma5.update(b.close,b.time);I&&(g.value[1]=I);const P=a.ma10.update(b.close,b.time);P&&(g.value[2]=P);const T=a.ma30.update(b.close,b.time);T&&(g.value[3]=T)}})}),Wi(()=>{e.off("kline")});function p(b){return Date.UTC(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),0,0)/1e3}const g=q([]);function m(b){const S=Array.from(b.seriesData.values());S.length&&(g.value=S)}function _(){const b=l.value;if(!i.symbol)return;const S={from:Date.parse(new Date)/1e3-b.time*24*60*60,to:Date.parse(new Date)/1e3,symbol:i.symbol,period:b.value};d.value=!0,co(S).then(C=>{if((C==null?void 0:C.type)==="ok"){const E=[],I=C.data.map(P=>(P.time=p(new Date(P.time)),E.push(P.close),P))||[];setTimeout(()=>{x();const P=[...new Map(I.map(T=>[T.id,T])).values()];f.value=P,o.setData(P),P[0].open<10?o.applyOptions({priceFormat:{precision:4,minMove:1e-4}}):o.applyOptions({priceFormat:{precision:2,minMove:.01}}),g.value[0]=P.slice(-1)[0],setTimeout(()=>{const T=Date.now();a.ma5=kn({chart:r,period:5,candleData:P,color:"#f69201"}),g.value[1]=a.ma5.init()[0],a.ma10=kn({chart:r,period:10,candleData:P,color:"#8455a9"}),g.value[2]=a.ma10.init()[0],a.ma30=kn({chart:r,period:30,candleData:P,color:"#1568de"}),g.value[3]=a.ma30.init()[0],console.log("耗时"+(Date.now()-T)),r.subscribeCrosshairMove(m)},10)},10)}}).finally(()=>{d.value=!1})}Jt(()=>i.symbol,b=>{b&&(l.value=n.value[2],h.value=n.value[2].text,u.value=[n.value[2].value],g.value=[],r&&r.unsubscribeCrosshairMove(m))}),Ir(()=>{_()});const w={layout:{background:{type:"Solid",color:"#1e1e1e"},textColor:"#d1d4dc"},crosshair:{color:"#888"},priceScale:{borderColor:"#555"}},y={layout:{background:{type:"Solid",color:"#ffffff"},textColor:"#333"},crosshair:{color:"#888"},priceScale:{borderColor:"#ccc"}};Jt(()=>t.theme,b=>{r&&(b==="light"?r.applyOptions(y):r.applyOptions(w))});function x(){const b=Date.now();console.log("initChart");const S=document.getElementById("klineChart");r&&(r.remove(),r.unsubscribeCrosshairMove());let C={timeScale:{timeVisible:!0,secondsVisible:!0,borderColor:"#ccc"},grid:{vertLines:{visible:!1},horzLines:{visible:!1},right:"5%"},layout:{attributionLogo:!1},autoSize:!0};t.theme==="light"?C=Object.assign(C,y):C=Object.assign(C,w),r=ad(S,C),r.applyOptions({crosshair:{mode:Vn.Hidden}}),o=r.addSeries(yd,{upColor:"#85bd00",downColor:"#f6543e"}),r.timeScale().applyOptions({rightOffset:2}),M(),console.log(Date.now()-b)}function M(){const b=document.getElementById("tv-attr-logo");console.log(b),b&&b.remove()}return(b,S)=>{var L,F,X,W,et,nt,J,Z,at,st;const C=Xn,E=$i,I=Gn,P=di,T=Yi,R=Xi("i18n-t");return Q(),it(Ot,null,[z("div",Bd,[B(E,{onClick:S[0]||(S[0]=tt=>c.value=!0),size:"medium",plain:"",type:"primary"},{default:ot(()=>[oe(rt(A(h))+" ",1),B(C,{name:"arrow-down"})]),_:1}),B(P,{show:A(c),"onUpdate:show":S[3]||(S[3]=tt=>we(c)?c.value=tt:null),position:"bottom",round:"","safe-area-inset-bottom":!0},{default:ot(()=>[B(I,{columns:A(n),modelValue:A(u),"onUpdate:modelValue":S[1]||(S[1]=tt=>we(u)?u.value=tt:null),onConfirm:v,onCancel:S[2]||(S[2]=tt=>c.value=!1)},null,8,["columns","modelValue"])]),_:1},8,["show"])]),A(d)?(Q(),it("div",Vd,[B(T,{size:"24"})])):(Q(),it("div",Ld,[A(g).length?(Q(),it("div",Nd,[z("div",zd,[z("div",null,[z("span",Od,[B(R,{keypath:"trade.open"}),S[4]||(S[4]=oe(":"))]),z("span",{class:ve(["value",{up:i.up},{down:!i.up}])},rt((L=A(g)[0])==null?void 0:L.open),3)]),z("div",null,[z("span",Wd,[B(R,{keypath:"trade.high"}),S[5]||(S[5]=oe(":"))]),z("span",{class:ve(["value",{up:i.up},{down:!i.up}])},rt((F=A(g)[0])==null?void 0:F.high),3)]),z("div",null,[z("span",Yd,[B(R,{keypath:"trade.low"}),S[6]||(S[6]=oe(":"))]),z("span",{class:ve(["value",{up:i.up},{down:!i.up}])},rt((X=A(g)[0])==null?void 0:X.low),3)]),z("div",null,[z("span",Xd,[B(R,{keypath:"trade.close"}),S[7]||(S[7]=oe(":"))]),z("span",{class:ve(["value",{up:i.up},{down:!i.up}])},rt((W=A(g)[0])==null?void 0:W.close),3)])]),z("div",$d,[z("div",Hd,"MA5:"+rt((nt=(et=A(g)[1])==null?void 0:et.value)==null?void 0:nt.toFixed(2)),1),z("div",Qd,"MA10:"+rt((Z=(J=A(g)[2])==null?void 0:J.value)==null?void 0:Z.toFixed(2)),1),z("div",jd,"MA30:"+rt((st=(at=A(g)[3])==null?void 0:at.value)==null?void 0:st.toFixed(2)),1)])])):Hn("",!0)]))],64)}}},Ud=Qe(Gd,[["__scopeId","data-v-73e49f5e"]]),Fo="/h5/assets/success-DDPA-ryG.png",Jd={class:"flex my-1 mt-3"},Zd={class:"type mr-2"},Kd={class:"multiple"},qd={class:"my-1"},tf={class:"row mt-1"},ef={class:"my-1"},nf={class:"my-1"},sf={class:"success"},rf={class:"confirmed"},of={__name:"ContractTrade",props:["currency"],setup(s){var f,v;const t=$n(),e=s;Object.keys(t.user).length||t.userInfo(),Object.keys(t.siteConfig).length||t.getConfig();const{t:i}=Qn(),n=yt(()=>[{text:i("trade.market_value"),value:1},{text:i("trade.limit"),value:0}]),r=q(1),o=q(n.value[0].text),a=yt(()=>{var g;return((g=e.currency)==null?void 0:g.multiple).map(m=>(m.text=m.value,m))});let l=Tr({multiple:(f=a[0])==null?void 0:f.value,showMultiple:!1,pickerValue:[],isStopLoss:!1,isStopgap:!1,stop_loss_price:0,target_profit_price:0,number:0,each_piece:100,target_price:(v=e.currency)==null?void 0:v.now_price,upLoading:!1,downLoading:!1,show:!1,showType:!1,typePickerValue:[1]});yt(()=>{var p;return e.currency?(((p=e.currency)==null?void 0:p.lever_trade_fee)*l.number).toFixed(5):0});const h=yt(()=>{if(!e.currency)return 0;const{now_price:p,spread:g,lever_share_num:m,each_piece:_}=e.currency;return p*m*l.number,l.number*1e3});Jt(()=>e.currency,p=>{var g;if(p){const m=p==null?void 0:p.multiple;m.length&&(l.multiple=m[0].value),l.target_price=(g=e.currency)==null?void 0:g.now_price}}),Jt(()=>l.isStopgap,p=>{var g;p?l.target_profit_price=(g=e.currency)==null?void 0:g.now_price:l.target_profit_price=0}),Jt(()=>l.isStopLoss,p=>{var g;p?l.stop_loss_price=(g=e.currency)==null?void 0:g.now_price:l.stop_loss_price=0});const u=({selectedValues:p,selectedOptions:g})=>{var m;l.multiple=(m=g[0])==null?void 0:m.value,l.pickerValue=p,l.showMultiple=!1},c=({selectedValues:p,selectedOptions:g})=>{var m;r.value=(m=g[0])==null?void 0:m.value,o.value=g[0].text,l.typePickerValue=p,l.showType=!1};function d(p){var m,_;if(((m=t.user)==null?void 0:m.status)===1){Fr({message:i("mine.frozen")}).then(()=>{var w;window.location.href=(w=t.siteConfig)==null?void 0:w.support_url});return}const g={share:l.number,multiple:l.multiple,legal_id:1,currency_id:(_=e.currency)==null?void 0:_.currency_id,type:p,status:r.value,target_profit_price:l.target_profit_price,stop_loss_price:l.stop_loss_price,target_price:l.target_price};p===1?l.upLoading=!0:l.downLoading=!0,jh(g).then(w=>{(w==null?void 0:w.type)==="ok"&&(t.userInfo(),l.show=!0)}).finally(()=>{l.upLoading=!1,l.downLoading=!1})}return(p,g)=>{var C,E,I,P;const m=Rr,_=Gn,w=di,y=va,x=jn,M=Xi("i18n-t"),b=kr,S=Ar;return Q(),it(Ot,null,[z("div",Jd,[z("div",Zd,[B(m,{class:"rounded-lg",modelValue:A(o),"onUpdate:modelValue":g[0]||(g[0]=T=>we(o)?o.value=T:null),"is-link":"",readonly:"",name:"picker",placeholder:"",border:!1,onClick:g[1]||(g[1]=T=>A(l).showType=!0)},null,8,["modelValue"]),B(w,{show:A(l).showType,"onUpdate:show":g[3]||(g[3]=T=>A(l).showType=T),"destroy-on-close":"",position:"bottom","safe-area-inset-bottom":!0},{default:ot(()=>[B(_,{columns:A(n),"model-value":A(l).typePickerValue,onConfirm:c,onCancel:g[2]||(g[2]=T=>A(l).showType=!1)},null,8,["columns","model-value"])]),_:1},8,["show"])]),z("div",Kd,[B(m,{class:"rounded-lg",modelValue:A(l).multiple,"onUpdate:modelValue":g[4]||(g[4]=T=>A(l).multiple=T),"is-link":"",readonly:"",name:"picker",label:p.$t("trade.multiplier"),placeholder:"",border:!1,onClick:g[5]||(g[5]=T=>A(l).showMultiple=!0)},null,8,["modelValue","label"]),B(w,{show:A(l).showMultiple,"onUpdate:show":g[7]||(g[7]=T=>A(l).showMultiple=T),"destroy-on-close":"",position:"bottom","safe-area-inset-bottom":!0},{default:ot(()=>[B(_,{columns:A(a),"model-value":A(l).pickerValue,onConfirm:u,onCancel:g[6]||(g[6]=T=>A(l).showMultiple=!1)},null,8,["columns","model-value"])]),_:1},8,["show"])])]),z("div",null,[A(r)===0?(Q(),jt(x,{key:0,border:!1},{value:ot(()=>[B(y,{min:0,modelValue:A(l).target_price,"onUpdate:modelValue":g[8]||(g[8]=T=>A(l).target_price=T)},null,8,["modelValue"])]),_:1})):(Q(),jt(x,{key:1,class:"rounded-lg",border:!1,title:p.$t("trade.market_value")},null,8,["title"])),z("div",qd,[B(x,{center:"",title:p.$t("trade.buy_quantity"),border:!1},{"right-icon":ot(()=>{var T,R;return[B(y,{step:"1",integer:"",min:(T=e.currency)==null?void 0:T.lever_min_share,max:(R=e.currency)==null?void 0:R.lever_max_share,modelValue:A(l).number,"onUpdate:modelValue":g[9]||(g[9]=L=>A(l).number=L)},null,8,["min","max","modelValue"])]}),_:1},8,["title"])]),z("div",tf,[z("div",ef,[B(x,{border:!1,title:p.$t("trade.estimated_margin"),value:A(h)},null,8,["title","value"]),B(x,{border:!1,title:p.$t("trade.balance"),value:(C=A(t).user)==null?void 0:C.usdt},null,8,["title","value"])])]),B(b,{class:"btn",type:"success",block:"",size:"small",disabled:!((E=e.currency)!=null&&E.opening),loading:A(l).upLoading,onClick:g[10]||(g[10]=T=>d(1))},{default:ot(()=>[B(M,{keypath:"trade.buy_up"})]),_:1},8,["disabled","loading"]),z("div",nf,[B(x,{border:!1,title:p.$t("trade.estimated_margin"),value:A(h)},null,8,["title","value"]),B(x,{border:!1,title:p.$t("trade.balance"),value:(I=A(t).user)==null?void 0:I.usdt},null,8,["title","value"])]),B(b,{class:"btn",type:"danger",block:"",size:"small",disabled:!((P=e.currency)!=null&&P.opening),loading:A(l).downLoading,onClick:g[11]||(g[11]=T=>d(2))},{default:ot(()=>[B(M,{keypath:"trade.buy_down"})]),_:1},8,["disabled","loading"]),B(w,{show:A(l).show,"onUpdate:show":g[12]||(g[12]=T=>A(l).show=T),position:"bottom",round:"",closeable:"","safe-area-inset-bottom":!0},{default:ot(()=>[z("div",sf,[B(S,{src:A(Fo),width:"80",height:"80"},null,8,["src"])]),z("p",rf,[B(M,{keypath:"trade.order_confirmed"})])]),_:1},8,["show"])])],64)}}},af=Qe(of,[["__scopeId","data-v-d8a2e17b"]]),lf={class:"ma-3"},hf={class:"font-md my-2"},uf={class:"second"},cf={class:"font-md my-2"},df={class:"row info"},ff={class:"success"},vf={class:"confirmed"},pf={__name:"SecondsTrade",props:["currency"],setup(s){const t=$n(),e=s,{t:i}=Qn(),n=Tr({secondList:[],seconds:null,number:null,fee:0,show:!1,upLoading:!1,downLoading:!1}),r=yt(()=>{var u;return((u=n.seconds)==null?void 0:u.min_amount)||0}),o=yt(()=>{var u;return((u=n.seconds)==null?void 0:u.max_amount)||0});Dr(()=>{Object.keys(t.user).length||t.userInfo(),Object.keys(t.siteConfig).length||t.getConfig(),Gh().then(u=>{var c,d;if(u.type==="ok"){const f=((c=u.data)==null?void 0:c.data)||[];n.secondList=f,n.fee=((d=u.data)==null?void 0:d.fee)||0,f.length&&(n.seconds=f[0])}})});function a(u){n.seconds=u}const l=yt(()=>(n.fee/100).toFixed(2));function h(u){var d,f,v,p;if(((d=t.user)==null?void 0:d.status)===1){Fr({message:i("mine.frozen")}).then(()=>{var g;window.location.href=(g=t.siteConfig)==null?void 0:g.support_url});return}const c={number:n.number,currency_id:(f=e.currency)==null?void 0:f.currency_id,type:u,seconds:(v=n.seconds)==null?void 0:v.seconds,match_id:(p=e.currency)==null?void 0:p.match_id};u===1?n.upLoading=!0:n.downLoading=!0,Uh(c).then(g=>{g.type==="ok"&&(t.userInfo(),n.show=!0)}).finally(()=>{n.upLoading=!1,n.downLoading=!1})}return(u,c)=>{var y;const d=Xi("i18n-t"),f=$i,v=Rr,p=jn,g=kr,m=Br,_=Ar,w=di;return Q(),it("div",lf,[z("div",hf,[B(d,{keypath:"trade.opening_time"})]),z("div",uf,[(Q(!0),it(Ot,null,li(A(n).secondList,x=>{var M;return Q(),jt(f,{key:x.id,size:"large",type:"primary",plain:x.seconds!==((M=A(n).seconds)==null?void 0:M.seconds),onClick:b=>a(x)},{default:ot(()=>[oe(rt(x.seconds)+"S",1)]),_:2},1032,["plain","onClick"])}),128))]),z("div",cf,[B(d,{keypath:"trade.open_number"}),z("span",null,"["+rt(A(r))+","+rt(A(o))+"]",1)]),B(v,{modelValue:A(n).number,"onUpdate:modelValue":c[0]||(c[0]=x=>A(n).number=x),class:"row",type:"number",min:A(r),max:A(o)},null,8,["modelValue","min","max"]),z("div",df,[B(p,{border:!1,title:u.$t("trade.estimated_commission"),value:A(l)},null,8,["title","value"]),B(p,{border:!1,title:u.$t("trade.balance"),value:(y=A(t).user)==null?void 0:y.usdt},null,8,["title","value"])]),B(m,null,{default:ot(()=>{var x,M;return[B(g,{class:"btn",type:"primary",block:"",size:"small",disabled:!((x=e.currency)!=null&&x.opening),loading:A(n).upLoading,onClick:c[1]||(c[1]=b=>h(1))},{default:ot(()=>[B(d,{keypath:"trade.buy_up"})]),_:1},8,["disabled","loading"]),B(g,{class:"btn",type:"danger",block:"",size:"small",disabled:!((M=e.currency)!=null&&M.opening),loading:A(n).downLoading,onClick:c[2]||(c[2]=b=>h(2))},{default:ot(()=>[B(d,{keypath:"trade.buy_down"})]),_:1},8,["disabled","loading"])]}),_:1}),B(w,{show:A(n).show,"onUpdate:show":c[3]||(c[3]=x=>A(n).show=x),position:"bottom",round:"",closeable:"","safe-area-inset-bottom":!0},{default:ot(()=>[z("div",ff,[B(_,{src:A(Fo),width:"80",height:"80"},null,8,["src"])]),z("p",vf,[B(d,{keypath:"trade.order_confirmed"})])]),_:1},8,["show"])])}}},gf=Qe(pf,[["__scopeId","data-v-bf5bbeb0"]]),mf=[[351.45,9.2765,0],[351.26,.351,96.21624535115615],[351.24,.33,96.4426238344203],[351.23,.22,97.62841588961354],[351.22,.351,96.21624535115615]],_f=[[351.46,8.761,0],[351.47,.351,95.99360803561238],[351.49,.85,90.2979111973519],[351.5,.351,95.99360803561238],[351.57,.351,95.99360803561238]],yf={class:"volume font-sm"},wf={class:"flex space-around title"},bf={key:0,class:"text-center"},Sf={class:"up"},xf={class:"down"},Cf={__name:"Volume",props:["symbol"],setup(s){const t=Hi(),e=s,i=q([...mf]),n=q([..._f]);return t.on("market_depth",r=>{const{symbol:o,asks:a,bids:l}=r;if(e!=null&&e.symbol&&o===(e==null?void 0:e.symbol)){const h=l.splice(0,5),u=a.splice(0,5),c=Math.max(...h.map(f=>f[1])),d=Math.max(...u.map(f=>f[1]));h.forEach(f=>{f[2]=(1-[f[1]]/c)*100}),u.forEach(f=>{f[2]=(1-[f[1]]/d)*100}),i.value=h,n.value=u}}),Wi(()=>{t.off("market_depth")}),(r,o)=>{const a=Yi,l=Br;return Q(),it("div",yf,[z("div",wf,[z("span",null,rt(r.$t("trade.price")),1),z("span",null,rt(r.$t("order.quantity")),1)]),A(i).length?Hn("",!0):(Q(),it("div",bf,[B(a,{size:"24"})])),(Q(!0),it(Ot,null,li(A(i),h=>(Q(),it("div",{class:"flex space-between buy",key:h.id},[z("span",Sf,rt(h[0]),1),z("span",null,rt(h[1]),1),z("div",{class:"bg-bar",style:ws({transform:`translateX(${h[2]}%)`})},null,4)]))),128)),B(l),(Q(!0),it(Ot,null,li(A(n),h=>(Q(),it("div",{class:"flex space-between sell",key:h.id},[z("span",xf,rt(h[0]),1),z("span",null,rt(h[1]),1),z("div",{class:"bg-bar",style:ws({transform:`translateX(${h[2]}%)`})},null,4)]))),128))])}}},Mf=Qe(Cf,[["__scopeId","data-v-f4dd4688"]]),Ef={class:"flex space-between align-center pr-3"},Pf={class:"main van-hairline--top"},If={key:0,class:"text-center"},Tf={key:1,class:"flex space-between mb-1"},kf={class:"price mr-2 bold"},Df={key:1,class:"percentage mr-2 font-sm"},Af={class:"chart van-hairline--top pt-1"},Rf={class:"flex van-hairline--top"},Ff={class:"buy-form mr-1"},Bf={__name:"Index",setup(s){const{t}=Qn(),e=ia(),i=Hi(),n=yt(()=>[{label:t("order.contract"),comp:af,id:"Contract"},{label:t("order.second_contract"),comp:gf,id:"Seconds"}]),r=q({isInit:!0,currency_id:null,currency_name:"",show_name:"",legal_name:"USDT"}),o=q([]),a=q(!1),l=q(!1),h=q("dw"),u=yt(()=>r.value?`${r.value.currency_name}/${r.value.legal_name}`:"");Dr(async()=>{c().then(g=>{const m=e.query.id;if(m){const _=o.value.find(w=>w.currency_id===+m);console.log("defaultCurrency",_),r.value=_}r.value.isInit&&(r.value=o.value[0])})}),Yn(()=>{i.on("daymarket",g=>{var w;const{currency_name:m}=g,_=o.value.findIndex(y=>y.currency_name===m);if(m===((w=r.value)==null?void 0:w.currency_name)&&(r.value.now_price=g.now_price-(g.floating||0),r.value.change=g.change,r.value.match_id=g.match_id),_>=0){const y=o.value[_];o.value[_]={...y,...g,now_price:g.now_price-((g==null?void 0:g.floating)||0)}}})}),Wi(()=>{i.off("daymarket")});function c(){return l.value=!0,ra().then(g=>{(g==null?void 0:g.type)==="ok"&&g.data.forEach(_=>{_.quotation.forEach(y=>{const x={...y,id:y.currency_id,name:y.show_name,opening:y.currency.opening,now_price:y.now_price-(y.floating||0),precision_length:oa(y.now_price)};o.value.push(x)})})}).finally(()=>{l.value=!1})}function d(g){r.value=g,a.value=!1}const f=q(""),v=yt(()=>{const g=n.value.find(m=>m.id===f.value);return g==null?void 0:g.comp}),p=yt(()=>{var g;return an((g=r.value)==null?void 0:g.change)});return(g,m)=>{var I,P,T,R,L;const _=ha,w=la,y=Xn,x=Yi,M=Xi("i18n-t"),b=$i,S=jn,C=sa,E=di;return Q(),it(Ot,null,[z("div",Ef,[B(w,{active:A(f),"onUpdate:active":m[0]||(m[0]=F=>we(f)?f.value=F:null),shrink:""},{default:ot(()=>[(Q(!0),it(Ot,null,li(A(n),F=>(Q(),jt(_,{key:F.label,title:F.label,name:F.id},null,8,["title","name"]))),128))]),_:1},8,["active"]),B(y,{name:"orders-o",size:"20",onClick:m[1]||(m[1]=F=>g.$router.push("/order"))})]),z("div",Pf,[A(l)?(Q(),it("div",If,[B(x,{size:"20"})])):(Q(),it("div",Tf,[z("div",{class:"show-name bold",onClick:m[2]||(m[2]=F=>a.value=!0)},[oe(rt((I=A(r))==null?void 0:I.show_name)+" ",1),B(y,{name:"arrow-down"})]),z("div",{class:ve(["trend",{up:A(p),down:!A(p)}])},[z("span",kf,rt(A(aa)((P=A(r))==null?void 0:P.now_price,(T=A(r))==null?void 0:T.precision_length)),1),(R=A(r))!=null&&R.opening?(Q(),it("span",Df,rt((L=A(r))==null?void 0:L.change)+"%",1)):(Q(),jt(b,{key:0},{default:ot(()=>[B(M,{keypath:"market.closed"})]),_:1}))],2)])),z("div",Af,[A(r)?(Q(),it(Ot,{key:0},[A(h)==="dw"?(Q(),jt(Ud,{key:0,symbol:A(u),up:A(p)},null,8,["symbol","up"])):(Q(),jt(tu,{key:1,symbol:A(u)},null,8,["symbol"]))],64)):Hn("",!0)]),z("div",Rf,[z("div",Ff,[(Q(),jt(na(A(v)),{currency:A(r)},null,8,["currency"]))]),B(Mf,{symbol:A(u)},null,8,["symbol"])]),B(E,{show:A(a),"onUpdate:show":m[3]||(m[3]=F=>we(a)?a.value=F:null),position:"left",style:{width:"60%",height:"100%"},"safe-area-inset-bottom":!0,"safe-area-inset-top":!0},{default:ot(()=>[B(C,null,{default:ot(()=>[(Q(!0),it(Ot,null,li(A(o),F=>(Q(),jt(S,{title:F.show_name,class:ve({active:F.show_name===A(r).show_name}),onClick:X=>d(F)},{icon:ot(()=>[B(y,{name:F.logo_url,size:"24"},null,8,["name"])]),value:ot(()=>[z("span",{class:ve([{up:A(an)(F==null?void 0:F.change),down:!A(an)(F==null?void 0:F.change)}])},rt(parseFloat(F.now_price).toFixed(4)),3)]),_:2},1032,["title","class","onClick"]))),256))]),_:1})]),_:1},8,["show"])])],64)}}},iv=Qe(Bf,[["__scopeId","data-v-d5cd902a"]]);export{iv as default};
