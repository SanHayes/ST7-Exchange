import{_ as Y,v as D,ae as N,y as g,b as o,A as l,D as n,F as y,s as B,z as R,G as r,I as z,H,J as d,R as u,M as c,K as I,L as M,Q as V,bu as j,ai as F,bv as G}from"./index-pxKzUmWb.js";import{L as T}from"./index-C3h2DyHM.js";import{C as A}from"./index-p8gEzFsp.js";import{C as E}from"./index-DxH0UvTb.js";import{N as J}from"./index-BSWTsw4n.js";import{h as v}from"./moment-C5S46NFB.js";import{s as K}from"./function-call-iOCXjCWj.js";import"./use-tab-status-BfnYE3qF.js";const O={class:"no"},Q={class:"mr-3"},S={class:"text-right pa-3"},U={__name:"Record",setup(q){const{t:b}=D(),h=B(),a=N({page:0,list:[],loading:!1,finished:!1,error:!1,limit:10,submitLoading:!1});function k(){a.page+=1,a.page,a.limit,h.params.id,G().then(t=>{if((t==null?void 0:t.type)==="ok"){const{data:s=[],total:m,last_page:f}=t.data;a.list.push(...s),(!f||f===a.page)&&(a.finished=!0)}else a.error=!0}).catch(t=>{a.error=!0}).finally(()=>{a.loading=!1})}function $(){Object.assign(a,{page:0,loading:!1,finished:!1,error:!1,list:[]})}function C(t){K({message:b("loan.confirm_repayment")+"?"}).then(()=>{a.submitLoading=!0,j({orderId:t}).then(s=>{s.type==="ok"&&(F({type:"success",message:s.message}),setTimeout(()=>{$()},300))}).finally(()=>{a.submitLoading=!1})})}return(t,s)=>{const m=z,f=J,i=E,p=R("i18n-t"),_=V,L=A,w=T;return r(),g(y,null,[o(f,{title:t.$t("loan.loan"),fixed:"",placeholder:""},{left:l(()=>[o(m,{"class-prefix":"iconfont",name:"back",onClick:s[0]||(s[0]=e=>t.$router.back())})]),_:1},8,["title"]),o(w,{class:"list ma-5",loading:n(a).loading,"onUpdate:loading":s[1]||(s[1]=e=>n(a).loading=e),finished:n(a).finished,error:n(a).error,"finished-text":t.$t("mining.no_more"),onLoad:k},{default:l(()=>[(r(!0),g(y,null,H(n(a).list,e=>(r(),d(L,{key:e.id,class:"mb-3 row",border:!1},{default:l(()=>[o(i,{border:!1,value:n(v)(e.created_at).format("YYYY-MM-DD HH:mm:ss")},{title:l(()=>[c("div",O,[s[2]||(s[2]=I(" # ")),c("span",Q,M(e.borrow_id),1)])]),_:2},1032,["value"]),o(i,{title:t.$t("loan.amount"),value:e.amount,border:!1},null,8,["title","value"]),o(i,{title:t.$t("loan.loan_time"),value:e.lock_dividend_days+t.$t("loan.day"),border:!1},null,8,["title","value"]),o(i,{title:t.$t("loan.total_profit"),value:e.sum_profit,border:!1},null,8,["title","value"]),o(i,{title:t.$t("loan.day_rate"),value:e.day_profit+"%",border:!1},null,8,["title","value"]),o(i,{title:e.status===4?t.$t("tc.refuse"):t.$t("loan.reviewed_at"),value:n(v)(e.sub_time).format("YYYY-MM-DD HH:mm:ss"),border:!1},null,8,["title","value"]),e.borrow_desc?(r(),d(i,{key:0,title:e.borrow_desc},null,8,["title"])):u("",!0),c("div",S,[e.status===1?(r(),d(_,{key:0,type:"primary",disabled:"",size:"small"},{default:l(()=>[o(p,{keypath:"loan.auth_waiting"})]),_:1})):u("",!0),e.status===4?(r(),d(_,{key:1,type:"danger",disabled:"",size:"small"},{default:l(()=>[o(p,{keypath:"loan.is_rejected"})]),_:1})):u("",!0),e.status===3?(r(),d(_,{key:2,type:"success",readonly:"",size:"small"},{default:l(()=>[o(p,{keypath:"loan.is_repay"})]),_:1})):u("",!0),e.status===2?(r(),d(_,{key:3,loading:n(a).submitLoading,type:"primary",size:"small",onClick:x=>C(e.id)},{default:l(()=>[o(p,{keypath:"loan.to_repayment"})]),_:2},1032,["loading","onClick"])):u("",!0)])]),_:2},1024))),128))]),_:1},8,["loading","finished","error","finished-text"])],64)}}},se=Y(U,[["__scopeId","data-v-aa3e24d6"]]);export{se as default};
