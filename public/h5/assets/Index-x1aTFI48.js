import{_ as E,N as U,v as j,r as y,O as A,ah as G,k as J,y as w,b as e,M as t,A as u,J as g,z as K,D as r,C as S,R as O,L as b,Q,F as T,E as q,G as p,I as P,S as W,H as X,K as Y,ai as x,aj as Z}from"./index-C59WfAV9.js";import{S as ee}from"./index-EMP4Og3F.js";import{T as oe}from"./index-CkDPlaUk.js";import"./index-DoGVdPo7.js";import{F as ae}from"./index-C8WCAi7y.js";import{N as ne}from"./index-I-p-jQXu.js";import{s as te}from"./function-call-CFVlGoKa.js";import"./use-id-B0WZ9kAI.js";const se={class:"main ma-3"},le={class:"verified text-center pa-5 mb-3"},ie={class:"font-md"},re={class:"label font-md mb-3"},de={class:"label font-md my-2"},ue={class:"label font-md my-2"},ce={class:"row my-3 pa-3 font-md"},me={class:"flex space-between"},_e={class:"label"},pe={key:0,class:"value"},ve={class:"flex space-between"},ye={class:"label"},fe={class:"value"},he={class:"flex space-between"},be={class:"label"},ke={class:"value"},we=["innerHTML"],ge={__name:"Index",setup(xe){const C=U(),N=q(),{t:f}=j(),V=y(!0),B=y([]),l=y(""),s=y(null),k=y(!1);A(async()=>{await C.userInfo()}),G().then(o=>{var a,c;if(o.type==="ok"){const i=((a=o.data)==null?void 0:a.data)||[];B.value=i.sort((n,_)=>n.lock_dividend_days-_.lock_dividend_days),i!=null&&i.length&&(s.value=i[0],l.value=(c=i[0])==null?void 0:c.borrow_amount_min)}}).finally(()=>{V.value=!1});const h=J(()=>{var o,a;return!((o=s.value)!=null&&o.borrow_margin)||!l.value?0:(((a=s.value)==null?void 0:a.borrow_margin)*l.value).toFixed(2)});function M(o){s.value=o,l.value=o==null?void 0:o.borrow_amount_min}function D(){var a,c,i,n,_;if(!l.value){x({type:"warning",message:f("mining.max_number")});return}if(l.value<Number(s.value.borrow_amount_min)){x({type:"warning",message:f("mining.lazy_weight")});return}if(l.value>Number((a=s.value)==null?void 0:a.borrow_amount_max)){x({type:"warning",message:f("tc.loanTips",{day:(c=s.value)==null?void 0:c.lock_dividend_days,amount:(i=s.value)==null?void 0:i.borrow_amount_max})});return}if(h.value>((n=C.user)==null?void 0:n.usdt)){te({message:f("tc.lack")}).then(()=>{N.push("/mine/charge")}).catch(()=>{});return}k.value=!0;const o={id:(_=s.value)==null?void 0:_.id,amount:l.value};Z(o).then(m=>{console.log("res",m),m.type==="ok"&&N.push("/loaned")}).finally(()=>{k.value=!1})}return(o,a)=>{var L,$,z,F;const c=P,i=ne,n=K("i18n-t"),_=W,m=Q,I=ae,H=oe,R=ee;return p(),w(T,null,[e(i,{title:o.$t("loan.loan"),fixed:"",placeholder:""},{right:u(()=>[e(c,{name:"orders-o",size:"24",onClick:a[0]||(a[0]=d=>o.$router.push("/loan/record"))})]),_:1},8,["title"]),t("div",se,[t("div",le,[t("p",ie,[e(n,{keypath:"loan.start_loan"})]),r(V)?(p(),g(m,{key:0,type:"primary"},{icon:u(()=>[e(_,{size:"16",color:"white"})]),default:u(()=>[e(n,{keypath:"loan.verify"})]),_:1})):(p(),g(m,{key:1,icon:"checked",type:"primary"},{default:u(()=>[e(n,{keypath:"loan.verified"})]),_:1}))]),t("div",re,[e(n,{keypath:"tc.amount"})]),e(I,{class:"row",modelValue:r(l),"onUpdate:modelValue":a[2]||(a[2]=d=>S(l)?l.value=d:null),placeholder:o.$t("loan.input_amount")},{"right-icon":u(()=>[e(m,{type:"primary",size:"small",onClick:a[1]||(a[1]=d=>{var v;return l.value=(v=r(s))==null?void 0:v.borrow_amount_max})},{default:u(()=>[e(n,{keypath:"loan.max"})]),_:1})]),_:1},8,["modelValue","placeholder"]),t("div",de,[e(n,{keypath:"tc.margin"})]),e(I,{class:"row",modelValue:r(h),"onUpdate:modelValue":a[3]||(a[3]=d=>S(h)?h.value=d:null),readonly:""},null,8,["modelValue"]),t("div",ue,[e(n,{keypath:"loan.loan_time"})]),e(R,null,{default:u(()=>[(p(!0),w(T,null,X(r(B),d=>{var v;return p(),g(H,{type:"primary",size:"large",plain:d.lock_dividend_days!==((v=r(s))==null?void 0:v.lock_dividend_days),key:d.id,onClick:Ce=>M(d)},{default:u(()=>[Y(b(d.lock_dividend_days)+" ",1),e(n,{keypath:"loan.day"})]),_:2},1032,["plain","onClick"])}),128))]),_:1}),t("div",ce,[t("div",me,[t("div",_e,[e(n,{keypath:"loan.day_rate"})]),(L=r(s))!=null&&L.borrow_lixi?(p(),w("div",pe,b(Number((($=r(s))==null?void 0:$.borrow_lixi)*100).toFixed(3))+" % ",1)):O("",!0)]),t("div",ve,[t("div",ye,[e(n,{keypath:"tc.minimum"})]),t("div",fe,b((z=r(s))==null?void 0:z.borrow_amount_min),1)]),t("div",he,[t("div",be,[e(n,{keypath:"tc.maximum"})]),t("div",ke,b((F=r(s))==null?void 0:F.borrow_amount_max),1)])]),e(m,{type:"primary",block:"",loading:r(k),onClick:D},{default:u(()=>[e(n,{keypath:"tc.apply"})]),_:1},8,["loading"]),t("div",{class:"rule my-3 font-sm",innerHTML:o.$t("loan.rule")},null,8,we)])],64)}}},Se=E(ge,[["__scopeId","data-v-b96bee8e"]]);export{Se as default};
