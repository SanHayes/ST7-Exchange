import{_ as E,M,v as R,r as v,N as A,ah as G,k as H,y as V,b as e,P as a,A as c,J as w,z as J,D as r,C as K,L as y,Q as O,F as $,E as P,G as f,I as Q,S as U,H as q,K as W,ai as g,aj as X}from"./index-DV1i6KxT.js";import{S as Y}from"./index-Y8O_-ZPq.js";import{T as Z}from"./index-BNdN2Ths.js";import"./index-CAaOaEfp.js";import{F as ee}from"./index-CcbNvfut.js";import{N as ae}from"./index-vA-mF5-l.js";import{s as oe}from"./function-call-CqTYa5P1.js";import"./use-id-CF8d1TUL.js";const te={class:"main ma-3"},ne={class:"verified text-center pa-5 mb-3"},se={class:"font-md"},le={class:"label font-md mb-3"},ie={class:"label font-md my-2"},re={class:"row my-3 pa-3 font-md"},ce={class:"flex space-between"},de={class:"label"},_e={class:"value"},ue={class:"flex space-between"},me={class:"label"},pe={class:"value"},ve={class:"flex space-between"},ye={class:"label"},fe={class:"value"},he={class:"flex space-between"},ke={class:"label"},be={class:"value"},we={class:"rule my-3 font-sm"},ge={__name:"Index",setup(xe){const k=M(),x=P(),{t:h}=R(),C=v(!0),N=v([]),l=v(""),n=v(null),b=v(!1);A(async()=>{Object.keys(k.user).length||await k.userInfo()}),G().then(t=>{var s,_;if(t.type==="ok"){const i=((s=t.data)==null?void 0:s.data)||[];N.value=i.sort((o,m)=>o.lock_dividend_days-m.lock_dividend_days),i!=null&&i.length&&(n.value=i[0],l.value=(_=i[0])==null?void 0:_.borrow_amount_min)}}).finally(()=>{C.value=!1});const B=H(()=>{var t;return((t=n.value)==null?void 0:t.borrow_margin)*l.value||0});function L(t){n.value=t,l.value=t==null?void 0:t.borrow_amount_min}function F(){var s,_,i,o,m;if(!l.value){g({type:"warning",message:h("mining.max_number")});return}if(l.value<Number(n.value.borrow_amount_min)){g({type:"warning",message:h("mining.lazy_weight")});return}if(l.value>Number((s=n.value)==null?void 0:s.borrow_amount_max)){g({type:"warning",message:h("tc.loanTips",{day:(_=n.value)==null?void 0:_.lock_dividend_days,amount:(i=n.value)==null?void 0:i.borrow_amount_max})});return}if(B.value>((o=k.user)==null?void 0:o.usdt)){oe({message:h("tc.lack")}).then(()=>{x.push("/mine/charge")}).catch(()=>{});return}b.value=!0;const t={id:(m=n.value)==null?void 0:m.id,amount:l.value};X(t).then(u=>{console.log("res",u),u.type==="ok"&&x.push("/loaned")}).finally(()=>{b.value=!1})}return(t,s)=>{var I,z,S;const _=Q,i=ae,o=J("i18n-t"),m=U,u=O,T=ee,D=Z,j=Y;return f(),V($,null,[e(i,{title:t.$t("loan.loan"),fixed:"",placeholder:""},{right:c(()=>[e(_,{name:"orders-o",size:"24",onClick:s[0]||(s[0]=d=>t.$router.push("/loan/record"))})]),_:1},8,["title"]),a("div",te,[a("div",ne,[a("p",se,[e(o,{keypath:"loan.start_loan"})]),r(C)?(f(),w(u,{key:0,type:"primary"},{icon:c(()=>[e(m,{size:"16",color:"white"})]),default:c(()=>[e(o,{keypath:"loan.verify"})]),_:1})):(f(),w(u,{key:1,icon:"checked",type:"primary"},{default:c(()=>[e(o,{keypath:"loan.verified"})]),_:1}))]),a("div",le,[e(o,{keypath:"tc.amount"})]),e(T,{class:"row",modelValue:r(l),"onUpdate:modelValue":s[2]||(s[2]=d=>K(l)?l.value=d:null),placeholder:t.$t("loan.input_amount")},{"right-icon":c(()=>[e(u,{type:"primary",size:"small",onClick:s[1]||(s[1]=d=>{var p;return l.value=(p=r(n))==null?void 0:p.borrow_amount_max})},{default:c(()=>[e(o,{keypath:"loan.max"})]),_:1})]),_:1},8,["modelValue","placeholder"]),a("div",ie,[e(o,{keypath:"loan.loan_time"})]),e(j,null,{default:c(()=>[(f(!0),V($,null,q(r(N),d=>{var p;return f(),w(D,{type:"primary",size:"large",plain:d.lock_dividend_days!==((p=r(n))==null?void 0:p.lock_dividend_days),key:d.id,onClick:Ce=>L(d)},{default:c(()=>[W(y(d.lock_dividend_days)+" ",1),e(o,{keypath:"loan.day"})]),_:2},1032,["plain","onClick"])}),128))]),_:1}),a("div",re,[a("div",ce,[a("div",de,[e(o,{keypath:"loan.day_rate"})]),a("div",_e,y((I=r(n))==null?void 0:I.borrow_lixi)+" % ",1)]),a("div",ue,[a("div",me,[e(o,{keypath:"tc.margin"})]),a("div",pe,y(r(B)),1)]),a("div",ve,[a("div",ye,[e(o,{keypath:"tc.minimum"})]),a("div",fe,y((z=r(n))==null?void 0:z.borrow_amount_min),1)]),a("div",he,[a("div",ke,[e(o,{keypath:"tc.maximum"})]),a("div",be,y((S=r(n))==null?void 0:S.borrow_amount_max),1)])]),e(u,{type:"primary",block:"",loading:r(b),onClick:F},{default:c(()=>[e(o,{keypath:"tc.apply"})]),_:1},8,["loading"]),a("div",we,[e(o,{keypath:"loan.rule"})])])],64)}}},Fe=E(ge,[["__scopeId","data-v-b6fda73d"]]);export{Fe as default};
