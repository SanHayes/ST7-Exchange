import{_ as M,v as J,ae as Q,N as j,a_ as q,k as H,y as c,b as o,A as p,D as n,S as K,F as m,P as l,J as f,R as h,z as O,Q as T,G as i,I as W,aR as U,ai as D,a$ as X}from"./index-k7Oxk6bG.js";import{C as Y}from"./index-B_Cn3cTN.js";import{C as Z}from"./index-DaUhtG7T.js";import{I as ee}from"./index-7miuPhem.js";/* empty css              */import{U as ae}from"./index-ByZyKjgR.js";import{F as te}from"./index-CXg3oX9B.js";import{N as oe}from"./index-DHE8hHhS.js";import{d as ne}from"./utils-DYbJMG2d.js";import"./index-Cio0Cg_1.js";import"./use-id-Ul--H1Nd.js";const se="/h5/assets/id-front-B29VUS8_.png",le="/h5/assets/id-background-BvafEgth.png",re={key:0,class:"text-center"},ie={key:1,class:"main pa-3"},de={class:"text-center"},ce={class:"label font-md"},pe={class:"label font-md"},_e={class:"row"},ue={key:0,class:"front"},me={class:"btn"},fe={class:"font-sm tips"},he={class:"row"},ve={key:0,class:"front"},ke={class:"btn"},ge={class:"font-sm tips"},be={class:"text-center"},ye={class:"row"},Fe={class:"row"},Ve={__name:"Auth",setup(Le){const{t:N}=J(),e=Q({name:"",card:"",frontFileList:[],frontFilePath:"",backFileList:[],backFilePath:"",loading:!1,pageLoading:!1,info:null});j(()=>{v()});function v(){e.pageLoading=!0,q().then(t=>{var a;if(t.type==="ok"){e.info=t.data;const s=(a=t.data)==null?void 0:a.real_data;e.name=s.name,e.card=s.card_id,e.frontFileList=[{url:"/storage/"+s.front_pic}],e.frontFilePath=s.front_pic,e.backFileList=[{url:"/storage/"+s.reverse_pic}],e.backFilePath=s.reverse_pic}}).finally(()=>{e.pageLoading=!1})}function z(t){t.status="uploading";const a=new FormData;a.append("file",t.file),a.append("type",0),U(a).then(s=>{t.status="done",e.frontFilePath=s.file_path}).catch(()=>{t.status="error"})}function S(t){t.status="uploading";const a=new FormData;a.append("file",t.file),a.append("type",0),U(a).then(s=>{t.status="done",e.backFilePath=s.file_path}).catch(()=>{t.status="error"})}const x=H(()=>!e.name||!e.card||!e.frontFilePath||!e.backFilePath);function A(){const t={id_type:0,name:e.name,card_id:e.card,real_type:1,front_pic:e.frontFilePath,reverse_pic:e.backFilePath};if(!ne(t.card_id))return D({type:"warning",message:N("real.idCardErrMessage")});e.loading=!0,X(t).then(a=>{(a==null?void 0:a.type)==="ok"&&(D({type:"success",message:a.message}),e.loading=!1,v())}).finally(()=>{e.loading=!1})}return(t,a)=>{var y,F,V,L,w,B,C;const s=W,E=oe,R=K,d=O("i18n-t"),k=te,_=ee,u=T,g=ae,b=Z,G=Y;return i(),c(m,null,[o(E,{title:t.$t("real.real_name_auth"),fixed:"",placeholder:""},{left:p(()=>[o(s,{"class-prefix":"iconfont",name:"back",onClick:a[0]||(a[0]=r=>t.$router.back())})]),_:1},8,["title"]),n(e).pageLoading?(i(),c("div",re,[o(R,{size:"24"})])):(i(),c("div",ie,[[0,3].includes((y=n(e).info)==null?void 0:y.real_status)?(i(),c(m,{key:0},[l("div",de,[((F=n(e).info)==null?void 0:F.real_status)===3?(i(),f(d,{key:0,keypath:"real.failed"})):h("",!0)]),l("div",ce,[o(d,{keypath:"real.improve_information"})]),o(k,{class:"row",label:t.$t("real.name"),modelValue:n(e).name,"onUpdate:modelValue":a[1]||(a[1]=r=>n(e).name=r),placeholder:t.$t("real.enter_name")},null,8,["label","modelValue","placeholder"]),o(k,{class:"row",modelValue:n(e).card,"onUpdate:modelValue":a[2]||(a[2]=r=>n(e).card=r),label:t.$t("real.passport_idnumber"),placeholder:t.$t("real.enter_passport_idnumber")},null,8,["modelValue","label","placeholder"]),l("div",pe,[o(d,{keypath:"real.upload_the_front_and_back"})]),l("div",_e,[o(g,{modelValue:n(e).frontFileList,"onUpdate:modelValue":a[3]||(a[3]=r=>n(e).frontFileList=r),"max-count":1,"preview-size":["auto","20vh"],"after-read":z},{default:p(()=>[n(e).frontFileList.length?h("",!0):(i(),c("div",ue,[o(_,{src:n(se)},null,8,["src"]),l("div",me,[o(u,{icon:"plus",round:"",type:"primary",size:"small"})]),l("p",fe,[o(d,{keypath:"real.front"})])]))]),_:1},8,["modelValue"])]),l("div",he,[o(g,{modelValue:n(e).backFileList,"onUpdate:modelValue":a[4]||(a[4]=r=>n(e).backFileList=r),"max-count":1,"preview-size":["auto","20vh"],"after-read":S},{default:p(()=>[n(e).backFileList.length?h("",!0):(i(),c("div",ve,[o(_,{src:n(le)},null,8,["src"]),l("div",ke,[o(u,{icon:"plus",round:"",type:"primary",size:"small"})]),l("p",ge,[o(d,{keypath:"real.back"})])]))]),_:1},8,["modelValue"])]),o(u,{type:"primary",block:"",loading:n(e).loading,disabled:n(x),onClick:A},{default:p(()=>[o(d,{keypath:"real.submit"})]),_:1},8,["loading","disabled"])],64)):(i(),c(m,{key:1},[l("div",be,[((V=n(e).info)==null?void 0:V.real_status)===1?(i(),f(d,{key:0,keypath:"real.under_review"})):(i(),f(d,{key:1,keypath:"real.finish"}))]),l("div",ye,[o(_,{src:"/storage/"+((w=(L=n(e).info)==null?void 0:L.real_data)==null?void 0:w.front_pic)},null,8,["src"])]),l("div",Fe,[o(_,{src:"/storage/"+((C=(B=n(e).info)==null?void 0:B.real_data)==null?void 0:C.reverse_pic)},null,8,["src"])]),o(G,null,{default:p(()=>{var r,P,$,I;return[o(b,{title:t.$t("real.name"),value:(P=(r=n(e).info)==null?void 0:r.real_data)==null?void 0:P.name},null,8,["title","value"]),o(b,{title:t.$t("real.passport_idnumber"),value:(I=($=n(e).info)==null?void 0:$.real_data)==null?void 0:I.card_id},null,8,["title","value"])]}),_:1})],64))]))],64)}}},xe=M(Ve,[["__scopeId","data-v-ad0ea915"]]);export{xe as default};
