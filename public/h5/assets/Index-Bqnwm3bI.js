import{_ as R,N as U,v as j,r as v,O as A,ah as G,k as H,y as $,b as e,M as n,A as c,J as w,z as J,D as d,C as F,L as k,Q as K,F as L,E as O,G as y,I as Q,S as q,H as P,K as W,ai as g,aj as X}from"./index-Utr_697-.js";import{S as Y}from"./index-DgDpkz3m.js";import{T as Z}from"./index-KFsKfcD9.js";import"./index-PvkBJVyW.js";import{F as ee}from"./index-Dv9sCOur.js";import{N as ae}from"./index-DhRCR3RW.js";import{s as oe}from"./function-call-B896GD_D.js";import"./use-id-lEQi9dah.js";const ne={class:"main ma-3"},te={class:"verified text-center pa-5 mb-3"},se={class:"font-md"},le={class:"label font-md mb-3"},ie={class:"label font-md my-2"},re={class:"label font-md my-2"},de={class:"row my-3 pa-3 font-md"},ce={class:"flex space-between"},ue={class:"label"},_e={class:"value"},me={class:"flex space-between"},pe={class:"label"},ve={class:"value"},ye={class:"flex space-between"},fe={class:"label"},he={class:"value"},ke={class:"rule my-3 font-sm"},be={__name:"Index",setup(we){const x=U(),C=O(),{t:f}=j(),N=v(!0),V=v([]),l=v(""),s=v(null),b=v(!1);A(async()=>{await x.userInfo()}),G().then(t=>{var o,u;if(t.type==="ok"){const i=((o=t.data)==null?void 0:o.data)||[];V.value=i.sort((a,m)=>a.lock_dividend_days-m.lock_dividend_days),i!=null&&i.length&&(s.value=i[0],l.value=(u=i[0])==null?void 0:u.borrow_amount_min)}}).finally(()=>{N.value=!1});const h=H(()=>{var t,o;return!((t=s.value)!=null&&t.borrow_margin)||!l.value?0:(((o=s.value)==null?void 0:o.borrow_margin)*l.value).toFixed(2)});function T(t){s.value=t,l.value=t==null?void 0:t.borrow_amount_min}function D(){var o,u,i,a,m;if(!l.value){g({type:"warning",message:f("mining.max_number")});return}if(l.value<Number(s.value.borrow_amount_min)){g({type:"warning",message:f("mining.lazy_weight")});return}if(l.value>Number((o=s.value)==null?void 0:o.borrow_amount_max)){g({type:"warning",message:f("tc.loanTips",{day:(u=s.value)==null?void 0:u.lock_dividend_days,amount:(i=s.value)==null?void 0:i.borrow_amount_max})});return}if(h.value>((a=x.user)==null?void 0:a.usdt)){oe({message:f("tc.lack")}).then(()=>{C.push("/mine/charge")}).catch(()=>{});return}b.value=!0;const t={id:(m=s.value)==null?void 0:m.id,amount:l.value};X(t).then(_=>{console.log("res",_),_.type==="ok"&&C.push("/loaned")}).finally(()=>{b.value=!1})}return(t,o)=>{var I,z,S;const u=Q,i=ae,a=J("i18n-t"),m=q,_=K,B=ee,E=Z,M=Y;return y(),$(L,null,[e(i,{title:t.$t("loan.loan"),fixed:"",placeholder:""},{right:c(()=>[e(u,{name:"orders-o",size:"24",onClick:o[0]||(o[0]=r=>t.$router.push("/loan/record"))})]),_:1},8,["title"]),n("div",ne,[n("div",te,[n("p",se,[e(a,{keypath:"loan.start_loan"})]),d(N)?(y(),w(_,{key:0,type:"primary"},{icon:c(()=>[e(m,{size:"16",color:"white"})]),default:c(()=>[e(a,{keypath:"loan.verify"})]),_:1})):(y(),w(_,{key:1,icon:"checked",type:"primary"},{default:c(()=>[e(a,{keypath:"loan.verified"})]),_:1}))]),n("div",le,[e(a,{keypath:"tc.amount"})]),e(B,{class:"row",modelValue:d(l),"onUpdate:modelValue":o[2]||(o[2]=r=>F(l)?l.value=r:null),placeholder:t.$t("loan.input_amount")},{"right-icon":c(()=>[e(_,{type:"primary",size:"small",onClick:o[1]||(o[1]=r=>{var p;return l.value=(p=d(s))==null?void 0:p.borrow_amount_max})},{default:c(()=>[e(a,{keypath:"loan.max"})]),_:1})]),_:1},8,["modelValue","placeholder"]),n("div",ie,[e(a,{keypath:"tc.margin"})]),e(B,{class:"row",modelValue:d(h),"onUpdate:modelValue":o[3]||(o[3]=r=>F(h)?h.value=r:null),readonly:""},null,8,["modelValue"]),n("div",re,[e(a,{keypath:"loan.loan_time"})]),e(M,null,{default:c(()=>[(y(!0),$(L,null,P(d(V),r=>{var p;return y(),w(E,{type:"primary",size:"large",plain:r.lock_dividend_days!==((p=d(s))==null?void 0:p.lock_dividend_days),key:r.id,onClick:ge=>T(r)},{default:c(()=>[W(k(r.lock_dividend_days)+" ",1),e(a,{keypath:"loan.day"})]),_:2},1032,["plain","onClick"])}),128))]),_:1}),n("div",de,[n("div",ce,[n("div",ue,[e(a,{keypath:"loan.day_rate"})]),n("div",_e,k((I=d(s))==null?void 0:I.borrow_lixi)+" % ",1)]),n("div",me,[n("div",pe,[e(a,{keypath:"tc.minimum"})]),n("div",ve,k((z=d(s))==null?void 0:z.borrow_amount_min),1)]),n("div",ye,[n("div",fe,[e(a,{keypath:"tc.maximum"})]),n("div",he,k((S=d(s))==null?void 0:S.borrow_amount_max),1)])]),e(_,{type:"primary",block:"",loading:d(b),onClick:D},{default:c(()=>[e(a,{keypath:"tc.apply"})]),_:1},8,["loading"]),n("div",ke,[e(a,{keypath:"loan.rule"})])])],64)}}},$e=R(be,[["__scopeId","data-v-8298dc06"]]);export{$e as default};
